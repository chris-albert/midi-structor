var vW=Object.defineProperty;var Z1=Ce=>{throw TypeError(Ce)};var SW=(Ce,Ke,rt)=>Ke in Ce?vW(Ce,Ke,{enumerable:!0,configurable:!0,writable:!0,value:rt}):Ce[Ke]=rt;var p=(Ce,Ke,rt)=>SW(Ce,typeof Ke!="symbol"?Ke+"":Ke,rt),Q1=(Ce,Ke,rt)=>Ke.has(Ce)||Z1("Cannot "+rt);var eE=(Ce,Ke,rt)=>(Q1(Ce,Ke,"read from private field"),rt?rt.call(Ce):Ke.get(Ce)),tE=(Ce,Ke,rt)=>Ke.has(Ce)?Z1("Cannot add the same private member more than once"):Ke instanceof WeakSet?Ke.add(Ce):Ke.set(Ce,rt),nE=(Ce,Ke,rt,nr)=>(Q1(Ce,Ke,"write to private field"),nr?nr.call(Ce,rt):Ke.set(Ce,rt),rt);(function(){"use strict";var Ko,pr,k0,$0,M0,C0,P0,F0,N0,L0,D0,U0,K0,B0,j0,W0,q0,J0,G0,H0,V0,z0,Y0,X0,Z0,Q0,eS,tS,nS,rS,iS,sS,oS,cS,uS,aS,lS,fS,hS,dS,pS,gS,mS,yS,_S,bS,vS;var Ce=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ke(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var rt={exports:{}},nr=typeof Reflect=="object"?Reflect:null,Mp=nr&&typeof nr.apply=="function"?nr.apply:function(t,n,i){return Function.prototype.apply.call(t,n,i)},ac;nr&&typeof nr.ownKeys=="function"?ac=nr.ownKeys:Object.getOwnPropertySymbols?ac=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:ac=function(t){return Object.getOwnPropertyNames(t)};function iE(e){console&&console.warn&&console.warn(e)}var Cp=Number.isNaN||function(t){return t!==t};function $e(){$e.init.call(this)}rt.exports=$e,rt.exports.once=uE,$e.EventEmitter=$e,$e.prototype._events=void 0,$e.prototype._eventsCount=0,$e.prototype._maxListeners=void 0;var Pp=10;function lc(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty($e,"defaultMaxListeners",{enumerable:!0,get:function(){return Pp},set:function(e){if(typeof e!="number"||e<0||Cp(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");Pp=e}}),$e.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},$e.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||Cp(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function Fp(e){return e._maxListeners===void 0?$e.defaultMaxListeners:e._maxListeners}$e.prototype.getMaxListeners=function(){return Fp(this)},$e.prototype.emit=function(t){for(var n=[],i=1;i<arguments.length;i++)n.push(arguments[i]);var o=t==="error",u=this._events;if(u!==void 0)o=o&&u.error===void 0;else if(!o)return!1;if(o){var a;if(n.length>0&&(a=n[0]),a instanceof Error)throw a;var f=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw f.context=a,f}var d=u[t];if(d===void 0)return!1;if(typeof d=="function")Mp(d,this,n);else for(var g=d.length,b=Kp(d,g),i=0;i<g;++i)Mp(b[i],this,n);return!0};function Np(e,t,n,i){var o,u,a;if(lc(n),u=e._events,u===void 0?(u=e._events=Object.create(null),e._eventsCount=0):(u.newListener!==void 0&&(e.emit("newListener",t,n.listener?n.listener:n),u=e._events),a=u[t]),a===void 0)a=u[t]=n,++e._eventsCount;else if(typeof a=="function"?a=u[t]=i?[n,a]:[a,n]:i?a.unshift(n):a.push(n),o=Fp(e),o>0&&a.length>o&&!a.warned){a.warned=!0;var f=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");f.name="MaxListenersExceededWarning",f.emitter=e,f.type=t,f.count=a.length,iE(f)}return e}$e.prototype.addListener=function(t,n){return Np(this,t,n,!1)},$e.prototype.on=$e.prototype.addListener,$e.prototype.prependListener=function(t,n){return Np(this,t,n,!0)};function sE(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Lp(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},o=sE.bind(i);return o.listener=n,i.wrapFn=o,o}$e.prototype.once=function(t,n){return lc(n),this.on(t,Lp(this,t,n)),this},$e.prototype.prependOnceListener=function(t,n){return lc(n),this.prependListener(t,Lp(this,t,n)),this},$e.prototype.removeListener=function(t,n){var i,o,u,a,f;if(lc(n),o=this._events,o===void 0)return this;if(i=o[t],i===void 0)return this;if(i===n||i.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete o[t],o.removeListener&&this.emit("removeListener",t,i.listener||n));else if(typeof i!="function"){for(u=-1,a=i.length-1;a>=0;a--)if(i[a]===n||i[a].listener===n){f=i[a].listener,u=a;break}if(u<0)return this;u===0?i.shift():oE(i,u),i.length===1&&(o[t]=i[0]),o.removeListener!==void 0&&this.emit("removeListener",t,f||n)}return this},$e.prototype.off=$e.prototype.removeListener,$e.prototype.removeAllListeners=function(t){var n,i,o;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[t]),this;if(arguments.length===0){var u=Object.keys(i),a;for(o=0;o<u.length;++o)a=u[o],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=i[t],typeof n=="function")this.removeListener(t,n);else if(n!==void 0)for(o=n.length-1;o>=0;o--)this.removeListener(t,n[o]);return this};function Dp(e,t,n){var i=e._events;if(i===void 0)return[];var o=i[t];return o===void 0?[]:typeof o=="function"?n?[o.listener||o]:[o]:n?cE(o):Kp(o,o.length)}$e.prototype.listeners=function(t){return Dp(this,t,!0)},$e.prototype.rawListeners=function(t){return Dp(this,t,!1)},$e.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):Up.call(e,t)},$e.prototype.listenerCount=Up;function Up(e){var t=this._events;if(t!==void 0){var n=t[e];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}$e.prototype.eventNames=function(){return this._eventsCount>0?ac(this._events):[]};function Kp(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}function oE(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function cE(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function uE(e,t){return new Promise(function(n,i){function o(a){e.removeListener(t,u),i(a)}function u(){typeof e.removeListener=="function"&&e.removeListener("error",o),n([].slice.call(arguments))}Bp(e,t,u,{once:!0}),t!=="error"&&aE(e,o,{once:!0})})}function aE(e,t,n){typeof e.on=="function"&&Bp(e,"error",t,n)}function Bp(e,t,n,i){if(typeof e.on=="function")i.once?e.once(t,n):e.on(t,n);else if(typeof e.addEventListener=="function")e.addEventListener(t,function o(u){i.once&&e.removeEventListener(t,o),n(u)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}var lE=rt.exports;const jp=()=>fE(new lE.EventEmitter),fE=e=>({on:(t,n)=>(e.on(t,n),()=>{e.off(t,n)}),emit:t=>{e.emit("*",t),e.emit(t.type,t)}});var fc={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */fc.exports,function(e,t){(function(){var n,i="4.17.21",o=200,u="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",a="Expected a function",f="Invalid `variable` option passed into `_.template`",d="__lodash_hash_undefined__",g=500,b="__lodash_placeholder__",v=1,O=2,T=4,R=1,W=2,F=1,L=2,z=4,B=8,H=16,Y=32,G=64,k=128,N=256,U=512,K=30,D="...",q=800,Te=16,Ie=1,ut=2,We=3,ne=1/0,ze=9007199254740991,Cn=17976931348623157e292,gr=NaN,At=4294967295,ML=At-1,CL=At>>>1,PL=[["ary",k],["bind",F],["bindKey",L],["curry",B],["curryRight",H],["flip",U],["partial",Y],["partialRight",G],["rearg",N]],Es="[object Arguments]",ia="[object Array]",FL="[object AsyncFunction]",Bo="[object Boolean]",jo="[object Date]",NL="[object DOMException]",sa="[object Error]",oa="[object Function]",SS="[object GeneratorFunction]",Pn="[object Map]",Wo="[object Number]",LL="[object Null]",mr="[object Object]",wS="[object Promise]",DL="[object Proxy]",qo="[object RegExp]",Fn="[object Set]",Jo="[object String]",ca="[object Symbol]",UL="[object Undefined]",Go="[object WeakMap]",KL="[object WeakSet]",Ho="[object ArrayBuffer]",Os="[object DataView]",fd="[object Float32Array]",hd="[object Float64Array]",dd="[object Int8Array]",pd="[object Int16Array]",gd="[object Int32Array]",md="[object Uint8Array]",yd="[object Uint8ClampedArray]",_d="[object Uint16Array]",bd="[object Uint32Array]",BL=/\b__p \+= '';/g,jL=/\b(__p \+=) '' \+/g,WL=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ES=/&(?:amp|lt|gt|quot|#39);/g,OS=/[&<>"']/g,qL=RegExp(ES.source),JL=RegExp(OS.source),GL=/<%-([\s\S]+?)%>/g,HL=/<%([\s\S]+?)%>/g,TS=/<%=([\s\S]+?)%>/g,VL=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,zL=/^\w*$/,YL=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,vd=/[\\^$.*+?()[\]{}|]/g,XL=RegExp(vd.source),Sd=/^\s+/,ZL=/\s/,QL=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,eD=/\{\n\/\* \[wrapped with (.+)\] \*/,tD=/,? & /,nD=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,rD=/[()=,{}\[\]\/\s]/,iD=/\\(\\)?/g,sD=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,IS=/\w*$/,oD=/^[-+]0x[0-9a-f]+$/i,cD=/^0b[01]+$/i,uD=/^\[object .+?Constructor\]$/,aD=/^0o[0-7]+$/i,lD=/^(?:0|[1-9]\d*)$/,fD=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ua=/($^)/,hD=/['\n\r\u2028\u2029\\]/g,aa="\\ud800-\\udfff",dD="\\u0300-\\u036f",pD="\\ufe20-\\ufe2f",gD="\\u20d0-\\u20ff",AS=dD+pD+gD,RS="\\u2700-\\u27bf",xS="a-z\\xdf-\\xf6\\xf8-\\xff",mD="\\xac\\xb1\\xd7\\xf7",yD="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",_D="\\u2000-\\u206f",bD=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",kS="A-Z\\xc0-\\xd6\\xd8-\\xde",$S="\\ufe0e\\ufe0f",MS=mD+yD+_D+bD,wd="['’]",vD="["+aa+"]",CS="["+MS+"]",la="["+AS+"]",PS="\\d+",SD="["+RS+"]",FS="["+xS+"]",NS="[^"+aa+MS+PS+RS+xS+kS+"]",Ed="\\ud83c[\\udffb-\\udfff]",wD="(?:"+la+"|"+Ed+")",LS="[^"+aa+"]",Od="(?:\\ud83c[\\udde6-\\uddff]){2}",Td="[\\ud800-\\udbff][\\udc00-\\udfff]",Ts="["+kS+"]",DS="\\u200d",US="(?:"+FS+"|"+NS+")",ED="(?:"+Ts+"|"+NS+")",KS="(?:"+wd+"(?:d|ll|m|re|s|t|ve))?",BS="(?:"+wd+"(?:D|LL|M|RE|S|T|VE))?",jS=wD+"?",WS="["+$S+"]?",OD="(?:"+DS+"(?:"+[LS,Od,Td].join("|")+")"+WS+jS+")*",TD="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ID="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",qS=WS+jS+OD,AD="(?:"+[SD,Od,Td].join("|")+")"+qS,RD="(?:"+[LS+la+"?",la,Od,Td,vD].join("|")+")",xD=RegExp(wd,"g"),kD=RegExp(la,"g"),Id=RegExp(Ed+"(?="+Ed+")|"+RD+qS,"g"),$D=RegExp([Ts+"?"+FS+"+"+KS+"(?="+[CS,Ts,"$"].join("|")+")",ED+"+"+BS+"(?="+[CS,Ts+US,"$"].join("|")+")",Ts+"?"+US+"+"+KS,Ts+"+"+BS,ID,TD,PS,AD].join("|"),"g"),MD=RegExp("["+DS+aa+AS+$S+"]"),CD=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,PD=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],FD=-1,De={};De[fd]=De[hd]=De[dd]=De[pd]=De[gd]=De[md]=De[yd]=De[_d]=De[bd]=!0,De[Es]=De[ia]=De[Ho]=De[Bo]=De[Os]=De[jo]=De[sa]=De[oa]=De[Pn]=De[Wo]=De[mr]=De[qo]=De[Fn]=De[Jo]=De[Go]=!1;var Ne={};Ne[Es]=Ne[ia]=Ne[Ho]=Ne[Os]=Ne[Bo]=Ne[jo]=Ne[fd]=Ne[hd]=Ne[dd]=Ne[pd]=Ne[gd]=Ne[Pn]=Ne[Wo]=Ne[mr]=Ne[qo]=Ne[Fn]=Ne[Jo]=Ne[ca]=Ne[md]=Ne[yd]=Ne[_d]=Ne[bd]=!0,Ne[sa]=Ne[oa]=Ne[Go]=!1;var ND={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},LD={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},DD={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},UD={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},KD=parseFloat,BD=parseInt,JS=typeof Ce=="object"&&Ce&&Ce.Object===Object&&Ce,jD=typeof self=="object"&&self&&self.Object===Object&&self,vt=JS||jD||Function("return this")(),Ad=t&&!t.nodeType&&t,mi=Ad&&!0&&e&&!e.nodeType&&e,GS=mi&&mi.exports===Ad,Rd=GS&&JS.process,dn=function(){try{var w=mi&&mi.require&&mi.require("util").types;return w||Rd&&Rd.binding&&Rd.binding("util")}catch{}}(),HS=dn&&dn.isArrayBuffer,VS=dn&&dn.isDate,zS=dn&&dn.isMap,YS=dn&&dn.isRegExp,XS=dn&&dn.isSet,ZS=dn&&dn.isTypedArray;function Qt(w,x,A){switch(A.length){case 0:return w.call(x);case 1:return w.call(x,A[0]);case 2:return w.call(x,A[0],A[1]);case 3:return w.call(x,A[0],A[1],A[2])}return w.apply(x,A)}function WD(w,x,A,J){for(var ie=-1,Re=w==null?0:w.length;++ie<Re;){var at=w[ie];x(J,at,A(at),w)}return J}function pn(w,x){for(var A=-1,J=w==null?0:w.length;++A<J&&x(w[A],A,w)!==!1;);return w}function qD(w,x){for(var A=w==null?0:w.length;A--&&x(w[A],A,w)!==!1;);return w}function QS(w,x){for(var A=-1,J=w==null?0:w.length;++A<J;)if(!x(w[A],A,w))return!1;return!0}function Pr(w,x){for(var A=-1,J=w==null?0:w.length,ie=0,Re=[];++A<J;){var at=w[A];x(at,A,w)&&(Re[ie++]=at)}return Re}function fa(w,x){var A=w==null?0:w.length;return!!A&&Is(w,x,0)>-1}function xd(w,x,A){for(var J=-1,ie=w==null?0:w.length;++J<ie;)if(A(x,w[J]))return!0;return!1}function Ue(w,x){for(var A=-1,J=w==null?0:w.length,ie=Array(J);++A<J;)ie[A]=x(w[A],A,w);return ie}function Fr(w,x){for(var A=-1,J=x.length,ie=w.length;++A<J;)w[ie+A]=x[A];return w}function kd(w,x,A,J){var ie=-1,Re=w==null?0:w.length;for(J&&Re&&(A=w[++ie]);++ie<Re;)A=x(A,w[ie],ie,w);return A}function JD(w,x,A,J){var ie=w==null?0:w.length;for(J&&ie&&(A=w[--ie]);ie--;)A=x(A,w[ie],ie,w);return A}function $d(w,x){for(var A=-1,J=w==null?0:w.length;++A<J;)if(x(w[A],A,w))return!0;return!1}var GD=Md("length");function HD(w){return w.split("")}function VD(w){return w.match(nD)||[]}function ew(w,x,A){var J;return A(w,function(ie,Re,at){if(x(ie,Re,at))return J=Re,!1}),J}function ha(w,x,A,J){for(var ie=w.length,Re=A+(J?1:-1);J?Re--:++Re<ie;)if(x(w[Re],Re,w))return Re;return-1}function Is(w,x,A){return x===x?oU(w,x,A):ha(w,tw,A)}function zD(w,x,A,J){for(var ie=A-1,Re=w.length;++ie<Re;)if(J(w[ie],x))return ie;return-1}function tw(w){return w!==w}function nw(w,x){var A=w==null?0:w.length;return A?Pd(w,x)/A:gr}function Md(w){return function(x){return x==null?n:x[w]}}function Cd(w){return function(x){return w==null?n:w[x]}}function rw(w,x,A,J,ie){return ie(w,function(Re,at,Pe){A=J?(J=!1,Re):x(A,Re,at,Pe)}),A}function YD(w,x){var A=w.length;for(w.sort(x);A--;)w[A]=w[A].value;return w}function Pd(w,x){for(var A,J=-1,ie=w.length;++J<ie;){var Re=x(w[J]);Re!==n&&(A=A===n?Re:A+Re)}return A}function Fd(w,x){for(var A=-1,J=Array(w);++A<w;)J[A]=x(A);return J}function XD(w,x){return Ue(x,function(A){return[A,w[A]]})}function iw(w){return w&&w.slice(0,uw(w)+1).replace(Sd,"")}function en(w){return function(x){return w(x)}}function Nd(w,x){return Ue(x,function(A){return w[A]})}function Vo(w,x){return w.has(x)}function sw(w,x){for(var A=-1,J=w.length;++A<J&&Is(x,w[A],0)>-1;);return A}function ow(w,x){for(var A=w.length;A--&&Is(x,w[A],0)>-1;);return A}function ZD(w,x){for(var A=w.length,J=0;A--;)w[A]===x&&++J;return J}var QD=Cd(ND),eU=Cd(LD);function tU(w){return"\\"+UD[w]}function nU(w,x){return w==null?n:w[x]}function As(w){return MD.test(w)}function rU(w){return CD.test(w)}function iU(w){for(var x,A=[];!(x=w.next()).done;)A.push(x.value);return A}function Ld(w){var x=-1,A=Array(w.size);return w.forEach(function(J,ie){A[++x]=[ie,J]}),A}function cw(w,x){return function(A){return w(x(A))}}function Nr(w,x){for(var A=-1,J=w.length,ie=0,Re=[];++A<J;){var at=w[A];(at===x||at===b)&&(w[A]=b,Re[ie++]=A)}return Re}function da(w){var x=-1,A=Array(w.size);return w.forEach(function(J){A[++x]=J}),A}function sU(w){var x=-1,A=Array(w.size);return w.forEach(function(J){A[++x]=[J,J]}),A}function oU(w,x,A){for(var J=A-1,ie=w.length;++J<ie;)if(w[J]===x)return J;return-1}function cU(w,x,A){for(var J=A+1;J--;)if(w[J]===x)return J;return J}function Rs(w){return As(w)?aU(w):GD(w)}function Nn(w){return As(w)?lU(w):HD(w)}function uw(w){for(var x=w.length;x--&&ZL.test(w.charAt(x)););return x}var uU=Cd(DD);function aU(w){for(var x=Id.lastIndex=0;Id.test(w);)++x;return x}function lU(w){return w.match(Id)||[]}function fU(w){return w.match($D)||[]}var hU=function w(x){x=x==null?vt:xs.defaults(vt.Object(),x,xs.pick(vt,PD));var A=x.Array,J=x.Date,ie=x.Error,Re=x.Function,at=x.Math,Pe=x.Object,Dd=x.RegExp,dU=x.String,gn=x.TypeError,pa=A.prototype,pU=Re.prototype,ks=Pe.prototype,ga=x["__core-js_shared__"],ma=pU.toString,ke=ks.hasOwnProperty,gU=0,aw=function(){var r=/[^.]+$/.exec(ga&&ga.keys&&ga.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),ya=ks.toString,mU=ma.call(Pe),yU=vt._,_U=Dd("^"+ma.call(ke).replace(vd,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),_a=GS?x.Buffer:n,Lr=x.Symbol,ba=x.Uint8Array,lw=_a?_a.allocUnsafe:n,va=cw(Pe.getPrototypeOf,Pe),fw=Pe.create,hw=ks.propertyIsEnumerable,Sa=pa.splice,dw=Lr?Lr.isConcatSpreadable:n,zo=Lr?Lr.iterator:n,yi=Lr?Lr.toStringTag:n,wa=function(){try{var r=wi(Pe,"defineProperty");return r({},"",{}),r}catch{}}(),bU=x.clearTimeout!==vt.clearTimeout&&x.clearTimeout,vU=J&&J.now!==vt.Date.now&&J.now,SU=x.setTimeout!==vt.setTimeout&&x.setTimeout,Ea=at.ceil,Oa=at.floor,Ud=Pe.getOwnPropertySymbols,wU=_a?_a.isBuffer:n,pw=x.isFinite,EU=pa.join,OU=cw(Pe.keys,Pe),lt=at.max,Rt=at.min,TU=J.now,IU=x.parseInt,gw=at.random,AU=pa.reverse,Kd=wi(x,"DataView"),Yo=wi(x,"Map"),Bd=wi(x,"Promise"),$s=wi(x,"Set"),Xo=wi(x,"WeakMap"),Zo=wi(Pe,"create"),Ta=Xo&&new Xo,Ms={},RU=Ei(Kd),xU=Ei(Yo),kU=Ei(Bd),$U=Ei($s),MU=Ei(Xo),Ia=Lr?Lr.prototype:n,Qo=Ia?Ia.valueOf:n,mw=Ia?Ia.toString:n;function m(r){if(He(r)&&!oe(r)&&!(r instanceof _e)){if(r instanceof mn)return r;if(ke.call(r,"__wrapped__"))return y1(r)}return new mn(r)}var Cs=function(){function r(){}return function(s){if(!qe(s))return{};if(fw)return fw(s);r.prototype=s;var c=new r;return r.prototype=n,c}}();function Aa(){}function mn(r,s){this.__wrapped__=r,this.__actions__=[],this.__chain__=!!s,this.__index__=0,this.__values__=n}m.templateSettings={escape:GL,evaluate:HL,interpolate:TS,variable:"",imports:{_:m}},m.prototype=Aa.prototype,m.prototype.constructor=m,mn.prototype=Cs(Aa.prototype),mn.prototype.constructor=mn;function _e(r){this.__wrapped__=r,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=At,this.__views__=[]}function CU(){var r=new _e(this.__wrapped__);return r.__actions__=Bt(this.__actions__),r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=Bt(this.__iteratees__),r.__takeCount__=this.__takeCount__,r.__views__=Bt(this.__views__),r}function PU(){if(this.__filtered__){var r=new _e(this);r.__dir__=-1,r.__filtered__=!0}else r=this.clone(),r.__dir__*=-1;return r}function FU(){var r=this.__wrapped__.value(),s=this.__dir__,c=oe(r),l=s<0,h=c?r.length:0,y=HK(0,h,this.__views__),_=y.start,S=y.end,E=S-_,$=l?S:_-1,M=this.__iteratees__,P=M.length,j=0,V=Rt(E,this.__takeCount__);if(!c||!l&&h==E&&V==E)return Kw(r,this.__actions__);var Q=[];e:for(;E--&&j<V;){$+=s;for(var he=-1,ee=r[$];++he<P;){var ye=M[he],ve=ye.iteratee,rn=ye.type,Ft=ve(ee);if(rn==ut)ee=Ft;else if(!Ft){if(rn==Ie)continue e;break e}}Q[j++]=ee}return Q}_e.prototype=Cs(Aa.prototype),_e.prototype.constructor=_e;function _i(r){var s=-1,c=r==null?0:r.length;for(this.clear();++s<c;){var l=r[s];this.set(l[0],l[1])}}function NU(){this.__data__=Zo?Zo(null):{},this.size=0}function LU(r){var s=this.has(r)&&delete this.__data__[r];return this.size-=s?1:0,s}function DU(r){var s=this.__data__;if(Zo){var c=s[r];return c===d?n:c}return ke.call(s,r)?s[r]:n}function UU(r){var s=this.__data__;return Zo?s[r]!==n:ke.call(s,r)}function KU(r,s){var c=this.__data__;return this.size+=this.has(r)?0:1,c[r]=Zo&&s===n?d:s,this}_i.prototype.clear=NU,_i.prototype.delete=LU,_i.prototype.get=DU,_i.prototype.has=UU,_i.prototype.set=KU;function yr(r){var s=-1,c=r==null?0:r.length;for(this.clear();++s<c;){var l=r[s];this.set(l[0],l[1])}}function BU(){this.__data__=[],this.size=0}function jU(r){var s=this.__data__,c=Ra(s,r);if(c<0)return!1;var l=s.length-1;return c==l?s.pop():Sa.call(s,c,1),--this.size,!0}function WU(r){var s=this.__data__,c=Ra(s,r);return c<0?n:s[c][1]}function qU(r){return Ra(this.__data__,r)>-1}function JU(r,s){var c=this.__data__,l=Ra(c,r);return l<0?(++this.size,c.push([r,s])):c[l][1]=s,this}yr.prototype.clear=BU,yr.prototype.delete=jU,yr.prototype.get=WU,yr.prototype.has=qU,yr.prototype.set=JU;function _r(r){var s=-1,c=r==null?0:r.length;for(this.clear();++s<c;){var l=r[s];this.set(l[0],l[1])}}function GU(){this.size=0,this.__data__={hash:new _i,map:new(Yo||yr),string:new _i}}function HU(r){var s=Ka(this,r).delete(r);return this.size-=s?1:0,s}function VU(r){return Ka(this,r).get(r)}function zU(r){return Ka(this,r).has(r)}function YU(r,s){var c=Ka(this,r),l=c.size;return c.set(r,s),this.size+=c.size==l?0:1,this}_r.prototype.clear=GU,_r.prototype.delete=HU,_r.prototype.get=VU,_r.prototype.has=zU,_r.prototype.set=YU;function bi(r){var s=-1,c=r==null?0:r.length;for(this.__data__=new _r;++s<c;)this.add(r[s])}function XU(r){return this.__data__.set(r,d),this}function ZU(r){return this.__data__.has(r)}bi.prototype.add=bi.prototype.push=XU,bi.prototype.has=ZU;function Ln(r){var s=this.__data__=new yr(r);this.size=s.size}function QU(){this.__data__=new yr,this.size=0}function eK(r){var s=this.__data__,c=s.delete(r);return this.size=s.size,c}function tK(r){return this.__data__.get(r)}function nK(r){return this.__data__.has(r)}function rK(r,s){var c=this.__data__;if(c instanceof yr){var l=c.__data__;if(!Yo||l.length<o-1)return l.push([r,s]),this.size=++c.size,this;c=this.__data__=new _r(l)}return c.set(r,s),this.size=c.size,this}Ln.prototype.clear=QU,Ln.prototype.delete=eK,Ln.prototype.get=tK,Ln.prototype.has=nK,Ln.prototype.set=rK;function yw(r,s){var c=oe(r),l=!c&&Oi(r),h=!c&&!l&&jr(r),y=!c&&!l&&!h&&Ls(r),_=c||l||h||y,S=_?Fd(r.length,dU):[],E=S.length;for(var $ in r)(s||ke.call(r,$))&&!(_&&($=="length"||h&&($=="offset"||$=="parent")||y&&($=="buffer"||$=="byteLength"||$=="byteOffset")||wr($,E)))&&S.push($);return S}function _w(r){var s=r.length;return s?r[Zd(0,s-1)]:n}function iK(r,s){return Ba(Bt(r),vi(s,0,r.length))}function sK(r){return Ba(Bt(r))}function jd(r,s,c){(c!==n&&!Dn(r[s],c)||c===n&&!(s in r))&&br(r,s,c)}function ec(r,s,c){var l=r[s];(!(ke.call(r,s)&&Dn(l,c))||c===n&&!(s in r))&&br(r,s,c)}function Ra(r,s){for(var c=r.length;c--;)if(Dn(r[c][0],s))return c;return-1}function oK(r,s,c,l){return Dr(r,function(h,y,_){s(l,h,c(h),_)}),l}function bw(r,s){return r&&er(s,gt(s),r)}function cK(r,s){return r&&er(s,Wt(s),r)}function br(r,s,c){s=="__proto__"&&wa?wa(r,s,{configurable:!0,enumerable:!0,value:c,writable:!0}):r[s]=c}function Wd(r,s){for(var c=-1,l=s.length,h=A(l),y=r==null;++c<l;)h[c]=y?n:Ep(r,s[c]);return h}function vi(r,s,c){return r===r&&(c!==n&&(r=r<=c?r:c),s!==n&&(r=r>=s?r:s)),r}function yn(r,s,c,l,h,y){var _,S=s&v,E=s&O,$=s&T;if(c&&(_=h?c(r,l,h,y):c(r)),_!==n)return _;if(!qe(r))return r;var M=oe(r);if(M){if(_=zK(r),!S)return Bt(r,_)}else{var P=xt(r),j=P==oa||P==SS;if(jr(r))return Ww(r,S);if(P==mr||P==Es||j&&!h){if(_=E||j?{}:u1(r),!S)return E?DK(r,cK(_,r)):LK(r,bw(_,r))}else{if(!Ne[P])return h?r:{};_=YK(r,P,S)}}y||(y=new Ln);var V=y.get(r);if(V)return V;y.set(r,_),L1(r)?r.forEach(function(ee){_.add(yn(ee,s,c,ee,r,y))}):F1(r)&&r.forEach(function(ee,ye){_.set(ye,yn(ee,s,c,ye,r,y))});var Q=$?E?ap:up:E?Wt:gt,he=M?n:Q(r);return pn(he||r,function(ee,ye){he&&(ye=ee,ee=r[ye]),ec(_,ye,yn(ee,s,c,ye,r,y))}),_}function uK(r){var s=gt(r);return function(c){return vw(c,r,s)}}function vw(r,s,c){var l=c.length;if(r==null)return!l;for(r=Pe(r);l--;){var h=c[l],y=s[h],_=r[h];if(_===n&&!(h in r)||!y(_))return!1}return!0}function Sw(r,s,c){if(typeof r!="function")throw new gn(a);return cc(function(){r.apply(n,c)},s)}function tc(r,s,c,l){var h=-1,y=fa,_=!0,S=r.length,E=[],$=s.length;if(!S)return E;c&&(s=Ue(s,en(c))),l?(y=xd,_=!1):s.length>=o&&(y=Vo,_=!1,s=new bi(s));e:for(;++h<S;){var M=r[h],P=c==null?M:c(M);if(M=l||M!==0?M:0,_&&P===P){for(var j=$;j--;)if(s[j]===P)continue e;E.push(M)}else y(s,P,l)||E.push(M)}return E}var Dr=Vw(Qn),ww=Vw(Jd,!0);function aK(r,s){var c=!0;return Dr(r,function(l,h,y){return c=!!s(l,h,y),c}),c}function xa(r,s,c){for(var l=-1,h=r.length;++l<h;){var y=r[l],_=s(y);if(_!=null&&(S===n?_===_&&!nn(_):c(_,S)))var S=_,E=y}return E}function lK(r,s,c,l){var h=r.length;for(c=ae(c),c<0&&(c=-c>h?0:h+c),l=l===n||l>h?h:ae(l),l<0&&(l+=h),l=c>l?0:U1(l);c<l;)r[c++]=s;return r}function Ew(r,s){var c=[];return Dr(r,function(l,h,y){s(l,h,y)&&c.push(l)}),c}function St(r,s,c,l,h){var y=-1,_=r.length;for(c||(c=ZK),h||(h=[]);++y<_;){var S=r[y];s>0&&c(S)?s>1?St(S,s-1,c,l,h):Fr(h,S):l||(h[h.length]=S)}return h}var qd=zw(),Ow=zw(!0);function Qn(r,s){return r&&qd(r,s,gt)}function Jd(r,s){return r&&Ow(r,s,gt)}function ka(r,s){return Pr(s,function(c){return Er(r[c])})}function Si(r,s){s=Kr(s,r);for(var c=0,l=s.length;r!=null&&c<l;)r=r[tr(s[c++])];return c&&c==l?r:n}function Tw(r,s,c){var l=s(r);return oe(r)?l:Fr(l,c(r))}function Ct(r){return r==null?r===n?UL:LL:yi&&yi in Pe(r)?GK(r):sB(r)}function Gd(r,s){return r>s}function fK(r,s){return r!=null&&ke.call(r,s)}function hK(r,s){return r!=null&&s in Pe(r)}function dK(r,s,c){return r>=Rt(s,c)&&r<lt(s,c)}function Hd(r,s,c){for(var l=c?xd:fa,h=r[0].length,y=r.length,_=y,S=A(y),E=1/0,$=[];_--;){var M=r[_];_&&s&&(M=Ue(M,en(s))),E=Rt(M.length,E),S[_]=!c&&(s||h>=120&&M.length>=120)?new bi(_&&M):n}M=r[0];var P=-1,j=S[0];e:for(;++P<h&&$.length<E;){var V=M[P],Q=s?s(V):V;if(V=c||V!==0?V:0,!(j?Vo(j,Q):l($,Q,c))){for(_=y;--_;){var he=S[_];if(!(he?Vo(he,Q):l(r[_],Q,c)))continue e}j&&j.push(Q),$.push(V)}}return $}function pK(r,s,c,l){return Qn(r,function(h,y,_){s(l,c(h),y,_)}),l}function nc(r,s,c){s=Kr(s,r),r=h1(r,s);var l=r==null?r:r[tr(bn(s))];return l==null?n:Qt(l,r,c)}function Iw(r){return He(r)&&Ct(r)==Es}function gK(r){return He(r)&&Ct(r)==Ho}function mK(r){return He(r)&&Ct(r)==jo}function rc(r,s,c,l,h){return r===s?!0:r==null||s==null||!He(r)&&!He(s)?r!==r&&s!==s:yK(r,s,c,l,rc,h)}function yK(r,s,c,l,h,y){var _=oe(r),S=oe(s),E=_?ia:xt(r),$=S?ia:xt(s);E=E==Es?mr:E,$=$==Es?mr:$;var M=E==mr,P=$==mr,j=E==$;if(j&&jr(r)){if(!jr(s))return!1;_=!0,M=!1}if(j&&!M)return y||(y=new Ln),_||Ls(r)?s1(r,s,c,l,h,y):qK(r,s,E,c,l,h,y);if(!(c&R)){var V=M&&ke.call(r,"__wrapped__"),Q=P&&ke.call(s,"__wrapped__");if(V||Q){var he=V?r.value():r,ee=Q?s.value():s;return y||(y=new Ln),h(he,ee,c,l,y)}}return j?(y||(y=new Ln),JK(r,s,c,l,h,y)):!1}function _K(r){return He(r)&&xt(r)==Pn}function Vd(r,s,c,l){var h=c.length,y=h,_=!l;if(r==null)return!y;for(r=Pe(r);h--;){var S=c[h];if(_&&S[2]?S[1]!==r[S[0]]:!(S[0]in r))return!1}for(;++h<y;){S=c[h];var E=S[0],$=r[E],M=S[1];if(_&&S[2]){if($===n&&!(E in r))return!1}else{var P=new Ln;if(l)var j=l($,M,E,r,s,P);if(!(j===n?rc(M,$,R|W,l,P):j))return!1}}return!0}function Aw(r){if(!qe(r)||eB(r))return!1;var s=Er(r)?_U:uD;return s.test(Ei(r))}function bK(r){return He(r)&&Ct(r)==qo}function vK(r){return He(r)&&xt(r)==Fn}function SK(r){return He(r)&&Ha(r.length)&&!!De[Ct(r)]}function Rw(r){return typeof r=="function"?r:r==null?qt:typeof r=="object"?oe(r)?$w(r[0],r[1]):kw(r):Y1(r)}function zd(r){if(!oc(r))return OU(r);var s=[];for(var c in Pe(r))ke.call(r,c)&&c!="constructor"&&s.push(c);return s}function wK(r){if(!qe(r))return iB(r);var s=oc(r),c=[];for(var l in r)l=="constructor"&&(s||!ke.call(r,l))||c.push(l);return c}function Yd(r,s){return r<s}function xw(r,s){var c=-1,l=jt(r)?A(r.length):[];return Dr(r,function(h,y,_){l[++c]=s(h,y,_)}),l}function kw(r){var s=fp(r);return s.length==1&&s[0][2]?l1(s[0][0],s[0][1]):function(c){return c===r||Vd(c,r,s)}}function $w(r,s){return dp(r)&&a1(s)?l1(tr(r),s):function(c){var l=Ep(c,r);return l===n&&l===s?Op(c,r):rc(s,l,R|W)}}function $a(r,s,c,l,h){r!==s&&qd(s,function(y,_){if(h||(h=new Ln),qe(y))EK(r,s,_,c,$a,l,h);else{var S=l?l(gp(r,_),y,_+"",r,s,h):n;S===n&&(S=y),jd(r,_,S)}},Wt)}function EK(r,s,c,l,h,y,_){var S=gp(r,c),E=gp(s,c),$=_.get(E);if($){jd(r,c,$);return}var M=y?y(S,E,c+"",r,s,_):n,P=M===n;if(P){var j=oe(E),V=!j&&jr(E),Q=!j&&!V&&Ls(E);M=E,j||V||Q?oe(S)?M=S:Ye(S)?M=Bt(S):V?(P=!1,M=Ww(E,!0)):Q?(P=!1,M=qw(E,!0)):M=[]:uc(E)||Oi(E)?(M=S,Oi(S)?M=K1(S):(!qe(S)||Er(S))&&(M=u1(E))):P=!1}P&&(_.set(E,M),h(M,E,l,y,_),_.delete(E)),jd(r,c,M)}function Mw(r,s){var c=r.length;if(c)return s+=s<0?c:0,wr(s,c)?r[s]:n}function Cw(r,s,c){s.length?s=Ue(s,function(y){return oe(y)?function(_){return Si(_,y.length===1?y[0]:y)}:y}):s=[qt];var l=-1;s=Ue(s,en(Z()));var h=xw(r,function(y,_,S){var E=Ue(s,function($){return $(y)});return{criteria:E,index:++l,value:y}});return YD(h,function(y,_){return NK(y,_,c)})}function OK(r,s){return Pw(r,s,function(c,l){return Op(r,l)})}function Pw(r,s,c){for(var l=-1,h=s.length,y={};++l<h;){var _=s[l],S=Si(r,_);c(S,_)&&ic(y,Kr(_,r),S)}return y}function TK(r){return function(s){return Si(s,r)}}function Xd(r,s,c,l){var h=l?zD:Is,y=-1,_=s.length,S=r;for(r===s&&(s=Bt(s)),c&&(S=Ue(r,en(c)));++y<_;)for(var E=0,$=s[y],M=c?c($):$;(E=h(S,M,E,l))>-1;)S!==r&&Sa.call(S,E,1),Sa.call(r,E,1);return r}function Fw(r,s){for(var c=r?s.length:0,l=c-1;c--;){var h=s[c];if(c==l||h!==y){var y=h;wr(h)?Sa.call(r,h,1):tp(r,h)}}return r}function Zd(r,s){return r+Oa(gw()*(s-r+1))}function IK(r,s,c,l){for(var h=-1,y=lt(Ea((s-r)/(c||1)),0),_=A(y);y--;)_[l?y:++h]=r,r+=c;return _}function Qd(r,s){var c="";if(!r||s<1||s>ze)return c;do s%2&&(c+=r),s=Oa(s/2),s&&(r+=r);while(s);return c}function pe(r,s){return mp(f1(r,s,qt),r+"")}function AK(r){return _w(Ds(r))}function RK(r,s){var c=Ds(r);return Ba(c,vi(s,0,c.length))}function ic(r,s,c,l){if(!qe(r))return r;s=Kr(s,r);for(var h=-1,y=s.length,_=y-1,S=r;S!=null&&++h<y;){var E=tr(s[h]),$=c;if(E==="__proto__"||E==="constructor"||E==="prototype")return r;if(h!=_){var M=S[E];$=l?l(M,E,S):n,$===n&&($=qe(M)?M:wr(s[h+1])?[]:{})}ec(S,E,$),S=S[E]}return r}var Nw=Ta?function(r,s){return Ta.set(r,s),r}:qt,xK=wa?function(r,s){return wa(r,"toString",{configurable:!0,enumerable:!1,value:Ip(s),writable:!0})}:qt;function kK(r){return Ba(Ds(r))}function _n(r,s,c){var l=-1,h=r.length;s<0&&(s=-s>h?0:h+s),c=c>h?h:c,c<0&&(c+=h),h=s>c?0:c-s>>>0,s>>>=0;for(var y=A(h);++l<h;)y[l]=r[l+s];return y}function $K(r,s){var c;return Dr(r,function(l,h,y){return c=s(l,h,y),!c}),!!c}function Ma(r,s,c){var l=0,h=r==null?l:r.length;if(typeof s=="number"&&s===s&&h<=CL){for(;l<h;){var y=l+h>>>1,_=r[y];_!==null&&!nn(_)&&(c?_<=s:_<s)?l=y+1:h=y}return h}return ep(r,s,qt,c)}function ep(r,s,c,l){var h=0,y=r==null?0:r.length;if(y===0)return 0;s=c(s);for(var _=s!==s,S=s===null,E=nn(s),$=s===n;h<y;){var M=Oa((h+y)/2),P=c(r[M]),j=P!==n,V=P===null,Q=P===P,he=nn(P);if(_)var ee=l||Q;else $?ee=Q&&(l||j):S?ee=Q&&j&&(l||!V):E?ee=Q&&j&&!V&&(l||!he):V||he?ee=!1:ee=l?P<=s:P<s;ee?h=M+1:y=M}return Rt(y,ML)}function Lw(r,s){for(var c=-1,l=r.length,h=0,y=[];++c<l;){var _=r[c],S=s?s(_):_;if(!c||!Dn(S,E)){var E=S;y[h++]=_===0?0:_}}return y}function Dw(r){return typeof r=="number"?r:nn(r)?gr:+r}function tn(r){if(typeof r=="string")return r;if(oe(r))return Ue(r,tn)+"";if(nn(r))return mw?mw.call(r):"";var s=r+"";return s=="0"&&1/r==-1/0?"-0":s}function Ur(r,s,c){var l=-1,h=fa,y=r.length,_=!0,S=[],E=S;if(c)_=!1,h=xd;else if(y>=o){var $=s?null:jK(r);if($)return da($);_=!1,h=Vo,E=new bi}else E=s?[]:S;e:for(;++l<y;){var M=r[l],P=s?s(M):M;if(M=c||M!==0?M:0,_&&P===P){for(var j=E.length;j--;)if(E[j]===P)continue e;s&&E.push(P),S.push(M)}else h(E,P,c)||(E!==S&&E.push(P),S.push(M))}return S}function tp(r,s){return s=Kr(s,r),r=h1(r,s),r==null||delete r[tr(bn(s))]}function Uw(r,s,c,l){return ic(r,s,c(Si(r,s)),l)}function Ca(r,s,c,l){for(var h=r.length,y=l?h:-1;(l?y--:++y<h)&&s(r[y],y,r););return c?_n(r,l?0:y,l?y+1:h):_n(r,l?y+1:0,l?h:y)}function Kw(r,s){var c=r;return c instanceof _e&&(c=c.value()),kd(s,function(l,h){return h.func.apply(h.thisArg,Fr([l],h.args))},c)}function np(r,s,c){var l=r.length;if(l<2)return l?Ur(r[0]):[];for(var h=-1,y=A(l);++h<l;)for(var _=r[h],S=-1;++S<l;)S!=h&&(y[h]=tc(y[h]||_,r[S],s,c));return Ur(St(y,1),s,c)}function Bw(r,s,c){for(var l=-1,h=r.length,y=s.length,_={};++l<h;){var S=l<y?s[l]:n;c(_,r[l],S)}return _}function rp(r){return Ye(r)?r:[]}function ip(r){return typeof r=="function"?r:qt}function Kr(r,s){return oe(r)?r:dp(r,s)?[r]:m1(xe(r))}var MK=pe;function Br(r,s,c){var l=r.length;return c=c===n?l:c,!s&&c>=l?r:_n(r,s,c)}var jw=bU||function(r){return vt.clearTimeout(r)};function Ww(r,s){if(s)return r.slice();var c=r.length,l=lw?lw(c):new r.constructor(c);return r.copy(l),l}function sp(r){var s=new r.constructor(r.byteLength);return new ba(s).set(new ba(r)),s}function CK(r,s){var c=s?sp(r.buffer):r.buffer;return new r.constructor(c,r.byteOffset,r.byteLength)}function PK(r){var s=new r.constructor(r.source,IS.exec(r));return s.lastIndex=r.lastIndex,s}function FK(r){return Qo?Pe(Qo.call(r)):{}}function qw(r,s){var c=s?sp(r.buffer):r.buffer;return new r.constructor(c,r.byteOffset,r.length)}function Jw(r,s){if(r!==s){var c=r!==n,l=r===null,h=r===r,y=nn(r),_=s!==n,S=s===null,E=s===s,$=nn(s);if(!S&&!$&&!y&&r>s||y&&_&&E&&!S&&!$||l&&_&&E||!c&&E||!h)return 1;if(!l&&!y&&!$&&r<s||$&&c&&h&&!l&&!y||S&&c&&h||!_&&h||!E)return-1}return 0}function NK(r,s,c){for(var l=-1,h=r.criteria,y=s.criteria,_=h.length,S=c.length;++l<_;){var E=Jw(h[l],y[l]);if(E){if(l>=S)return E;var $=c[l];return E*($=="desc"?-1:1)}}return r.index-s.index}function Gw(r,s,c,l){for(var h=-1,y=r.length,_=c.length,S=-1,E=s.length,$=lt(y-_,0),M=A(E+$),P=!l;++S<E;)M[S]=s[S];for(;++h<_;)(P||h<y)&&(M[c[h]]=r[h]);for(;$--;)M[S++]=r[h++];return M}function Hw(r,s,c,l){for(var h=-1,y=r.length,_=-1,S=c.length,E=-1,$=s.length,M=lt(y-S,0),P=A(M+$),j=!l;++h<M;)P[h]=r[h];for(var V=h;++E<$;)P[V+E]=s[E];for(;++_<S;)(j||h<y)&&(P[V+c[_]]=r[h++]);return P}function Bt(r,s){var c=-1,l=r.length;for(s||(s=A(l));++c<l;)s[c]=r[c];return s}function er(r,s,c,l){var h=!c;c||(c={});for(var y=-1,_=s.length;++y<_;){var S=s[y],E=l?l(c[S],r[S],S,c,r):n;E===n&&(E=r[S]),h?br(c,S,E):ec(c,S,E)}return c}function LK(r,s){return er(r,hp(r),s)}function DK(r,s){return er(r,o1(r),s)}function Pa(r,s){return function(c,l){var h=oe(c)?WD:oK,y=s?s():{};return h(c,r,Z(l,2),y)}}function Ps(r){return pe(function(s,c){var l=-1,h=c.length,y=h>1?c[h-1]:n,_=h>2?c[2]:n;for(y=r.length>3&&typeof y=="function"?(h--,y):n,_&&Pt(c[0],c[1],_)&&(y=h<3?n:y,h=1),s=Pe(s);++l<h;){var S=c[l];S&&r(s,S,l,y)}return s})}function Vw(r,s){return function(c,l){if(c==null)return c;if(!jt(c))return r(c,l);for(var h=c.length,y=s?h:-1,_=Pe(c);(s?y--:++y<h)&&l(_[y],y,_)!==!1;);return c}}function zw(r){return function(s,c,l){for(var h=-1,y=Pe(s),_=l(s),S=_.length;S--;){var E=_[r?S:++h];if(c(y[E],E,y)===!1)break}return s}}function UK(r,s,c){var l=s&F,h=sc(r);function y(){var _=this&&this!==vt&&this instanceof y?h:r;return _.apply(l?c:this,arguments)}return y}function Yw(r){return function(s){s=xe(s);var c=As(s)?Nn(s):n,l=c?c[0]:s.charAt(0),h=c?Br(c,1).join(""):s.slice(1);return l[r]()+h}}function Fs(r){return function(s){return kd(V1(H1(s).replace(xD,"")),r,"")}}function sc(r){return function(){var s=arguments;switch(s.length){case 0:return new r;case 1:return new r(s[0]);case 2:return new r(s[0],s[1]);case 3:return new r(s[0],s[1],s[2]);case 4:return new r(s[0],s[1],s[2],s[3]);case 5:return new r(s[0],s[1],s[2],s[3],s[4]);case 6:return new r(s[0],s[1],s[2],s[3],s[4],s[5]);case 7:return new r(s[0],s[1],s[2],s[3],s[4],s[5],s[6])}var c=Cs(r.prototype),l=r.apply(c,s);return qe(l)?l:c}}function KK(r,s,c){var l=sc(r);function h(){for(var y=arguments.length,_=A(y),S=y,E=Ns(h);S--;)_[S]=arguments[S];var $=y<3&&_[0]!==E&&_[y-1]!==E?[]:Nr(_,E);if(y-=$.length,y<c)return t1(r,s,Fa,h.placeholder,n,_,$,n,n,c-y);var M=this&&this!==vt&&this instanceof h?l:r;return Qt(M,this,_)}return h}function Xw(r){return function(s,c,l){var h=Pe(s);if(!jt(s)){var y=Z(c,3);s=gt(s),c=function(S){return y(h[S],S,h)}}var _=r(s,c,l);return _>-1?h[y?s[_]:_]:n}}function Zw(r){return Sr(function(s){var c=s.length,l=c,h=mn.prototype.thru;for(r&&s.reverse();l--;){var y=s[l];if(typeof y!="function")throw new gn(a);if(h&&!_&&Ua(y)=="wrapper")var _=new mn([],!0)}for(l=_?l:c;++l<c;){y=s[l];var S=Ua(y),E=S=="wrapper"?lp(y):n;E&&pp(E[0])&&E[1]==(k|B|Y|N)&&!E[4].length&&E[9]==1?_=_[Ua(E[0])].apply(_,E[3]):_=y.length==1&&pp(y)?_[S]():_.thru(y)}return function(){var $=arguments,M=$[0];if(_&&$.length==1&&oe(M))return _.plant(M).value();for(var P=0,j=c?s[P].apply(this,$):M;++P<c;)j=s[P].call(this,j);return j}})}function Fa(r,s,c,l,h,y,_,S,E,$){var M=s&k,P=s&F,j=s&L,V=s&(B|H),Q=s&U,he=j?n:sc(r);function ee(){for(var ye=arguments.length,ve=A(ye),rn=ye;rn--;)ve[rn]=arguments[rn];if(V)var Ft=Ns(ee),sn=ZD(ve,Ft);if(l&&(ve=Gw(ve,l,h,V)),y&&(ve=Hw(ve,y,_,V)),ye-=sn,V&&ye<$){var Xe=Nr(ve,Ft);return t1(r,s,Fa,ee.placeholder,c,ve,Xe,S,E,$-ye)}var Un=P?c:this,Tr=j?Un[r]:r;return ye=ve.length,S?ve=oB(ve,S):Q&&ye>1&&ve.reverse(),M&&E<ye&&(ve.length=E),this&&this!==vt&&this instanceof ee&&(Tr=he||sc(Tr)),Tr.apply(Un,ve)}return ee}function Qw(r,s){return function(c,l){return pK(c,r,s(l),{})}}function Na(r,s){return function(c,l){var h;if(c===n&&l===n)return s;if(c!==n&&(h=c),l!==n){if(h===n)return l;typeof c=="string"||typeof l=="string"?(c=tn(c),l=tn(l)):(c=Dw(c),l=Dw(l)),h=r(c,l)}return h}}function op(r){return Sr(function(s){return s=Ue(s,en(Z())),pe(function(c){var l=this;return r(s,function(h){return Qt(h,l,c)})})})}function La(r,s){s=s===n?" ":tn(s);var c=s.length;if(c<2)return c?Qd(s,r):s;var l=Qd(s,Ea(r/Rs(s)));return As(s)?Br(Nn(l),0,r).join(""):l.slice(0,r)}function BK(r,s,c,l){var h=s&F,y=sc(r);function _(){for(var S=-1,E=arguments.length,$=-1,M=l.length,P=A(M+E),j=this&&this!==vt&&this instanceof _?y:r;++$<M;)P[$]=l[$];for(;E--;)P[$++]=arguments[++S];return Qt(j,h?c:this,P)}return _}function e1(r){return function(s,c,l){return l&&typeof l!="number"&&Pt(s,c,l)&&(c=l=n),s=Or(s),c===n?(c=s,s=0):c=Or(c),l=l===n?s<c?1:-1:Or(l),IK(s,c,l,r)}}function Da(r){return function(s,c){return typeof s=="string"&&typeof c=="string"||(s=vn(s),c=vn(c)),r(s,c)}}function t1(r,s,c,l,h,y,_,S,E,$){var M=s&B,P=M?_:n,j=M?n:_,V=M?y:n,Q=M?n:y;s|=M?Y:G,s&=~(M?G:Y),s&z||(s&=-4);var he=[r,s,h,V,P,Q,j,S,E,$],ee=c.apply(n,he);return pp(r)&&d1(ee,he),ee.placeholder=l,p1(ee,r,s)}function cp(r){var s=at[r];return function(c,l){if(c=vn(c),l=l==null?0:Rt(ae(l),292),l&&pw(c)){var h=(xe(c)+"e").split("e"),y=s(h[0]+"e"+(+h[1]+l));return h=(xe(y)+"e").split("e"),+(h[0]+"e"+(+h[1]-l))}return s(c)}}var jK=$s&&1/da(new $s([,-0]))[1]==ne?function(r){return new $s(r)}:xp;function n1(r){return function(s){var c=xt(s);return c==Pn?Ld(s):c==Fn?sU(s):XD(s,r(s))}}function vr(r,s,c,l,h,y,_,S){var E=s&L;if(!E&&typeof r!="function")throw new gn(a);var $=l?l.length:0;if($||(s&=-97,l=h=n),_=_===n?_:lt(ae(_),0),S=S===n?S:ae(S),$-=h?h.length:0,s&G){var M=l,P=h;l=h=n}var j=E?n:lp(r),V=[r,s,c,l,h,M,P,y,_,S];if(j&&rB(V,j),r=V[0],s=V[1],c=V[2],l=V[3],h=V[4],S=V[9]=V[9]===n?E?0:r.length:lt(V[9]-$,0),!S&&s&(B|H)&&(s&=-25),!s||s==F)var Q=UK(r,s,c);else s==B||s==H?Q=KK(r,s,S):(s==Y||s==(F|Y))&&!h.length?Q=BK(r,s,c,l):Q=Fa.apply(n,V);var he=j?Nw:d1;return p1(he(Q,V),r,s)}function r1(r,s,c,l){return r===n||Dn(r,ks[c])&&!ke.call(l,c)?s:r}function i1(r,s,c,l,h,y){return qe(r)&&qe(s)&&(y.set(s,r),$a(r,s,n,i1,y),y.delete(s)),r}function WK(r){return uc(r)?n:r}function s1(r,s,c,l,h,y){var _=c&R,S=r.length,E=s.length;if(S!=E&&!(_&&E>S))return!1;var $=y.get(r),M=y.get(s);if($&&M)return $==s&&M==r;var P=-1,j=!0,V=c&W?new bi:n;for(y.set(r,s),y.set(s,r);++P<S;){var Q=r[P],he=s[P];if(l)var ee=_?l(he,Q,P,s,r,y):l(Q,he,P,r,s,y);if(ee!==n){if(ee)continue;j=!1;break}if(V){if(!$d(s,function(ye,ve){if(!Vo(V,ve)&&(Q===ye||h(Q,ye,c,l,y)))return V.push(ve)})){j=!1;break}}else if(!(Q===he||h(Q,he,c,l,y))){j=!1;break}}return y.delete(r),y.delete(s),j}function qK(r,s,c,l,h,y,_){switch(c){case Os:if(r.byteLength!=s.byteLength||r.byteOffset!=s.byteOffset)return!1;r=r.buffer,s=s.buffer;case Ho:return!(r.byteLength!=s.byteLength||!y(new ba(r),new ba(s)));case Bo:case jo:case Wo:return Dn(+r,+s);case sa:return r.name==s.name&&r.message==s.message;case qo:case Jo:return r==s+"";case Pn:var S=Ld;case Fn:var E=l&R;if(S||(S=da),r.size!=s.size&&!E)return!1;var $=_.get(r);if($)return $==s;l|=W,_.set(r,s);var M=s1(S(r),S(s),l,h,y,_);return _.delete(r),M;case ca:if(Qo)return Qo.call(r)==Qo.call(s)}return!1}function JK(r,s,c,l,h,y){var _=c&R,S=up(r),E=S.length,$=up(s),M=$.length;if(E!=M&&!_)return!1;for(var P=E;P--;){var j=S[P];if(!(_?j in s:ke.call(s,j)))return!1}var V=y.get(r),Q=y.get(s);if(V&&Q)return V==s&&Q==r;var he=!0;y.set(r,s),y.set(s,r);for(var ee=_;++P<E;){j=S[P];var ye=r[j],ve=s[j];if(l)var rn=_?l(ve,ye,j,s,r,y):l(ye,ve,j,r,s,y);if(!(rn===n?ye===ve||h(ye,ve,c,l,y):rn)){he=!1;break}ee||(ee=j=="constructor")}if(he&&!ee){var Ft=r.constructor,sn=s.constructor;Ft!=sn&&"constructor"in r&&"constructor"in s&&!(typeof Ft=="function"&&Ft instanceof Ft&&typeof sn=="function"&&sn instanceof sn)&&(he=!1)}return y.delete(r),y.delete(s),he}function Sr(r){return mp(f1(r,n,v1),r+"")}function up(r){return Tw(r,gt,hp)}function ap(r){return Tw(r,Wt,o1)}var lp=Ta?function(r){return Ta.get(r)}:xp;function Ua(r){for(var s=r.name+"",c=Ms[s],l=ke.call(Ms,s)?c.length:0;l--;){var h=c[l],y=h.func;if(y==null||y==r)return h.name}return s}function Ns(r){var s=ke.call(m,"placeholder")?m:r;return s.placeholder}function Z(){var r=m.iteratee||Ap;return r=r===Ap?Rw:r,arguments.length?r(arguments[0],arguments[1]):r}function Ka(r,s){var c=r.__data__;return QK(s)?c[typeof s=="string"?"string":"hash"]:c.map}function fp(r){for(var s=gt(r),c=s.length;c--;){var l=s[c],h=r[l];s[c]=[l,h,a1(h)]}return s}function wi(r,s){var c=nU(r,s);return Aw(c)?c:n}function GK(r){var s=ke.call(r,yi),c=r[yi];try{r[yi]=n;var l=!0}catch{}var h=ya.call(r);return l&&(s?r[yi]=c:delete r[yi]),h}var hp=Ud?function(r){return r==null?[]:(r=Pe(r),Pr(Ud(r),function(s){return hw.call(r,s)}))}:kp,o1=Ud?function(r){for(var s=[];r;)Fr(s,hp(r)),r=va(r);return s}:kp,xt=Ct;(Kd&&xt(new Kd(new ArrayBuffer(1)))!=Os||Yo&&xt(new Yo)!=Pn||Bd&&xt(Bd.resolve())!=wS||$s&&xt(new $s)!=Fn||Xo&&xt(new Xo)!=Go)&&(xt=function(r){var s=Ct(r),c=s==mr?r.constructor:n,l=c?Ei(c):"";if(l)switch(l){case RU:return Os;case xU:return Pn;case kU:return wS;case $U:return Fn;case MU:return Go}return s});function HK(r,s,c){for(var l=-1,h=c.length;++l<h;){var y=c[l],_=y.size;switch(y.type){case"drop":r+=_;break;case"dropRight":s-=_;break;case"take":s=Rt(s,r+_);break;case"takeRight":r=lt(r,s-_);break}}return{start:r,end:s}}function VK(r){var s=r.match(eD);return s?s[1].split(tD):[]}function c1(r,s,c){s=Kr(s,r);for(var l=-1,h=s.length,y=!1;++l<h;){var _=tr(s[l]);if(!(y=r!=null&&c(r,_)))break;r=r[_]}return y||++l!=h?y:(h=r==null?0:r.length,!!h&&Ha(h)&&wr(_,h)&&(oe(r)||Oi(r)))}function zK(r){var s=r.length,c=new r.constructor(s);return s&&typeof r[0]=="string"&&ke.call(r,"index")&&(c.index=r.index,c.input=r.input),c}function u1(r){return typeof r.constructor=="function"&&!oc(r)?Cs(va(r)):{}}function YK(r,s,c){var l=r.constructor;switch(s){case Ho:return sp(r);case Bo:case jo:return new l(+r);case Os:return CK(r,c);case fd:case hd:case dd:case pd:case gd:case md:case yd:case _d:case bd:return qw(r,c);case Pn:return new l;case Wo:case Jo:return new l(r);case qo:return PK(r);case Fn:return new l;case ca:return FK(r)}}function XK(r,s){var c=s.length;if(!c)return r;var l=c-1;return s[l]=(c>1?"& ":"")+s[l],s=s.join(c>2?", ":" "),r.replace(QL,`{
/* [wrapped with `+s+`] */
`)}function ZK(r){return oe(r)||Oi(r)||!!(dw&&r&&r[dw])}function wr(r,s){var c=typeof r;return s=s??ze,!!s&&(c=="number"||c!="symbol"&&lD.test(r))&&r>-1&&r%1==0&&r<s}function Pt(r,s,c){if(!qe(c))return!1;var l=typeof s;return(l=="number"?jt(c)&&wr(s,c.length):l=="string"&&s in c)?Dn(c[s],r):!1}function dp(r,s){if(oe(r))return!1;var c=typeof r;return c=="number"||c=="symbol"||c=="boolean"||r==null||nn(r)?!0:zL.test(r)||!VL.test(r)||s!=null&&r in Pe(s)}function QK(r){var s=typeof r;return s=="string"||s=="number"||s=="symbol"||s=="boolean"?r!=="__proto__":r===null}function pp(r){var s=Ua(r),c=m[s];if(typeof c!="function"||!(s in _e.prototype))return!1;if(r===c)return!0;var l=lp(c);return!!l&&r===l[0]}function eB(r){return!!aw&&aw in r}var tB=ga?Er:$p;function oc(r){var s=r&&r.constructor,c=typeof s=="function"&&s.prototype||ks;return r===c}function a1(r){return r===r&&!qe(r)}function l1(r,s){return function(c){return c==null?!1:c[r]===s&&(s!==n||r in Pe(c))}}function nB(r){var s=Ja(r,function(l){return c.size===g&&c.clear(),l}),c=s.cache;return s}function rB(r,s){var c=r[1],l=s[1],h=c|l,y=h<(F|L|k),_=l==k&&c==B||l==k&&c==N&&r[7].length<=s[8]||l==(k|N)&&s[7].length<=s[8]&&c==B;if(!(y||_))return r;l&F&&(r[2]=s[2],h|=c&F?0:z);var S=s[3];if(S){var E=r[3];r[3]=E?Gw(E,S,s[4]):S,r[4]=E?Nr(r[3],b):s[4]}return S=s[5],S&&(E=r[5],r[5]=E?Hw(E,S,s[6]):S,r[6]=E?Nr(r[5],b):s[6]),S=s[7],S&&(r[7]=S),l&k&&(r[8]=r[8]==null?s[8]:Rt(r[8],s[8])),r[9]==null&&(r[9]=s[9]),r[0]=s[0],r[1]=h,r}function iB(r){var s=[];if(r!=null)for(var c in Pe(r))s.push(c);return s}function sB(r){return ya.call(r)}function f1(r,s,c){return s=lt(s===n?r.length-1:s,0),function(){for(var l=arguments,h=-1,y=lt(l.length-s,0),_=A(y);++h<y;)_[h]=l[s+h];h=-1;for(var S=A(s+1);++h<s;)S[h]=l[h];return S[s]=c(_),Qt(r,this,S)}}function h1(r,s){return s.length<2?r:Si(r,_n(s,0,-1))}function oB(r,s){for(var c=r.length,l=Rt(s.length,c),h=Bt(r);l--;){var y=s[l];r[l]=wr(y,c)?h[y]:n}return r}function gp(r,s){if(!(s==="constructor"&&typeof r[s]=="function")&&s!="__proto__")return r[s]}var d1=g1(Nw),cc=SU||function(r,s){return vt.setTimeout(r,s)},mp=g1(xK);function p1(r,s,c){var l=s+"";return mp(r,XK(l,cB(VK(l),c)))}function g1(r){var s=0,c=0;return function(){var l=TU(),h=Te-(l-c);if(c=l,h>0){if(++s>=q)return arguments[0]}else s=0;return r.apply(n,arguments)}}function Ba(r,s){var c=-1,l=r.length,h=l-1;for(s=s===n?l:s;++c<s;){var y=Zd(c,h),_=r[y];r[y]=r[c],r[c]=_}return r.length=s,r}var m1=nB(function(r){var s=[];return r.charCodeAt(0)===46&&s.push(""),r.replace(YL,function(c,l,h,y){s.push(h?y.replace(iD,"$1"):l||c)}),s});function tr(r){if(typeof r=="string"||nn(r))return r;var s=r+"";return s=="0"&&1/r==-1/0?"-0":s}function Ei(r){if(r!=null){try{return ma.call(r)}catch{}try{return r+""}catch{}}return""}function cB(r,s){return pn(PL,function(c){var l="_."+c[0];s&c[1]&&!fa(r,l)&&r.push(l)}),r.sort()}function y1(r){if(r instanceof _e)return r.clone();var s=new mn(r.__wrapped__,r.__chain__);return s.__actions__=Bt(r.__actions__),s.__index__=r.__index__,s.__values__=r.__values__,s}function uB(r,s,c){(c?Pt(r,s,c):s===n)?s=1:s=lt(ae(s),0);var l=r==null?0:r.length;if(!l||s<1)return[];for(var h=0,y=0,_=A(Ea(l/s));h<l;)_[y++]=_n(r,h,h+=s);return _}function aB(r){for(var s=-1,c=r==null?0:r.length,l=0,h=[];++s<c;){var y=r[s];y&&(h[l++]=y)}return h}function lB(){var r=arguments.length;if(!r)return[];for(var s=A(r-1),c=arguments[0],l=r;l--;)s[l-1]=arguments[l];return Fr(oe(c)?Bt(c):[c],St(s,1))}var fB=pe(function(r,s){return Ye(r)?tc(r,St(s,1,Ye,!0)):[]}),hB=pe(function(r,s){var c=bn(s);return Ye(c)&&(c=n),Ye(r)?tc(r,St(s,1,Ye,!0),Z(c,2)):[]}),dB=pe(function(r,s){var c=bn(s);return Ye(c)&&(c=n),Ye(r)?tc(r,St(s,1,Ye,!0),n,c):[]});function pB(r,s,c){var l=r==null?0:r.length;return l?(s=c||s===n?1:ae(s),_n(r,s<0?0:s,l)):[]}function gB(r,s,c){var l=r==null?0:r.length;return l?(s=c||s===n?1:ae(s),s=l-s,_n(r,0,s<0?0:s)):[]}function mB(r,s){return r&&r.length?Ca(r,Z(s,3),!0,!0):[]}function yB(r,s){return r&&r.length?Ca(r,Z(s,3),!0):[]}function _B(r,s,c,l){var h=r==null?0:r.length;return h?(c&&typeof c!="number"&&Pt(r,s,c)&&(c=0,l=h),lK(r,s,c,l)):[]}function _1(r,s,c){var l=r==null?0:r.length;if(!l)return-1;var h=c==null?0:ae(c);return h<0&&(h=lt(l+h,0)),ha(r,Z(s,3),h)}function b1(r,s,c){var l=r==null?0:r.length;if(!l)return-1;var h=l-1;return c!==n&&(h=ae(c),h=c<0?lt(l+h,0):Rt(h,l-1)),ha(r,Z(s,3),h,!0)}function v1(r){var s=r==null?0:r.length;return s?St(r,1):[]}function bB(r){var s=r==null?0:r.length;return s?St(r,ne):[]}function vB(r,s){var c=r==null?0:r.length;return c?(s=s===n?1:ae(s),St(r,s)):[]}function SB(r){for(var s=-1,c=r==null?0:r.length,l={};++s<c;){var h=r[s];l[h[0]]=h[1]}return l}function S1(r){return r&&r.length?r[0]:n}function wB(r,s,c){var l=r==null?0:r.length;if(!l)return-1;var h=c==null?0:ae(c);return h<0&&(h=lt(l+h,0)),Is(r,s,h)}function EB(r){var s=r==null?0:r.length;return s?_n(r,0,-1):[]}var OB=pe(function(r){var s=Ue(r,rp);return s.length&&s[0]===r[0]?Hd(s):[]}),TB=pe(function(r){var s=bn(r),c=Ue(r,rp);return s===bn(c)?s=n:c.pop(),c.length&&c[0]===r[0]?Hd(c,Z(s,2)):[]}),IB=pe(function(r){var s=bn(r),c=Ue(r,rp);return s=typeof s=="function"?s:n,s&&c.pop(),c.length&&c[0]===r[0]?Hd(c,n,s):[]});function AB(r,s){return r==null?"":EU.call(r,s)}function bn(r){var s=r==null?0:r.length;return s?r[s-1]:n}function RB(r,s,c){var l=r==null?0:r.length;if(!l)return-1;var h=l;return c!==n&&(h=ae(c),h=h<0?lt(l+h,0):Rt(h,l-1)),s===s?cU(r,s,h):ha(r,tw,h,!0)}function xB(r,s){return r&&r.length?Mw(r,ae(s)):n}var kB=pe(w1);function w1(r,s){return r&&r.length&&s&&s.length?Xd(r,s):r}function $B(r,s,c){return r&&r.length&&s&&s.length?Xd(r,s,Z(c,2)):r}function MB(r,s,c){return r&&r.length&&s&&s.length?Xd(r,s,n,c):r}var CB=Sr(function(r,s){var c=r==null?0:r.length,l=Wd(r,s);return Fw(r,Ue(s,function(h){return wr(h,c)?+h:h}).sort(Jw)),l});function PB(r,s){var c=[];if(!(r&&r.length))return c;var l=-1,h=[],y=r.length;for(s=Z(s,3);++l<y;){var _=r[l];s(_,l,r)&&(c.push(_),h.push(l))}return Fw(r,h),c}function yp(r){return r==null?r:AU.call(r)}function FB(r,s,c){var l=r==null?0:r.length;return l?(c&&typeof c!="number"&&Pt(r,s,c)?(s=0,c=l):(s=s==null?0:ae(s),c=c===n?l:ae(c)),_n(r,s,c)):[]}function NB(r,s){return Ma(r,s)}function LB(r,s,c){return ep(r,s,Z(c,2))}function DB(r,s){var c=r==null?0:r.length;if(c){var l=Ma(r,s);if(l<c&&Dn(r[l],s))return l}return-1}function UB(r,s){return Ma(r,s,!0)}function KB(r,s,c){return ep(r,s,Z(c,2),!0)}function BB(r,s){var c=r==null?0:r.length;if(c){var l=Ma(r,s,!0)-1;if(Dn(r[l],s))return l}return-1}function jB(r){return r&&r.length?Lw(r):[]}function WB(r,s){return r&&r.length?Lw(r,Z(s,2)):[]}function qB(r){var s=r==null?0:r.length;return s?_n(r,1,s):[]}function JB(r,s,c){return r&&r.length?(s=c||s===n?1:ae(s),_n(r,0,s<0?0:s)):[]}function GB(r,s,c){var l=r==null?0:r.length;return l?(s=c||s===n?1:ae(s),s=l-s,_n(r,s<0?0:s,l)):[]}function HB(r,s){return r&&r.length?Ca(r,Z(s,3),!1,!0):[]}function VB(r,s){return r&&r.length?Ca(r,Z(s,3)):[]}var zB=pe(function(r){return Ur(St(r,1,Ye,!0))}),YB=pe(function(r){var s=bn(r);return Ye(s)&&(s=n),Ur(St(r,1,Ye,!0),Z(s,2))}),XB=pe(function(r){var s=bn(r);return s=typeof s=="function"?s:n,Ur(St(r,1,Ye,!0),n,s)});function ZB(r){return r&&r.length?Ur(r):[]}function QB(r,s){return r&&r.length?Ur(r,Z(s,2)):[]}function e2(r,s){return s=typeof s=="function"?s:n,r&&r.length?Ur(r,n,s):[]}function _p(r){if(!(r&&r.length))return[];var s=0;return r=Pr(r,function(c){if(Ye(c))return s=lt(c.length,s),!0}),Fd(s,function(c){return Ue(r,Md(c))})}function E1(r,s){if(!(r&&r.length))return[];var c=_p(r);return s==null?c:Ue(c,function(l){return Qt(s,n,l)})}var t2=pe(function(r,s){return Ye(r)?tc(r,s):[]}),n2=pe(function(r){return np(Pr(r,Ye))}),r2=pe(function(r){var s=bn(r);return Ye(s)&&(s=n),np(Pr(r,Ye),Z(s,2))}),i2=pe(function(r){var s=bn(r);return s=typeof s=="function"?s:n,np(Pr(r,Ye),n,s)}),s2=pe(_p);function o2(r,s){return Bw(r||[],s||[],ec)}function c2(r,s){return Bw(r||[],s||[],ic)}var u2=pe(function(r){var s=r.length,c=s>1?r[s-1]:n;return c=typeof c=="function"?(r.pop(),c):n,E1(r,c)});function O1(r){var s=m(r);return s.__chain__=!0,s}function a2(r,s){return s(r),r}function ja(r,s){return s(r)}var l2=Sr(function(r){var s=r.length,c=s?r[0]:0,l=this.__wrapped__,h=function(y){return Wd(y,r)};return s>1||this.__actions__.length||!(l instanceof _e)||!wr(c)?this.thru(h):(l=l.slice(c,+c+(s?1:0)),l.__actions__.push({func:ja,args:[h],thisArg:n}),new mn(l,this.__chain__).thru(function(y){return s&&!y.length&&y.push(n),y}))});function f2(){return O1(this)}function h2(){return new mn(this.value(),this.__chain__)}function d2(){this.__values__===n&&(this.__values__=D1(this.value()));var r=this.__index__>=this.__values__.length,s=r?n:this.__values__[this.__index__++];return{done:r,value:s}}function p2(){return this}function g2(r){for(var s,c=this;c instanceof Aa;){var l=y1(c);l.__index__=0,l.__values__=n,s?h.__wrapped__=l:s=l;var h=l;c=c.__wrapped__}return h.__wrapped__=r,s}function m2(){var r=this.__wrapped__;if(r instanceof _e){var s=r;return this.__actions__.length&&(s=new _e(this)),s=s.reverse(),s.__actions__.push({func:ja,args:[yp],thisArg:n}),new mn(s,this.__chain__)}return this.thru(yp)}function y2(){return Kw(this.__wrapped__,this.__actions__)}var _2=Pa(function(r,s,c){ke.call(r,c)?++r[c]:br(r,c,1)});function b2(r,s,c){var l=oe(r)?QS:aK;return c&&Pt(r,s,c)&&(s=n),l(r,Z(s,3))}function v2(r,s){var c=oe(r)?Pr:Ew;return c(r,Z(s,3))}var S2=Xw(_1),w2=Xw(b1);function E2(r,s){return St(Wa(r,s),1)}function O2(r,s){return St(Wa(r,s),ne)}function T2(r,s,c){return c=c===n?1:ae(c),St(Wa(r,s),c)}function T1(r,s){var c=oe(r)?pn:Dr;return c(r,Z(s,3))}function I1(r,s){var c=oe(r)?qD:ww;return c(r,Z(s,3))}var I2=Pa(function(r,s,c){ke.call(r,c)?r[c].push(s):br(r,c,[s])});function A2(r,s,c,l){r=jt(r)?r:Ds(r),c=c&&!l?ae(c):0;var h=r.length;return c<0&&(c=lt(h+c,0)),Va(r)?c<=h&&r.indexOf(s,c)>-1:!!h&&Is(r,s,c)>-1}var R2=pe(function(r,s,c){var l=-1,h=typeof s=="function",y=jt(r)?A(r.length):[];return Dr(r,function(_){y[++l]=h?Qt(s,_,c):nc(_,s,c)}),y}),x2=Pa(function(r,s,c){br(r,c,s)});function Wa(r,s){var c=oe(r)?Ue:xw;return c(r,Z(s,3))}function k2(r,s,c,l){return r==null?[]:(oe(s)||(s=s==null?[]:[s]),c=l?n:c,oe(c)||(c=c==null?[]:[c]),Cw(r,s,c))}var $2=Pa(function(r,s,c){r[c?0:1].push(s)},function(){return[[],[]]});function M2(r,s,c){var l=oe(r)?kd:rw,h=arguments.length<3;return l(r,Z(s,4),c,h,Dr)}function C2(r,s,c){var l=oe(r)?JD:rw,h=arguments.length<3;return l(r,Z(s,4),c,h,ww)}function P2(r,s){var c=oe(r)?Pr:Ew;return c(r,Ga(Z(s,3)))}function F2(r){var s=oe(r)?_w:AK;return s(r)}function N2(r,s,c){(c?Pt(r,s,c):s===n)?s=1:s=ae(s);var l=oe(r)?iK:RK;return l(r,s)}function L2(r){var s=oe(r)?sK:kK;return s(r)}function D2(r){if(r==null)return 0;if(jt(r))return Va(r)?Rs(r):r.length;var s=xt(r);return s==Pn||s==Fn?r.size:zd(r).length}function U2(r,s,c){var l=oe(r)?$d:$K;return c&&Pt(r,s,c)&&(s=n),l(r,Z(s,3))}var K2=pe(function(r,s){if(r==null)return[];var c=s.length;return c>1&&Pt(r,s[0],s[1])?s=[]:c>2&&Pt(s[0],s[1],s[2])&&(s=[s[0]]),Cw(r,St(s,1),[])}),qa=vU||function(){return vt.Date.now()};function B2(r,s){if(typeof s!="function")throw new gn(a);return r=ae(r),function(){if(--r<1)return s.apply(this,arguments)}}function A1(r,s,c){return s=c?n:s,s=r&&s==null?r.length:s,vr(r,k,n,n,n,n,s)}function R1(r,s){var c;if(typeof s!="function")throw new gn(a);return r=ae(r),function(){return--r>0&&(c=s.apply(this,arguments)),r<=1&&(s=n),c}}var bp=pe(function(r,s,c){var l=F;if(c.length){var h=Nr(c,Ns(bp));l|=Y}return vr(r,l,s,c,h)}),x1=pe(function(r,s,c){var l=F|L;if(c.length){var h=Nr(c,Ns(x1));l|=Y}return vr(s,l,r,c,h)});function k1(r,s,c){s=c?n:s;var l=vr(r,B,n,n,n,n,n,s);return l.placeholder=k1.placeholder,l}function $1(r,s,c){s=c?n:s;var l=vr(r,H,n,n,n,n,n,s);return l.placeholder=$1.placeholder,l}function M1(r,s,c){var l,h,y,_,S,E,$=0,M=!1,P=!1,j=!0;if(typeof r!="function")throw new gn(a);s=vn(s)||0,qe(c)&&(M=!!c.leading,P="maxWait"in c,y=P?lt(vn(c.maxWait)||0,s):y,j="trailing"in c?!!c.trailing:j);function V(Xe){var Un=l,Tr=h;return l=h=n,$=Xe,_=r.apply(Tr,Un),_}function Q(Xe){return $=Xe,S=cc(ye,s),M?V(Xe):_}function he(Xe){var Un=Xe-E,Tr=Xe-$,X1=s-Un;return P?Rt(X1,y-Tr):X1}function ee(Xe){var Un=Xe-E,Tr=Xe-$;return E===n||Un>=s||Un<0||P&&Tr>=y}function ye(){var Xe=qa();if(ee(Xe))return ve(Xe);S=cc(ye,he(Xe))}function ve(Xe){return S=n,j&&l?V(Xe):(l=h=n,_)}function rn(){S!==n&&jw(S),$=0,l=E=h=S=n}function Ft(){return S===n?_:ve(qa())}function sn(){var Xe=qa(),Un=ee(Xe);if(l=arguments,h=this,E=Xe,Un){if(S===n)return Q(E);if(P)return jw(S),S=cc(ye,s),V(E)}return S===n&&(S=cc(ye,s)),_}return sn.cancel=rn,sn.flush=Ft,sn}var j2=pe(function(r,s){return Sw(r,1,s)}),W2=pe(function(r,s,c){return Sw(r,vn(s)||0,c)});function q2(r){return vr(r,U)}function Ja(r,s){if(typeof r!="function"||s!=null&&typeof s!="function")throw new gn(a);var c=function(){var l=arguments,h=s?s.apply(this,l):l[0],y=c.cache;if(y.has(h))return y.get(h);var _=r.apply(this,l);return c.cache=y.set(h,_)||y,_};return c.cache=new(Ja.Cache||_r),c}Ja.Cache=_r;function Ga(r){if(typeof r!="function")throw new gn(a);return function(){var s=arguments;switch(s.length){case 0:return!r.call(this);case 1:return!r.call(this,s[0]);case 2:return!r.call(this,s[0],s[1]);case 3:return!r.call(this,s[0],s[1],s[2])}return!r.apply(this,s)}}function J2(r){return R1(2,r)}var G2=MK(function(r,s){s=s.length==1&&oe(s[0])?Ue(s[0],en(Z())):Ue(St(s,1),en(Z()));var c=s.length;return pe(function(l){for(var h=-1,y=Rt(l.length,c);++h<y;)l[h]=s[h].call(this,l[h]);return Qt(r,this,l)})}),vp=pe(function(r,s){var c=Nr(s,Ns(vp));return vr(r,Y,n,s,c)}),C1=pe(function(r,s){var c=Nr(s,Ns(C1));return vr(r,G,n,s,c)}),H2=Sr(function(r,s){return vr(r,N,n,n,n,s)});function V2(r,s){if(typeof r!="function")throw new gn(a);return s=s===n?s:ae(s),pe(r,s)}function z2(r,s){if(typeof r!="function")throw new gn(a);return s=s==null?0:lt(ae(s),0),pe(function(c){var l=c[s],h=Br(c,0,s);return l&&Fr(h,l),Qt(r,this,h)})}function Y2(r,s,c){var l=!0,h=!0;if(typeof r!="function")throw new gn(a);return qe(c)&&(l="leading"in c?!!c.leading:l,h="trailing"in c?!!c.trailing:h),M1(r,s,{leading:l,maxWait:s,trailing:h})}function X2(r){return A1(r,1)}function Z2(r,s){return vp(ip(s),r)}function Q2(){if(!arguments.length)return[];var r=arguments[0];return oe(r)?r:[r]}function ej(r){return yn(r,T)}function tj(r,s){return s=typeof s=="function"?s:n,yn(r,T,s)}function nj(r){return yn(r,v|T)}function rj(r,s){return s=typeof s=="function"?s:n,yn(r,v|T,s)}function ij(r,s){return s==null||vw(r,s,gt(s))}function Dn(r,s){return r===s||r!==r&&s!==s}var sj=Da(Gd),oj=Da(function(r,s){return r>=s}),Oi=Iw(function(){return arguments}())?Iw:function(r){return He(r)&&ke.call(r,"callee")&&!hw.call(r,"callee")},oe=A.isArray,cj=HS?en(HS):gK;function jt(r){return r!=null&&Ha(r.length)&&!Er(r)}function Ye(r){return He(r)&&jt(r)}function uj(r){return r===!0||r===!1||He(r)&&Ct(r)==Bo}var jr=wU||$p,aj=VS?en(VS):mK;function lj(r){return He(r)&&r.nodeType===1&&!uc(r)}function fj(r){if(r==null)return!0;if(jt(r)&&(oe(r)||typeof r=="string"||typeof r.splice=="function"||jr(r)||Ls(r)||Oi(r)))return!r.length;var s=xt(r);if(s==Pn||s==Fn)return!r.size;if(oc(r))return!zd(r).length;for(var c in r)if(ke.call(r,c))return!1;return!0}function hj(r,s){return rc(r,s)}function dj(r,s,c){c=typeof c=="function"?c:n;var l=c?c(r,s):n;return l===n?rc(r,s,n,c):!!l}function Sp(r){if(!He(r))return!1;var s=Ct(r);return s==sa||s==NL||typeof r.message=="string"&&typeof r.name=="string"&&!uc(r)}function pj(r){return typeof r=="number"&&pw(r)}function Er(r){if(!qe(r))return!1;var s=Ct(r);return s==oa||s==SS||s==FL||s==DL}function P1(r){return typeof r=="number"&&r==ae(r)}function Ha(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=ze}function qe(r){var s=typeof r;return r!=null&&(s=="object"||s=="function")}function He(r){return r!=null&&typeof r=="object"}var F1=zS?en(zS):_K;function gj(r,s){return r===s||Vd(r,s,fp(s))}function mj(r,s,c){return c=typeof c=="function"?c:n,Vd(r,s,fp(s),c)}function yj(r){return N1(r)&&r!=+r}function _j(r){if(tB(r))throw new ie(u);return Aw(r)}function bj(r){return r===null}function vj(r){return r==null}function N1(r){return typeof r=="number"||He(r)&&Ct(r)==Wo}function uc(r){if(!He(r)||Ct(r)!=mr)return!1;var s=va(r);if(s===null)return!0;var c=ke.call(s,"constructor")&&s.constructor;return typeof c=="function"&&c instanceof c&&ma.call(c)==mU}var wp=YS?en(YS):bK;function Sj(r){return P1(r)&&r>=-9007199254740991&&r<=ze}var L1=XS?en(XS):vK;function Va(r){return typeof r=="string"||!oe(r)&&He(r)&&Ct(r)==Jo}function nn(r){return typeof r=="symbol"||He(r)&&Ct(r)==ca}var Ls=ZS?en(ZS):SK;function wj(r){return r===n}function Ej(r){return He(r)&&xt(r)==Go}function Oj(r){return He(r)&&Ct(r)==KL}var Tj=Da(Yd),Ij=Da(function(r,s){return r<=s});function D1(r){if(!r)return[];if(jt(r))return Va(r)?Nn(r):Bt(r);if(zo&&r[zo])return iU(r[zo]());var s=xt(r),c=s==Pn?Ld:s==Fn?da:Ds;return c(r)}function Or(r){if(!r)return r===0?r:0;if(r=vn(r),r===ne||r===-1/0){var s=r<0?-1:1;return s*Cn}return r===r?r:0}function ae(r){var s=Or(r),c=s%1;return s===s?c?s-c:s:0}function U1(r){return r?vi(ae(r),0,At):0}function vn(r){if(typeof r=="number")return r;if(nn(r))return gr;if(qe(r)){var s=typeof r.valueOf=="function"?r.valueOf():r;r=qe(s)?s+"":s}if(typeof r!="string")return r===0?r:+r;r=iw(r);var c=cD.test(r);return c||aD.test(r)?BD(r.slice(2),c?2:8):oD.test(r)?gr:+r}function K1(r){return er(r,Wt(r))}function Aj(r){return r?vi(ae(r),-9007199254740991,ze):r===0?r:0}function xe(r){return r==null?"":tn(r)}var Rj=Ps(function(r,s){if(oc(s)||jt(s)){er(s,gt(s),r);return}for(var c in s)ke.call(s,c)&&ec(r,c,s[c])}),B1=Ps(function(r,s){er(s,Wt(s),r)}),za=Ps(function(r,s,c,l){er(s,Wt(s),r,l)}),xj=Ps(function(r,s,c,l){er(s,gt(s),r,l)}),kj=Sr(Wd);function $j(r,s){var c=Cs(r);return s==null?c:bw(c,s)}var Mj=pe(function(r,s){r=Pe(r);var c=-1,l=s.length,h=l>2?s[2]:n;for(h&&Pt(s[0],s[1],h)&&(l=1);++c<l;)for(var y=s[c],_=Wt(y),S=-1,E=_.length;++S<E;){var $=_[S],M=r[$];(M===n||Dn(M,ks[$])&&!ke.call(r,$))&&(r[$]=y[$])}return r}),Cj=pe(function(r){return r.push(n,i1),Qt(j1,n,r)});function Pj(r,s){return ew(r,Z(s,3),Qn)}function Fj(r,s){return ew(r,Z(s,3),Jd)}function Nj(r,s){return r==null?r:qd(r,Z(s,3),Wt)}function Lj(r,s){return r==null?r:Ow(r,Z(s,3),Wt)}function Dj(r,s){return r&&Qn(r,Z(s,3))}function Uj(r,s){return r&&Jd(r,Z(s,3))}function Kj(r){return r==null?[]:ka(r,gt(r))}function Bj(r){return r==null?[]:ka(r,Wt(r))}function Ep(r,s,c){var l=r==null?n:Si(r,s);return l===n?c:l}function jj(r,s){return r!=null&&c1(r,s,fK)}function Op(r,s){return r!=null&&c1(r,s,hK)}var Wj=Qw(function(r,s,c){s!=null&&typeof s.toString!="function"&&(s=ya.call(s)),r[s]=c},Ip(qt)),qj=Qw(function(r,s,c){s!=null&&typeof s.toString!="function"&&(s=ya.call(s)),ke.call(r,s)?r[s].push(c):r[s]=[c]},Z),Jj=pe(nc);function gt(r){return jt(r)?yw(r):zd(r)}function Wt(r){return jt(r)?yw(r,!0):wK(r)}function Gj(r,s){var c={};return s=Z(s,3),Qn(r,function(l,h,y){br(c,s(l,h,y),l)}),c}function Hj(r,s){var c={};return s=Z(s,3),Qn(r,function(l,h,y){br(c,h,s(l,h,y))}),c}var Vj=Ps(function(r,s,c){$a(r,s,c)}),j1=Ps(function(r,s,c,l){$a(r,s,c,l)}),zj=Sr(function(r,s){var c={};if(r==null)return c;var l=!1;s=Ue(s,function(y){return y=Kr(y,r),l||(l=y.length>1),y}),er(r,ap(r),c),l&&(c=yn(c,v|O|T,WK));for(var h=s.length;h--;)tp(c,s[h]);return c});function Yj(r,s){return W1(r,Ga(Z(s)))}var Xj=Sr(function(r,s){return r==null?{}:OK(r,s)});function W1(r,s){if(r==null)return{};var c=Ue(ap(r),function(l){return[l]});return s=Z(s),Pw(r,c,function(l,h){return s(l,h[0])})}function Zj(r,s,c){s=Kr(s,r);var l=-1,h=s.length;for(h||(h=1,r=n);++l<h;){var y=r==null?n:r[tr(s[l])];y===n&&(l=h,y=c),r=Er(y)?y.call(r):y}return r}function Qj(r,s,c){return r==null?r:ic(r,s,c)}function e3(r,s,c,l){return l=typeof l=="function"?l:n,r==null?r:ic(r,s,c,l)}var q1=n1(gt),J1=n1(Wt);function t3(r,s,c){var l=oe(r),h=l||jr(r)||Ls(r);if(s=Z(s,4),c==null){var y=r&&r.constructor;h?c=l?new y:[]:qe(r)?c=Er(y)?Cs(va(r)):{}:c={}}return(h?pn:Qn)(r,function(_,S,E){return s(c,_,S,E)}),c}function n3(r,s){return r==null?!0:tp(r,s)}function r3(r,s,c){return r==null?r:Uw(r,s,ip(c))}function i3(r,s,c,l){return l=typeof l=="function"?l:n,r==null?r:Uw(r,s,ip(c),l)}function Ds(r){return r==null?[]:Nd(r,gt(r))}function s3(r){return r==null?[]:Nd(r,Wt(r))}function o3(r,s,c){return c===n&&(c=s,s=n),c!==n&&(c=vn(c),c=c===c?c:0),s!==n&&(s=vn(s),s=s===s?s:0),vi(vn(r),s,c)}function c3(r,s,c){return s=Or(s),c===n?(c=s,s=0):c=Or(c),r=vn(r),dK(r,s,c)}function u3(r,s,c){if(c&&typeof c!="boolean"&&Pt(r,s,c)&&(s=c=n),c===n&&(typeof s=="boolean"?(c=s,s=n):typeof r=="boolean"&&(c=r,r=n)),r===n&&s===n?(r=0,s=1):(r=Or(r),s===n?(s=r,r=0):s=Or(s)),r>s){var l=r;r=s,s=l}if(c||r%1||s%1){var h=gw();return Rt(r+h*(s-r+KD("1e-"+((h+"").length-1))),s)}return Zd(r,s)}var a3=Fs(function(r,s,c){return s=s.toLowerCase(),r+(c?G1(s):s)});function G1(r){return Tp(xe(r).toLowerCase())}function H1(r){return r=xe(r),r&&r.replace(fD,QD).replace(kD,"")}function l3(r,s,c){r=xe(r),s=tn(s);var l=r.length;c=c===n?l:vi(ae(c),0,l);var h=c;return c-=s.length,c>=0&&r.slice(c,h)==s}function f3(r){return r=xe(r),r&&JL.test(r)?r.replace(OS,eU):r}function h3(r){return r=xe(r),r&&XL.test(r)?r.replace(vd,"\\$&"):r}var d3=Fs(function(r,s,c){return r+(c?"-":"")+s.toLowerCase()}),p3=Fs(function(r,s,c){return r+(c?" ":"")+s.toLowerCase()}),g3=Yw("toLowerCase");function m3(r,s,c){r=xe(r),s=ae(s);var l=s?Rs(r):0;if(!s||l>=s)return r;var h=(s-l)/2;return La(Oa(h),c)+r+La(Ea(h),c)}function y3(r,s,c){r=xe(r),s=ae(s);var l=s?Rs(r):0;return s&&l<s?r+La(s-l,c):r}function _3(r,s,c){r=xe(r),s=ae(s);var l=s?Rs(r):0;return s&&l<s?La(s-l,c)+r:r}function b3(r,s,c){return c||s==null?s=0:s&&(s=+s),IU(xe(r).replace(Sd,""),s||0)}function v3(r,s,c){return(c?Pt(r,s,c):s===n)?s=1:s=ae(s),Qd(xe(r),s)}function S3(){var r=arguments,s=xe(r[0]);return r.length<3?s:s.replace(r[1],r[2])}var w3=Fs(function(r,s,c){return r+(c?"_":"")+s.toLowerCase()});function E3(r,s,c){return c&&typeof c!="number"&&Pt(r,s,c)&&(s=c=n),c=c===n?At:c>>>0,c?(r=xe(r),r&&(typeof s=="string"||s!=null&&!wp(s))&&(s=tn(s),!s&&As(r))?Br(Nn(r),0,c):r.split(s,c)):[]}var O3=Fs(function(r,s,c){return r+(c?" ":"")+Tp(s)});function T3(r,s,c){return r=xe(r),c=c==null?0:vi(ae(c),0,r.length),s=tn(s),r.slice(c,c+s.length)==s}function I3(r,s,c){var l=m.templateSettings;c&&Pt(r,s,c)&&(s=n),r=xe(r),s=za({},s,l,r1);var h=za({},s.imports,l.imports,r1),y=gt(h),_=Nd(h,y),S,E,$=0,M=s.interpolate||ua,P="__p += '",j=Dd((s.escape||ua).source+"|"+M.source+"|"+(M===TS?sD:ua).source+"|"+(s.evaluate||ua).source+"|$","g"),V="//# sourceURL="+(ke.call(s,"sourceURL")?(s.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++FD+"]")+`
`;r.replace(j,function(ee,ye,ve,rn,Ft,sn){return ve||(ve=rn),P+=r.slice($,sn).replace(hD,tU),ye&&(S=!0,P+=`' +
__e(`+ye+`) +
'`),Ft&&(E=!0,P+=`';
`+Ft+`;
__p += '`),ve&&(P+=`' +
((__t = (`+ve+`)) == null ? '' : __t) +
'`),$=sn+ee.length,ee}),P+=`';
`;var Q=ke.call(s,"variable")&&s.variable;if(!Q)P=`with (obj) {
`+P+`
}
`;else if(rD.test(Q))throw new ie(f);P=(E?P.replace(BL,""):P).replace(jL,"$1").replace(WL,"$1;"),P="function("+(Q||"obj")+`) {
`+(Q?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(S?", __e = _.escape":"")+(E?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+P+`return __p
}`;var he=z1(function(){return Re(y,V+"return "+P).apply(n,_)});if(he.source=P,Sp(he))throw he;return he}function A3(r){return xe(r).toLowerCase()}function R3(r){return xe(r).toUpperCase()}function x3(r,s,c){if(r=xe(r),r&&(c||s===n))return iw(r);if(!r||!(s=tn(s)))return r;var l=Nn(r),h=Nn(s),y=sw(l,h),_=ow(l,h)+1;return Br(l,y,_).join("")}function k3(r,s,c){if(r=xe(r),r&&(c||s===n))return r.slice(0,uw(r)+1);if(!r||!(s=tn(s)))return r;var l=Nn(r),h=ow(l,Nn(s))+1;return Br(l,0,h).join("")}function $3(r,s,c){if(r=xe(r),r&&(c||s===n))return r.replace(Sd,"");if(!r||!(s=tn(s)))return r;var l=Nn(r),h=sw(l,Nn(s));return Br(l,h).join("")}function M3(r,s){var c=K,l=D;if(qe(s)){var h="separator"in s?s.separator:h;c="length"in s?ae(s.length):c,l="omission"in s?tn(s.omission):l}r=xe(r);var y=r.length;if(As(r)){var _=Nn(r);y=_.length}if(c>=y)return r;var S=c-Rs(l);if(S<1)return l;var E=_?Br(_,0,S).join(""):r.slice(0,S);if(h===n)return E+l;if(_&&(S+=E.length-S),wp(h)){if(r.slice(S).search(h)){var $,M=E;for(h.global||(h=Dd(h.source,xe(IS.exec(h))+"g")),h.lastIndex=0;$=h.exec(M);)var P=$.index;E=E.slice(0,P===n?S:P)}}else if(r.indexOf(tn(h),S)!=S){var j=E.lastIndexOf(h);j>-1&&(E=E.slice(0,j))}return E+l}function C3(r){return r=xe(r),r&&qL.test(r)?r.replace(ES,uU):r}var P3=Fs(function(r,s,c){return r+(c?" ":"")+s.toUpperCase()}),Tp=Yw("toUpperCase");function V1(r,s,c){return r=xe(r),s=c?n:s,s===n?rU(r)?fU(r):VD(r):r.match(s)||[]}var z1=pe(function(r,s){try{return Qt(r,n,s)}catch(c){return Sp(c)?c:new ie(c)}}),F3=Sr(function(r,s){return pn(s,function(c){c=tr(c),br(r,c,bp(r[c],r))}),r});function N3(r){var s=r==null?0:r.length,c=Z();return r=s?Ue(r,function(l){if(typeof l[1]!="function")throw new gn(a);return[c(l[0]),l[1]]}):[],pe(function(l){for(var h=-1;++h<s;){var y=r[h];if(Qt(y[0],this,l))return Qt(y[1],this,l)}})}function L3(r){return uK(yn(r,v))}function Ip(r){return function(){return r}}function D3(r,s){return r==null||r!==r?s:r}var U3=Zw(),K3=Zw(!0);function qt(r){return r}function Ap(r){return Rw(typeof r=="function"?r:yn(r,v))}function B3(r){return kw(yn(r,v))}function j3(r,s){return $w(r,yn(s,v))}var W3=pe(function(r,s){return function(c){return nc(c,r,s)}}),q3=pe(function(r,s){return function(c){return nc(r,c,s)}});function Rp(r,s,c){var l=gt(s),h=ka(s,l);c==null&&!(qe(s)&&(h.length||!l.length))&&(c=s,s=r,r=this,h=ka(s,gt(s)));var y=!(qe(c)&&"chain"in c)||!!c.chain,_=Er(r);return pn(h,function(S){var E=s[S];r[S]=E,_&&(r.prototype[S]=function(){var $=this.__chain__;if(y||$){var M=r(this.__wrapped__),P=M.__actions__=Bt(this.__actions__);return P.push({func:E,args:arguments,thisArg:r}),M.__chain__=$,M}return E.apply(r,Fr([this.value()],arguments))})}),r}function J3(){return vt._===this&&(vt._=yU),this}function xp(){}function G3(r){return r=ae(r),pe(function(s){return Mw(s,r)})}var H3=op(Ue),V3=op(QS),z3=op($d);function Y1(r){return dp(r)?Md(tr(r)):TK(r)}function Y3(r){return function(s){return r==null?n:Si(r,s)}}var X3=e1(),Z3=e1(!0);function kp(){return[]}function $p(){return!1}function Q3(){return{}}function eW(){return""}function tW(){return!0}function nW(r,s){if(r=ae(r),r<1||r>ze)return[];var c=At,l=Rt(r,At);s=Z(s),r-=At;for(var h=Fd(l,s);++c<r;)s(c);return h}function rW(r){return oe(r)?Ue(r,tr):nn(r)?[r]:Bt(m1(xe(r)))}function iW(r){var s=++gU;return xe(r)+s}var sW=Na(function(r,s){return r+s},0),oW=cp("ceil"),cW=Na(function(r,s){return r/s},1),uW=cp("floor");function aW(r){return r&&r.length?xa(r,qt,Gd):n}function lW(r,s){return r&&r.length?xa(r,Z(s,2),Gd):n}function fW(r){return nw(r,qt)}function hW(r,s){return nw(r,Z(s,2))}function dW(r){return r&&r.length?xa(r,qt,Yd):n}function pW(r,s){return r&&r.length?xa(r,Z(s,2),Yd):n}var gW=Na(function(r,s){return r*s},1),mW=cp("round"),yW=Na(function(r,s){return r-s},0);function _W(r){return r&&r.length?Pd(r,qt):0}function bW(r,s){return r&&r.length?Pd(r,Z(s,2)):0}return m.after=B2,m.ary=A1,m.assign=Rj,m.assignIn=B1,m.assignInWith=za,m.assignWith=xj,m.at=kj,m.before=R1,m.bind=bp,m.bindAll=F3,m.bindKey=x1,m.castArray=Q2,m.chain=O1,m.chunk=uB,m.compact=aB,m.concat=lB,m.cond=N3,m.conforms=L3,m.constant=Ip,m.countBy=_2,m.create=$j,m.curry=k1,m.curryRight=$1,m.debounce=M1,m.defaults=Mj,m.defaultsDeep=Cj,m.defer=j2,m.delay=W2,m.difference=fB,m.differenceBy=hB,m.differenceWith=dB,m.drop=pB,m.dropRight=gB,m.dropRightWhile=mB,m.dropWhile=yB,m.fill=_B,m.filter=v2,m.flatMap=E2,m.flatMapDeep=O2,m.flatMapDepth=T2,m.flatten=v1,m.flattenDeep=bB,m.flattenDepth=vB,m.flip=q2,m.flow=U3,m.flowRight=K3,m.fromPairs=SB,m.functions=Kj,m.functionsIn=Bj,m.groupBy=I2,m.initial=EB,m.intersection=OB,m.intersectionBy=TB,m.intersectionWith=IB,m.invert=Wj,m.invertBy=qj,m.invokeMap=R2,m.iteratee=Ap,m.keyBy=x2,m.keys=gt,m.keysIn=Wt,m.map=Wa,m.mapKeys=Gj,m.mapValues=Hj,m.matches=B3,m.matchesProperty=j3,m.memoize=Ja,m.merge=Vj,m.mergeWith=j1,m.method=W3,m.methodOf=q3,m.mixin=Rp,m.negate=Ga,m.nthArg=G3,m.omit=zj,m.omitBy=Yj,m.once=J2,m.orderBy=k2,m.over=H3,m.overArgs=G2,m.overEvery=V3,m.overSome=z3,m.partial=vp,m.partialRight=C1,m.partition=$2,m.pick=Xj,m.pickBy=W1,m.property=Y1,m.propertyOf=Y3,m.pull=kB,m.pullAll=w1,m.pullAllBy=$B,m.pullAllWith=MB,m.pullAt=CB,m.range=X3,m.rangeRight=Z3,m.rearg=H2,m.reject=P2,m.remove=PB,m.rest=V2,m.reverse=yp,m.sampleSize=N2,m.set=Qj,m.setWith=e3,m.shuffle=L2,m.slice=FB,m.sortBy=K2,m.sortedUniq=jB,m.sortedUniqBy=WB,m.split=E3,m.spread=z2,m.tail=qB,m.take=JB,m.takeRight=GB,m.takeRightWhile=HB,m.takeWhile=VB,m.tap=a2,m.throttle=Y2,m.thru=ja,m.toArray=D1,m.toPairs=q1,m.toPairsIn=J1,m.toPath=rW,m.toPlainObject=K1,m.transform=t3,m.unary=X2,m.union=zB,m.unionBy=YB,m.unionWith=XB,m.uniq=ZB,m.uniqBy=QB,m.uniqWith=e2,m.unset=n3,m.unzip=_p,m.unzipWith=E1,m.update=r3,m.updateWith=i3,m.values=Ds,m.valuesIn=s3,m.without=t2,m.words=V1,m.wrap=Z2,m.xor=n2,m.xorBy=r2,m.xorWith=i2,m.zip=s2,m.zipObject=o2,m.zipObjectDeep=c2,m.zipWith=u2,m.entries=q1,m.entriesIn=J1,m.extend=B1,m.extendWith=za,Rp(m,m),m.add=sW,m.attempt=z1,m.camelCase=a3,m.capitalize=G1,m.ceil=oW,m.clamp=o3,m.clone=ej,m.cloneDeep=nj,m.cloneDeepWith=rj,m.cloneWith=tj,m.conformsTo=ij,m.deburr=H1,m.defaultTo=D3,m.divide=cW,m.endsWith=l3,m.eq=Dn,m.escape=f3,m.escapeRegExp=h3,m.every=b2,m.find=S2,m.findIndex=_1,m.findKey=Pj,m.findLast=w2,m.findLastIndex=b1,m.findLastKey=Fj,m.floor=uW,m.forEach=T1,m.forEachRight=I1,m.forIn=Nj,m.forInRight=Lj,m.forOwn=Dj,m.forOwnRight=Uj,m.get=Ep,m.gt=sj,m.gte=oj,m.has=jj,m.hasIn=Op,m.head=S1,m.identity=qt,m.includes=A2,m.indexOf=wB,m.inRange=c3,m.invoke=Jj,m.isArguments=Oi,m.isArray=oe,m.isArrayBuffer=cj,m.isArrayLike=jt,m.isArrayLikeObject=Ye,m.isBoolean=uj,m.isBuffer=jr,m.isDate=aj,m.isElement=lj,m.isEmpty=fj,m.isEqual=hj,m.isEqualWith=dj,m.isError=Sp,m.isFinite=pj,m.isFunction=Er,m.isInteger=P1,m.isLength=Ha,m.isMap=F1,m.isMatch=gj,m.isMatchWith=mj,m.isNaN=yj,m.isNative=_j,m.isNil=vj,m.isNull=bj,m.isNumber=N1,m.isObject=qe,m.isObjectLike=He,m.isPlainObject=uc,m.isRegExp=wp,m.isSafeInteger=Sj,m.isSet=L1,m.isString=Va,m.isSymbol=nn,m.isTypedArray=Ls,m.isUndefined=wj,m.isWeakMap=Ej,m.isWeakSet=Oj,m.join=AB,m.kebabCase=d3,m.last=bn,m.lastIndexOf=RB,m.lowerCase=p3,m.lowerFirst=g3,m.lt=Tj,m.lte=Ij,m.max=aW,m.maxBy=lW,m.mean=fW,m.meanBy=hW,m.min=dW,m.minBy=pW,m.stubArray=kp,m.stubFalse=$p,m.stubObject=Q3,m.stubString=eW,m.stubTrue=tW,m.multiply=gW,m.nth=xB,m.noConflict=J3,m.noop=xp,m.now=qa,m.pad=m3,m.padEnd=y3,m.padStart=_3,m.parseInt=b3,m.random=u3,m.reduce=M2,m.reduceRight=C2,m.repeat=v3,m.replace=S3,m.result=Zj,m.round=mW,m.runInContext=w,m.sample=F2,m.size=D2,m.snakeCase=w3,m.some=U2,m.sortedIndex=NB,m.sortedIndexBy=LB,m.sortedIndexOf=DB,m.sortedLastIndex=UB,m.sortedLastIndexBy=KB,m.sortedLastIndexOf=BB,m.startCase=O3,m.startsWith=T3,m.subtract=yW,m.sum=_W,m.sumBy=bW,m.template=I3,m.times=nW,m.toFinite=Or,m.toInteger=ae,m.toLength=U1,m.toLower=A3,m.toNumber=vn,m.toSafeInteger=Aj,m.toString=xe,m.toUpper=R3,m.trim=x3,m.trimEnd=k3,m.trimStart=$3,m.truncate=M3,m.unescape=C3,m.uniqueId=iW,m.upperCase=P3,m.upperFirst=Tp,m.each=T1,m.eachRight=I1,m.first=S1,Rp(m,function(){var r={};return Qn(m,function(s,c){ke.call(m.prototype,c)||(r[c]=s)}),r}(),{chain:!1}),m.VERSION=i,pn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(r){m[r].placeholder=m}),pn(["drop","take"],function(r,s){_e.prototype[r]=function(c){c=c===n?1:lt(ae(c),0);var l=this.__filtered__&&!s?new _e(this):this.clone();return l.__filtered__?l.__takeCount__=Rt(c,l.__takeCount__):l.__views__.push({size:Rt(c,At),type:r+(l.__dir__<0?"Right":"")}),l},_e.prototype[r+"Right"]=function(c){return this.reverse()[r](c).reverse()}}),pn(["filter","map","takeWhile"],function(r,s){var c=s+1,l=c==Ie||c==We;_e.prototype[r]=function(h){var y=this.clone();return y.__iteratees__.push({iteratee:Z(h,3),type:c}),y.__filtered__=y.__filtered__||l,y}}),pn(["head","last"],function(r,s){var c="take"+(s?"Right":"");_e.prototype[r]=function(){return this[c](1).value()[0]}}),pn(["initial","tail"],function(r,s){var c="drop"+(s?"":"Right");_e.prototype[r]=function(){return this.__filtered__?new _e(this):this[c](1)}}),_e.prototype.compact=function(){return this.filter(qt)},_e.prototype.find=function(r){return this.filter(r).head()},_e.prototype.findLast=function(r){return this.reverse().find(r)},_e.prototype.invokeMap=pe(function(r,s){return typeof r=="function"?new _e(this):this.map(function(c){return nc(c,r,s)})}),_e.prototype.reject=function(r){return this.filter(Ga(Z(r)))},_e.prototype.slice=function(r,s){r=ae(r);var c=this;return c.__filtered__&&(r>0||s<0)?new _e(c):(r<0?c=c.takeRight(-r):r&&(c=c.drop(r)),s!==n&&(s=ae(s),c=s<0?c.dropRight(-s):c.take(s-r)),c)},_e.prototype.takeRightWhile=function(r){return this.reverse().takeWhile(r).reverse()},_e.prototype.toArray=function(){return this.take(At)},Qn(_e.prototype,function(r,s){var c=/^(?:filter|find|map|reject)|While$/.test(s),l=/^(?:head|last)$/.test(s),h=m[l?"take"+(s=="last"?"Right":""):s],y=l||/^find/.test(s);h&&(m.prototype[s]=function(){var _=this.__wrapped__,S=l?[1]:arguments,E=_ instanceof _e,$=S[0],M=E||oe(_),P=function(ye){var ve=h.apply(m,Fr([ye],S));return l&&j?ve[0]:ve};M&&c&&typeof $=="function"&&$.length!=1&&(E=M=!1);var j=this.__chain__,V=!!this.__actions__.length,Q=y&&!j,he=E&&!V;if(!y&&M){_=he?_:new _e(this);var ee=r.apply(_,S);return ee.__actions__.push({func:ja,args:[P],thisArg:n}),new mn(ee,j)}return Q&&he?r.apply(this,S):(ee=this.thru(P),Q?l?ee.value()[0]:ee.value():ee)})}),pn(["pop","push","shift","sort","splice","unshift"],function(r){var s=pa[r],c=/^(?:push|sort|unshift)$/.test(r)?"tap":"thru",l=/^(?:pop|shift)$/.test(r);m.prototype[r]=function(){var h=arguments;if(l&&!this.__chain__){var y=this.value();return s.apply(oe(y)?y:[],h)}return this[c](function(_){return s.apply(oe(_)?_:[],h)})}}),Qn(_e.prototype,function(r,s){var c=m[s];if(c){var l=c.name+"";ke.call(Ms,l)||(Ms[l]=[]),Ms[l].push({name:s,func:c})}}),Ms[Fa(n,L).name]=[{name:"wrapper",func:n}],_e.prototype.clone=CU,_e.prototype.reverse=PU,_e.prototype.value=FU,m.prototype.at=l2,m.prototype.chain=f2,m.prototype.commit=h2,m.prototype.next=d2,m.prototype.plant=g2,m.prototype.reverse=m2,m.prototype.toJSON=m.prototype.valueOf=m.prototype.value=y2,m.prototype.first=m.prototype.head,zo&&(m.prototype[zo]=p2),m},xs=hU();mi?((mi.exports=xs)._=xs,Ad._=xs):vt._=xs}).call(Ce)}(fc,fc.exports);var hE=fc.exports,we=Ke(hE);const dE=1,Ya=2,pE={INIT_ACK:{statusByte:2,parse:e=>({type:"init-ack",projectName:e[0]})},INIT:{statusByte:3,parse:e=>({type:"init-project",tracksCount:e[0]})},DONE:{statusByte:4,parse:e=>({type:"init-done"})},TRACK:{statusByte:5,parse:e=>({type:"init-track",name:e[0],trackIndex:we.toNumber(e[1]),color:we.toNumber(e[2])})},CLIP:{statusByte:6,parse:e=>({type:"init-clip",name:e[0],trackIndex:we.toNumber(e[1]),clipIndex:we.toNumber(e[2]),color:we.toNumber(e[3]),startTime:we.toNumber(e[4]),endTime:we.toNumber(e[5])})},BEAT:{statusByte:7,parse:e=>({type:"beat",value:we.toNumber(e[0])})},BAR_BEAT:{statusByte:8,parse:e=>({type:"bar-beat",value:we.toNumber(e[0])})},SIG:{statusByte:9,parse:e=>({type:"sig",numer:we.toNumber(e[0]),denom:we.toNumber(e[1])})},TEMPO:{statusByte:10,parse:e=>({type:"tempo",value:we.toNumber(e[0])})},IS_PLAYING:{statusByte:11,parse:e=>({type:"is-playing",value:we.toNumber(e[0])===1})},CUE:{statusByte:12,parse:e=>({type:"init-cue",id:we.toNumber(e[0]),name:e[1],time:we.toNumber(e[2]),index:we.toNumber(e[3])})},METRONOME_STATE:{statusByte:13,parse:e=>({type:"metronome-state",value:we.toNumber(e[0])===1})},LOOP_STATE:{statusByte:14,parse:e=>({type:"loop-state",value:we.toNumber(e[0])===1})},HALF_BEAT:{statusByte:15,parse:e=>({type:"half-beat",isHalf:we.toNumber(e[0])===1})}},gE=we.fromPairs(we.map(pE,e=>[e.statusByte,e])),mE=e=>{const t=we.join(we.map(e,i=>String.fromCharCode(i)),""),n=we.split(t,String.fromCharCode(dE));return[we.toNumber(n[0]),n.splice(1)]},yE=e=>{try{if(e.manufacturer===Ya){const[t,n]=mE(e.body),i=gE[t];if(i!==void 0)return i.parse(n);console.warn("Did not find parser for message",e)}}catch(t){console.error("Got error parsing message",t)}},Wp=e=>{const t=[];return we.forEach(e,(n,i)=>{t.push(e.charCodeAt(i))}),t},Sn={base:(e,t)=>({type:"sysex",manufacturer:Ya,body:[e,...Wp(t.toString())]}),baseJSON:(e,t)=>({type:"sysex",manufacturer:Ya,body:[e,...Wp(JSON.stringify(t))]}),init:()=>Sn.base(64,1),initReady:e=>Sn.baseJSON(65,{tracks:e}),play:()=>Sn.base(80,1),stop:()=>Sn.base(81,1),jumpToCue:e=>Sn.base(82,e),jumpBy:e=>Sn.base(84,e),record:()=>Sn.base(85,1),metronome:e=>Sn.base(86,e?1:0),loop:e=>Sn.base(87,e?1:0)};function wn(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map(function(o){return"'"+o+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function Ti(e){return!!e&&!!e[Jt]}function Wr(e){var t;return!!e&&(function(n){if(!n||typeof n!="object")return!1;var i=Object.getPrototypeOf(n);if(i===null)return!0;var o=Object.hasOwnProperty.call(i,"constructor")&&i.constructor;return o===Object||typeof o=="function"&&Function.toString.call(o)===TE}(e)||Array.isArray(e)||!!e[Qp]||!!(!((t=e.constructor)===null||t===void 0)&&t[Qp])||Za(e)||Qa(e))}function Us(e,t,n){n===void 0&&(n=!1),Ii(e)===0?(n?Object.keys:fl)(e).forEach(function(i){n&&typeof i=="symbol"||t(i,e[i],e)}):e.forEach(function(i,o){return t(o,i,e)})}function Ii(e){var t=e[Jt];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:Za(e)?2:Qa(e)?3:0}function Xa(e,t){return Ii(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function _E(e,t){return Ii(e)===2?e.get(t):e[t]}function qp(e,t,n){var i=Ii(e);i===2?e.set(t,n):i===3?e.add(n):e[t]=n}function bE(e,t){return e===t?e!==0||1/e==1/t:e!=e&&t!=t}function Za(e){return EE&&e instanceof Map}function Qa(e){return OE&&e instanceof Set}function qr(e){return e.o||e.t}function el(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=IE(e);delete t[Jt];for(var n=fl(t),i=0;i<n.length;i++){var o=n[i],u=t[o];u.writable===!1&&(u.writable=!0,u.configurable=!0),(u.get||u.set)&&(t[o]={configurable:!0,writable:!0,enumerable:u.enumerable,value:e[o]})}return Object.create(Object.getPrototypeOf(e),t)}function tl(e,t){return t===void 0&&(t=!1),nl(e)||Ti(e)||!Wr(e)||(Ii(e)>1&&(e.set=e.add=e.clear=e.delete=vE),Object.freeze(e),t&&Us(e,function(n,i){return tl(i,!0)},!0)),e}function vE(){wn(2)}function nl(e){return e==null||typeof e!="object"||Object.isFrozen(e)}function Kn(e){var t=AE[e];return t||wn(18,e),t}function Jp(){return Ks}function rl(e,t){t&&(Kn("Patches"),e.u=[],e.s=[],e.v=t)}function hc(e){il(e),e.p.forEach(SE),e.p=null}function il(e){e===Ks&&(Ks=e.l)}function Gp(e){return Ks={p:[],l:Ks,h:e,m:!0,_:0}}function SE(e){var t=e[Jt];t.i===0||t.i===1?t.j():t.g=!0}function sl(e,t){t._=t.p.length;var n=t.p[0],i=e!==void 0&&e!==n;return t.h.O||Kn("ES5").S(t,e,i),i?(n[Jt].P&&(hc(t),wn(4)),Wr(e)&&(e=dc(t,e),t.l||pc(t,e)),t.u&&Kn("Patches").M(n[Jt].t,e,t.u,t.s)):e=dc(t,n,[]),hc(t),t.u&&t.v(t.u,t.s),e!==Zp?e:void 0}function dc(e,t,n){if(nl(t))return t;var i=t[Jt];if(!i)return Us(t,function(f,d){return Hp(e,i,t,f,d,n)},!0),t;if(i.A!==e)return t;if(!i.P)return pc(e,i.t,!0),i.t;if(!i.I){i.I=!0,i.A._--;var o=i.i===4||i.i===5?i.o=el(i.k):i.o,u=o,a=!1;i.i===3&&(u=new Set(o),o.clear(),a=!0),Us(u,function(f,d){return Hp(e,i,o,f,d,n,a)}),pc(e,o,!1),n&&e.u&&Kn("Patches").N(i,n,e.u,e.s)}return i.o}function Hp(e,t,n,i,o,u,a){if(Ti(o)){var f=dc(e,o,u&&t&&t.i!==3&&!Xa(t.R,i)?u.concat(i):void 0);if(qp(n,i,f),!Ti(f))return;e.m=!1}else a&&n.add(o);if(Wr(o)&&!nl(o)){if(!e.h.D&&e._<1)return;dc(e,o),t&&t.A.l||pc(e,o)}}function pc(e,t,n){n===void 0&&(n=!1),!e.l&&e.h.D&&e.m&&tl(t,n)}function ol(e,t){var n=e[Jt];return(n?qr(n):e)[t]}function Vp(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var i=Object.getOwnPropertyDescriptor(n,t);if(i)return i;n=Object.getPrototypeOf(n)}}function cl(e){e.P||(e.P=!0,e.l&&cl(e.l))}function ul(e){e.o||(e.o=el(e.t))}function al(e,t,n){var i=Za(t)?Kn("MapSet").F(t,n):Qa(t)?Kn("MapSet").T(t,n):e.O?function(o,u){var a=Array.isArray(o),f={i:a?1:0,A:u?u.A:Jp(),P:!1,I:!1,R:{},l:u,t:o,k:null,o:null,j:null,C:!1},d=f,g=hl;a&&(d=[f],g=Bs);var b=Proxy.revocable(d,g),v=b.revoke,O=b.proxy;return f.k=O,f.j=v,O}(t,n):Kn("ES5").J(t,n);return(n?n.A:Jp()).p.push(i),i}function wE(e){return Ti(e)||wn(22,e),function t(n){if(!Wr(n))return n;var i,o=n[Jt],u=Ii(n);if(o){if(!o.P&&(o.i<4||!Kn("ES5").K(o)))return o.t;o.I=!0,i=zp(n,u),o.I=!1}else i=zp(n,u);return Us(i,function(a,f){o&&_E(o.t,a)===f||qp(i,a,t(f))}),u===3?new Set(i):i}(e)}function zp(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return el(e)}var Yp,Ks,ll=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",EE=typeof Map<"u",OE=typeof Set<"u",Xp=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",Zp=ll?Symbol.for("immer-nothing"):((Yp={})["immer-nothing"]=!0,Yp),Qp=ll?Symbol.for("immer-draftable"):"__$immer_draftable",Jt=ll?Symbol.for("immer-state"):"__$immer_state",TE=""+Object.prototype.constructor,fl=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,IE=Object.getOwnPropertyDescriptors||function(e){var t={};return fl(e).forEach(function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)}),t},AE={},hl={get:function(e,t){if(t===Jt)return e;var n=qr(e);if(!Xa(n,t))return function(o,u,a){var f,d=Vp(u,a);return d?"value"in d?d.value:(f=d.get)===null||f===void 0?void 0:f.call(o.k):void 0}(e,n,t);var i=n[t];return e.I||!Wr(i)?i:i===ol(e.t,t)?(ul(e),e.o[t]=al(e.A.h,i,e)):i},has:function(e,t){return t in qr(e)},ownKeys:function(e){return Reflect.ownKeys(qr(e))},set:function(e,t,n){var i=Vp(qr(e),t);if(i!=null&&i.set)return i.set.call(e.k,n),!0;if(!e.P){var o=ol(qr(e),t),u=o==null?void 0:o[Jt];if(u&&u.t===n)return e.o[t]=n,e.R[t]=!1,!0;if(bE(n,o)&&(n!==void 0||Xa(e.t,t)))return!0;ul(e),cl(e)}return e.o[t]===n&&(n!==void 0||t in e.o)||Number.isNaN(n)&&Number.isNaN(e.o[t])||(e.o[t]=n,e.R[t]=!0),!0},deleteProperty:function(e,t){return ol(e.t,t)!==void 0||t in e.t?(e.R[t]=!1,ul(e),cl(e)):delete e.R[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=qr(e),i=Reflect.getOwnPropertyDescriptor(n,t);return i&&{writable:!0,configurable:e.i!==1||t!=="length",enumerable:i.enumerable,value:n[t]}},defineProperty:function(){wn(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){wn(12)}},Bs={};Us(hl,function(e,t){Bs[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),Bs.deleteProperty=function(e,t){return Bs.set.call(this,e,t,void 0)},Bs.set=function(e,t,n){return hl.set.call(this,e[0],t,n,e[0])};var RE=function(){function e(n){var i=this;this.O=Xp,this.D=!0,this.produce=function(o,u,a){if(typeof o=="function"&&typeof u!="function"){var f=u;u=o;var d=i;return function(W){var F=this;W===void 0&&(W=f);for(var L=arguments.length,z=Array(L>1?L-1:0),B=1;B<L;B++)z[B-1]=arguments[B];return d.produce(W,function(H){var Y;return(Y=u).call.apply(Y,[F,H].concat(z))})}}var g;if(typeof u!="function"&&wn(6),a!==void 0&&typeof a!="function"&&wn(7),Wr(o)){var b=Gp(i),v=al(i,o,void 0),O=!0;try{g=u(v),O=!1}finally{O?hc(b):il(b)}return typeof Promise<"u"&&g instanceof Promise?g.then(function(W){return rl(b,a),sl(W,b)},function(W){throw hc(b),W}):(rl(b,a),sl(g,b))}if(!o||typeof o!="object"){if((g=u(o))===void 0&&(g=o),g===Zp&&(g=void 0),i.D&&tl(g,!0),a){var T=[],R=[];Kn("Patches").M(o,g,T,R),a(T,R)}return g}wn(21,o)},this.produceWithPatches=function(o,u){if(typeof o=="function")return function(g){for(var b=arguments.length,v=Array(b>1?b-1:0),O=1;O<b;O++)v[O-1]=arguments[O];return i.produceWithPatches(g,function(T){return o.apply(void 0,[T].concat(v))})};var a,f,d=i.produce(o,u,function(g,b){a=g,f=b});return typeof Promise<"u"&&d instanceof Promise?d.then(function(g){return[g,a,f]}):[d,a,f]},typeof(n==null?void 0:n.useProxies)=="boolean"&&this.setUseProxies(n.useProxies),typeof(n==null?void 0:n.autoFreeze)=="boolean"&&this.setAutoFreeze(n.autoFreeze)}var t=e.prototype;return t.createDraft=function(n){Wr(n)||wn(8),Ti(n)&&(n=wE(n));var i=Gp(this),o=al(this,n,void 0);return o[Jt].C=!0,il(i),o},t.finishDraft=function(n,i){var o=n&&n[Jt],u=o.A;return rl(u,i),sl(void 0,u)},t.setAutoFreeze=function(n){this.D=n},t.setUseProxies=function(n){n&&!Xp&&wn(20),this.O=n},t.applyPatches=function(n,i){var o;for(o=i.length-1;o>=0;o--){var u=i[o];if(u.path.length===0&&u.op==="replace"){n=u.value;break}}o>-1&&(i=i.slice(o+1));var a=Kn("Patches").$;return Ti(n)?a(n,i):this.produce(n,function(f){return a(f,i)})},e}(),Gt=new RE,dl=Gt.produce;Gt.produceWithPatches.bind(Gt),Gt.setAutoFreeze.bind(Gt),Gt.setUseProxies.bind(Gt),Gt.applyPatches.bind(Gt),Gt.createDraft.bind(Gt),Gt.finishDraft.bind(Gt);const xE=e=>typeof e=="function",I=function(e,t){if(typeof e=="function")return function(){return e(arguments)?t.apply(this,arguments):n=>t(n,...arguments)};switch(e){case 0:case 1:throw new RangeError(`Invalid arity ${e}`);case 2:return function(n,i){return arguments.length>=2?t(n,i):function(o){return t(o,n)}};case 3:return function(n,i,o){return arguments.length>=3?t(n,i,o):function(u){return t(u,n,i)}};case 4:return function(n,i,o,u){return arguments.length>=4?t(n,i,o,u):function(a){return t(a,n,i,o)}};case 5:return function(n,i,o,u,a){return arguments.length>=5?t(n,i,o,u,a):function(f){return t(f,n,i,o,u)}};default:return function(){if(arguments.length>=e)return t.apply(this,arguments);const n=arguments;return function(i){return t(i,...n)}}}},Ze=e=>e,gc=e=>()=>e,eg=gc(!0),pl=gc(!1),tg=gc(void 0),kE=tg;function C(e,t,n,i,o,u,a,f,d){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return n(t(e));case 4:return i(n(t(e)));case 5:return o(i(n(t(e))));case 6:return u(o(i(n(t(e)))));case 7:return a(u(o(i(n(t(e))))));case 8:return f(a(u(o(i(n(t(e)))))));case 9:return d(f(a(u(o(i(n(t(e))))))));default:{let g=arguments[0];for(let b=1;b<arguments.length;b++)g=arguments[b](g);return g}}}const gl=e=>(t,n)=>t===n||e(t,n),$E=I(2,(e,t)=>gl((n,i)=>e(t(n),t(i)))),ME=e=>gl((t,n)=>{if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(!e(t[i],n[i]))return!1;return!0});let CE="3.13.12";const mc=()=>CE,yc=`effect/GlobalValue/globalStoreId/${mc()}`;let js;const Ee=(e,t)=>(js||(globalThis[yc]??(globalThis[yc]=new Map),js=globalThis[yc]),js.has(e)||js.set(e,t()),js.get(e)),Bn=e=>typeof e=="string",Jr=e=>typeof e=="number",ml=e=>typeof e=="boolean",_c=e=>typeof e=="bigint",yl=e=>typeof e=="symbol",Ws=xE,PE=e=>e===void 0,FE=e=>!1,_l=e=>typeof e=="object"&&e!==null,Ir=e=>_l(e)||Ws(e),ue=I(2,(e,t)=>Ir(e)&&t in e),ng=I(2,(e,t)=>ue(e,"_tag")&&e._tag===t),Ai=e=>e==null,NE=e=>e!=null,LE=e=>e instanceof Date,rg=e=>ue(e,Symbol.iterator),DE=e=>_l(e)&&!Array.isArray(e),UE=e=>ue(e,"then")&&Ws(e.then),bc=e=>`BUG: ${e} - please report an issue at https://github.com/Effect-TS/effect/issues`;let ig=class rE{constructor(t){p(this,"self");p(this,"called",!1);this.self=t}next(t){return this.called?{value:t,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(t){return{value:t,done:!0}}throw(t){throw t}[Symbol.iterator](){return new rE(this.self)}};const KE=335903614,BE=4150755663,jE=1481765933,WE=1284865837,qE=9007199254740992,JE=134217728;class GE{constructor(t,n,i,o){p(this,"_state");return Ai(n)&&Ai(t)?(n=Math.random()*4294967295>>>0,t=0):Ai(n)&&(n=t,t=0),Ai(o)&&Ai(i)?(o=this._state?this._state[3]:BE,i=this._state?this._state[2]:KE):Ai(o)&&(o=i,i=0),this._state=new Int32Array([0,0,i>>>0,((o||0)|1)>>>0]),this._next(),sg(this._state,this._state[0],this._state[1],t>>>0,n>>>0),this._next(),this}getState(){return[this._state[0],this._state[1],this._state[2],this._state[3]]}setState(t){this._state[0]=t[0],this._state[1]=t[1],this._state[2]=t[2],this._state[3]=t[3]|1}integer(t){return Math.round(this.number()*Number.MAX_SAFE_INTEGER)%t}number(){const t=(this._next()&67108863)*1,n=(this._next()&134217727)*1;return(t*JE+n)/qE}_next(){const t=this._state[0]>>>0,n=this._state[1]>>>0;HE(this._state,t,n,jE,WE),sg(this._state,this._state[0],this._state[1],this._state[2],this._state[3]);let i=t>>>18,o=(n>>>18|t<<14)>>>0;i=(i^t)>>>0,o=(o^n)>>>0;const u=(o>>>27|i<<5)>>>0,a=t>>>27,f=(-a>>>0&31)>>>0;return(u>>>a|u<<f)>>>0}}function HE(e,t,n,i,o){let u=(n>>>16)*(o&65535)>>>0,a=(n&65535)*(o>>>16)>>>0,f=(n&65535)*(o&65535)>>>0,d=(n>>>16)*(o>>>16)+((a>>>16)+(u>>>16))>>>0;a=a<<16>>>0,f=f+a>>>0,f>>>0<a>>>0&&(d=d+1>>>0),u=u<<16>>>0,f=f+u>>>0,f>>>0<u>>>0&&(d=d+1>>>0),d=d+Math.imul(n,i)>>>0,d=d+Math.imul(t,o)>>>0,e[0]=d,e[1]=f}function sg(e,t,n,i,o){let u=t+i>>>0;const a=n+o>>>0;a>>>0<n>>>0&&(u=u+1|0),e[0]=u,e[1]=a}const bl=Symbol.for("effect/Utils/YieldWrap");class qs{constructor(t){tE(this,Ko);nE(this,Ko,t)}[bl](){return eE(this,Ko)}}Ko=new WeakMap;function VE(e){if(typeof e=="object"&&e!==null&&bl in e)return e[bl]();throw new Error(bc("yieldWrapGet"))}const on=Ee("effect/Utils/isStructuralRegion",()=>({enabled:!1,tester:void 0})),kt=(e=>{const t={[e](n){return n()}};return function(n){return t[e](n)}})("effect_internal_function"),vl=Ee(Symbol.for("effect/Hash/randomHashCache"),()=>new WeakMap),de=Symbol.for("effect/Hash"),X=e=>{if(on.enabled===!0)return 0;switch(typeof e){case"number":return wl(e);case"bigint":return Qe(e.toString(10));case"boolean":return Qe(String(e));case"symbol":return Qe(String(e));case"string":return Qe(e);case"undefined":return Qe("undefined");case"function":case"object":return e===null?Qe("null"):e instanceof Date?X(e.toISOString()):zE(e)?e[de]():Sl(e);default:throw new Error(`BUG: unhandled typeof ${typeof e} - please report an issue at https://github.com/Effect-TS/effect/issues`)}},Sl=e=>(vl.has(e)||vl.set(e,wl(Math.floor(Math.random()*Number.MAX_SAFE_INTEGER))),vl.get(e)),Se=e=>t=>t*53^e,vc=e=>e&3221225471|e>>>1&1073741824,zE=e=>ue(e,de),wl=e=>{if(e!==e||e===1/0)return 0;let t=e|0;for(t!==e&&(t^=e*4294967295);e>4294967295;)t^=e/=4294967295;return vc(t)},Qe=e=>{let t=5381,n=e.length;for(;n;)t=t*33^e.charCodeAt(--n);return vc(t)},YE=(e,t)=>{let n=12289;for(let i=0;i<t.length;i++)n^=C(Qe(t[i]),Se(X(e[t[i]])));return vc(n)},og=e=>YE(e,Object.keys(e)),Js=e=>{let t=6151;for(let n=0;n<e.length;n++)t=C(t,Se(X(e[n])));return vc(t)},Je=function(){if(arguments.length===1){const n=arguments[0];return function(i){return Object.defineProperty(n,de,{value(){return i},enumerable:!1}),i}}const e=arguments[0],t=arguments[1];return Object.defineProperty(e,de,{value(){return t},enumerable:!1}),t},le=Symbol.for("effect/Equal");function fe(){return arguments.length===1?e=>Sc(e,arguments[0]):Sc(arguments[0],arguments[1])}function Sc(e,t){if(e===t)return!0;const n=typeof e;if(n!==typeof t)return!1;if(n==="object"||n==="function"){if(e!==null&&t!==null){if(wc(e)&&wc(t))return X(e)===X(t)&&e[le](t)?!0:on.enabled&&on.tester?on.tester(e,t):!1;if(e instanceof Date&&t instanceof Date)return e.toISOString()===t.toISOString()}if(on.enabled){if(Array.isArray(e)&&Array.isArray(t))return e.length===t.length&&e.every((i,o)=>Sc(i,t[o]));if(Object.getPrototypeOf(e)===Object.prototype&&Object.getPrototypeOf(e)===Object.prototype){const i=Object.keys(e),o=Object.keys(t);if(i.length===o.length){for(const u of i)if(!(u in t&&Sc(e[u],t[u])))return on.tester?on.tester(e,t):!1;return!0}}return on.tester?on.tester(e,t):!1}}return on.enabled&&on.tester?on.tester(e,t):!1}const wc=e=>ue(e,le),El=()=>fe,Be=Symbol.for("nodejs.util.inspect.custom"),it=e=>{try{if(ue(e,"toJSON")&&Ws(e.toJSON)&&e.toJSON.length===0)return e.toJSON();if(Array.isArray(e))return e.map(it)}catch{return{}}return ZE(e)},ft=e=>JSON.stringify(e,null,2),Ri=(e,t=2)=>{if(typeof e=="string")return e;try{return typeof e=="object"?cg(e,t):String(e)}catch{return String(e)}},cg=(e,t)=>{let n=[];const i=JSON.stringify(e,(o,u)=>typeof u=="object"&&u!==null?n.includes(u)?void 0:n.push(u)&&(Gr.fiberRefs!==void 0&&ug(u)?u[Ol](Gr.fiberRefs):u):u,t);return n=void 0,i},Ol=Symbol.for("effect/Inspectable/Redactable"),ug=e=>typeof e=="object"&&e!==null&&Ol in e,Gr=Ee("effect/Inspectable/redactableState",()=>({fiberRefs:void 0})),XE=(e,t)=>{const n=Gr.fiberRefs;Gr.fiberRefs=e;try{return t()}finally{Gr.fiberRefs=n}},ZE=e=>ug(e)&&Gr.fiberRefs!==void 0?e[Ol](Gr.fiberRefs):e,re=(e,t)=>{switch(t.length){case 0:return e;case 1:return t[0](e);case 2:return t[1](t[0](e));case 3:return t[2](t[1](t[0](e)));case 4:return t[3](t[2](t[1](t[0](e))));case 5:return t[4](t[3](t[2](t[1](t[0](e)))));case 6:return t[5](t[4](t[3](t[2](t[1](t[0](e))))));case 7:return t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))));case 8:return t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e))))))));case 9:return t[8](t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))))));default:{let n=e;for(let i=0,o=t.length;i<o;i++)n=t[i](n);return n}}},Gs="Async",Ec="Commit",En="Failure",Tl="OnFailure",Oc="OnSuccess",Tc="OnSuccessAndFailure",On="Success",ag="Sync",QE="Tag",Hs="UpdateRuntimeFlags",Ic="While",Ac="Iterator",lg="WithRuntime",Rc="Yield",Il="RevertFlags",eO=Symbol.for("effect/Effect"),tO=Symbol.for("effect/Stream"),nO=Symbol.for("effect/Sink"),rO=Symbol.for("effect/Channel"),xi={_R:e=>e,_E:e=>e,_A:e=>e,_V:mc()},iO={_A:e=>e,_In:e=>e,_L:e=>e,_E:e=>e,_R:e=>e},sO={_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutElem:e=>e,_OutDone:e=>e},Vs={[eO]:xi,[tO]:xi,[nO]:iO,[rO]:sO,[le](e){return this===e},[de](){return Je(this,Sl(this))},[Symbol.iterator](){return new ig(new qs(this))},pipe(){return re(this,arguments)}},Al={[de](){return Je(this,og(this))},[le](e){const t=Object.keys(this),n=Object.keys(e);if(t.length!==n.length)return!1;for(const i of t)if(!(i in e&&fe(this[i],e[i])))return!1;return!0}},zs={...Vs,_op:Ec},oO={...zs,...Al},cO=function(){function e(){}return e.prototype=zs,e}(),fg=Symbol.for("effect/Option"),hg={...Vs,[fg]:{_A:e=>e},[Be](){return this.toJSON()},toString(){return ft(this.toJSON())}},uO=Object.assign(Object.create(hg),{_tag:"Some",_op:"Some",[le](e){return dg(e)&&gg(e)&&fe(this.value,e.value)},[de](){return Je(this,Se(X(this._tag))(X(this.value)))},toJSON(){return{_id:"Option",_tag:this._tag,value:it(this.value)}}}),aO=X("None"),lO=Object.assign(Object.create(hg),{_tag:"None",_op:"None",[le](e){return dg(e)&&pg(e)},[de](){return aO},toJSON(){return{_id:"Option",_tag:this._tag}}}),dg=e=>ue(e,fg),pg=e=>e._tag==="None",gg=e=>e._tag==="Some",mg=Object.create(lO),Rl=e=>{const t=Object.create(uO);return t.value=e,t},yg=Symbol.for("effect/Either"),_g={...Vs,[yg]:{_R:e=>e},[Be](){return this.toJSON()},toString(){return ft(this.toJSON())}},fO=Object.assign(Object.create(_g),{_tag:"Right",_op:"Right",[le](e){return xl(e)&&vg(e)&&fe(this.right,e.right)},[de](){return Se(X(this._tag))(X(this.right))},toJSON(){return{_id:"Either",_tag:this._tag,right:it(this.right)}}}),hO=Object.assign(Object.create(_g),{_tag:"Left",_op:"Left",[le](e){return xl(e)&&bg(e)&&fe(this.left,e.left)},[de](){return Se(X(this._tag))(X(this.left))},toJSON(){return{_id:"Either",_tag:this._tag,left:it(this.left)}}}),xl=e=>ue(e,yg),bg=e=>e._tag==="Left",vg=e=>e._tag==="Right",dO=e=>{const t=Object.create(hO);return t.left=e,t},Oe=e=>{const t=Object.create(fO);return t.right=e,t},ge=dO,pO=xl,mt=bg,rr=vg,gO=I(2,(e,t)=>mt(e)?ge(t(e.left)):Oe(e.right)),mO=I(2,(e,t)=>rr(e)?Oe(t(e.right)):ge(e.left)),kl=I(2,(e,{onLeft:t,onRight:n})=>mt(e)?t(e.left):n(e.right)),yO=kl({onLeft:Ze,onRight:Ze}),Sg=I(2,(e,t)=>{if(rr(e))return e.right;throw t(e.left)}),_O=Sg(()=>new Error("getOrThrow called on a Left")),wg=e=>e.length>0,Eg=e=>(t,n)=>t===n?0:e(t,n),bO=Eg((e,t)=>e<t?-1:1),Og=I(2,(e,t)=>Eg((n,i)=>e(t(n),t(i)))),vO=e=>I(2,(t,n)=>e(t,n)===1),te=()=>mg,be=Rl,yt=pg,wt=gg,Ht=I(2,(e,{onNone:t,onSome:n})=>yt(e)?t():n(e.value)),ht=I(2,(e,t)=>yt(e)?t():e.value),Ar=I(2,(e,t)=>yt(e)?t():e),SO=I(2,(e,t)=>yt(e)?be(t()):e),xc=e=>e==null?te():be(e),jn=ht(tg),wO=e=>(...t)=>{try{return be(e(...t))}catch{return te()}},Tg=I(2,(e,t)=>yt(e)?te():be(t(e.value))),kc=I(2,(e,t)=>yt(e)?te():t(e.value)),EO=I(2,(e,t)=>yt(e)?te():xc(t(e.value))),OO=(e=>I(2,(t,n)=>yt(t)?!1:e(t.value,n)))(El()),TO=I(2,(e,t)=>yt(e)?!1:t(e.value)),IO=(...e)=>e,$c=e=>new Array(e),AO=I(2,(e,t)=>{const n=Math.max(1,Math.floor(e)),i=new Array(n);for(let o=0;o<n;o++)i[o]=t(o);return i}),et=e=>Array.isArray(e)?e:Array.from(e),RO=e=>Array.isArray(e)?e:[e],xO=I(2,(e,{onEmpty:t,onNonEmpty:n})=>_t(e)?n(Nt(e),Hr(e)):t()),Mc=I(2,(e,t)=>[t,...e]),kO=I(2,(e,t)=>[...e,t]),Ig=I(2,(e,t)=>et(e).concat(et(t))),$O=Array.isArray,MO=e=>e.length===0,Cc=wg,_t=wg,Ag=(e,t)=>e<0||e>=t.length,CO=(e,t)=>Math.floor(Math.min(Math.max(0,e),t.length)),PO=I(2,(e,t)=>{const n=Math.floor(t);return Ag(n,e)?te():be(e[n])}),Rg=I(2,(e,t)=>{const n=Math.floor(t);if(Ag(n,e))throw new Error(`Index ${n} out of bounds`);return e[n]}),Ys=PO(0),Nt=Rg(0),FO=e=>_t(e)?be(xg(e)):te(),xg=e=>e[e.length-1],Hr=e=>e.slice(1),NO=(e,t)=>{let n=0;for(const i of e){if(!t(i,n))break;n++}return n},LO=I(2,(e,t)=>BO(e,NO(e,t))),DO=I(2,(e,t)=>{const n=et(e);return n.slice(CO(t,n),n.length)}),kg=e=>Array.from(e).reverse(),Xs=I(2,(e,t)=>{const n=Array.from(e);return n.sort(t),n}),$g=I(2,(e,t)=>UO(e,t,IO)),UO=I(3,(e,t,n)=>{const i=et(e),o=et(t);if(_t(i)&&_t(o)){const u=[n(Nt(i),Nt(o))],a=Math.min(i.length,o.length);for(let f=1;f<a;f++)u[f]=n(i[f],o[f]);return u}return[]}),KO=El(),BO=I(2,(e,t)=>{const n=Array.from(e),i=Math.floor(t);return _t(n)?i>=1?jO(n,i):[[],n]:[n,[]]}),jO=I(2,(e,t)=>{const n=Math.max(1,Math.floor(t));return n>=e.length?[Zs(e),[]]:[Mc(e.slice(1,n),Nt(e)),e.slice(n)]}),Zs=e=>e.slice(),WO=I(3,(e,t,n)=>{const i=et(e),o=et(t);return _t(i)?_t(o)?Fg(n)(Ig(i,o)):i:o}),Pc=I(2,(e,t)=>WO(e,t,KO)),ki=()=>[],Tn=e=>[e],$i=I(2,(e,t)=>e.map(t)),Mg=I(2,(e,t)=>{if(MO(e))return[];const n=[];for(let i=0;i<e.length;i++){const o=t(e[i],i);for(let u=0;u<o.length;u++)n.push(o[u])}return n}),qO=Mg(Ze),Cg=I(3,(e,t,n)=>et(e).reduce((i,o,u)=>n(i,o,u),t)),Pg=(e,t)=>{const n=[];let i=e,o;for(;wt(o=t(i));){const[u,a]=o.value;n.push(u),i=a}return n},$l=ME,Fg=I(2,(e,t)=>{const n=et(e);if(_t(n)){const i=[Nt(n)],o=Hr(n);for(const u of o)i.every(a=>!t(u,a))&&i.push(u);return i}return[]}),JO=e=>Fg(e,El()),Mi=I(2,(e,t)=>et(e).join(t)),Ng=(e,t)=>{switch(t._tag){case"StringKeyword":case"TemplateLiteral":return Object.keys(e);case"SymbolKeyword":return Object.getOwnPropertySymbols(e);case"Refinement":return Ng(e,t.from)}},Ci=e=>Object.keys(e).concat(Object.getOwnPropertySymbols(e)),Lg=e=>{let t=!1,n;return()=>(t||(n=e(),t=!0),n)},GO=e=>{try{return e.toISOString()}catch{return String(e)}},Wn=(e,t=!0)=>{if(Array.isArray(e))return`[${e.map(n=>Wn(n,t)).join(",")}]`;if(LE(e))return GO(e);if(ue(e,"toString")&&Ws(e.toString)&&e.toString!==Object.prototype.toString)return e.toString();if(Bn(e))return JSON.stringify(e);if(Jr(e)||e==null||ml(e)||yl(e))return String(e);if(_c(e))return String(e)+"n";if(rg(e))return`${e.constructor.name}(${Wn(Array.from(e),t)})`;try{t&&JSON.stringify(e);const n=`{${Ci(e).map(o=>`${Bn(o)?JSON.stringify(o):String(o)}:${Wn(e[o],!1)}`).join(",")}}`,i=e.constructor.name;return e.constructor!==Object.prototype.constructor?`${i}(${n})`:n}catch{return"<circular structure>"}},HO=e=>typeof e=="string"?JSON.stringify(e):String(e),Dg=e=>Array.isArray(e),Ug=e=>`[${HO(e)}]`,VO=e=>Dg(e)?e.map(Ug).join(""):Ug(e),Vr=(e,t,n,i)=>{let o=e;return t!==void 0&&(o+=`
details: ${t}`),i&&(o+=`
schema (${i._tag}): ${i}`),o},zO=e=>Vr("Unsupported key schema",void 0,void 0,e),YO=e=>Vr("Unsupported literal",`literal value: ${Wn(e)}`),Kg=e=>Vr("Duplicate index signature",`${e} index signature`),XO=Vr("Unsupported index signature parameter","An index signature parameter type must be `string`, `symbol`, a template literal type or a refinement of the previous types"),ZO=Vr("Invalid element","A required element cannot follow an optional element. ts(1257)"),Bg=e=>Vr("Duplicate property signature transformation",`Duplicate key ${Wn(e)}`),QO=e=>Vr("Duplicate property signature",`Duplicate key ${Wn(e)}`),Pi=bO,Fc=e=>e.replace(/[/\\^$*+?.()|[\]{}]/g,"\\$&"),eT=Symbol.for("effect/annotation/Brand"),tT=Symbol.for("effect/annotation/SchemaId"),jg=Symbol.for("effect/annotation/Message"),Ml=Symbol.for("effect/annotation/MissingMessage"),Wg=Symbol.for("effect/annotation/Identifier"),Rr=Symbol.for("effect/annotation/Title"),Cl=Symbol.for("effect/annotation/AutoTitle"),Nc=Symbol.for("effect/annotation/Description"),qg=Symbol.for("effect/annotation/Examples"),Jg=Symbol.for("effect/annotation/Default"),Gg=Symbol.for("effect/annotation/JSONSchema"),Hg=Symbol.for("effect/annotation/Arbitrary"),Vg=Symbol.for("effect/annotation/Pretty"),zg=Symbol.for("effect/annotation/Equivalence"),nT=Symbol.for("effect/annotation/Documentation"),Yg=Symbol.for("effect/annotation/Concurrency"),Xg=Symbol.for("effect/annotation/Batching"),Zg=Symbol.for("effect/annotation/ParseIssueTitle"),Qg=Symbol.for("effect/annotation/ParseOptions"),em=Symbol.for("effect/annotation/DecodingFallback"),tm=Symbol.for("effect/annotation/Surrogate"),rT=Symbol.for("effect/annotation/StableFilter"),Et=I(2,(e,t)=>Object.prototype.hasOwnProperty.call(e.annotations,t)?be(e.annotations[t]):te()),iT=Et(eT),sT=Et(jg),oT=Et(Ml),nm=Et(Rr),rm=Et(Cl),Lc=Et(Wg),im=Et(Nc),cT=Et(Yg),uT=Et(Xg),aT=Et(Zg),lT=Et(Qg),fT=Et(em),sm=Et(tm),hT=Et(rT),dT=e=>TO(hT(e),t=>t===!0),om=Symbol.for("effect/annotation/JSONIdentifier"),pT=Et(om),gT=e=>Ar(pT(e),()=>Lc(e));class cm{constructor(t,n,i,o={}){p(this,"typeParameters");p(this,"decodeUnknown");p(this,"encodeUnknown");p(this,"annotations");p(this,"_tag","Declaration");this.typeParameters=t,this.decodeUnknown=n,this.encodeUnknown=i,this.annotations=o}toString(){return ht(Jn(this),()=>"<declaration schema>")}toJSON(){return{_tag:this._tag,typeParameters:this.typeParameters.map(t=>t.toJSON()),annotations:dt(this.annotations)}}}const Qs=e=>t=>t._tag===e;class mT{constructor(t,n={}){p(this,"literal");p(this,"annotations");p(this,"_tag","Literal");this.literal=t,this.annotations=n}toString(){return ht(Jn(this),()=>Wn(this.literal))}toJSON(){return{_tag:this._tag,literal:_c(this.literal)?String(this.literal):this.literal,annotations:dt(this.annotations)}}}const um=Qs("Literal");class yT{constructor(t,n={}){p(this,"symbol");p(this,"annotations");p(this,"_tag","UniqueSymbol");this.symbol=t,this.annotations=n}toString(){return ht(Jn(this),()=>Wn(this.symbol))}toJSON(){return{_tag:this._tag,symbol:String(this.symbol),annotations:dt(this.annotations)}}}class _T{constructor(t={}){p(this,"annotations");p(this,"_tag","UndefinedKeyword");this.annotations=t}toString(){return Li(this)}toJSON(){return{_tag:this._tag,annotations:dt(this.annotations)}}}const Pl=new _T({[Rr]:"undefined"});class bT{constructor(t={}){p(this,"annotations");p(this,"_tag","NeverKeyword");this.annotations=t}toString(){return Li(this)}toJSON(){return{_tag:this._tag,annotations:dt(this.annotations)}}}const Fl=new bT({[Rr]:"never"});class vT{constructor(t={}){p(this,"annotations");p(this,"_tag","UnknownKeyword");this.annotations=t}toString(){return Li(this)}toJSON(){return{_tag:this._tag,annotations:dt(this.annotations)}}}const ST=new vT({[Rr]:"unknown"});class wT{constructor(t={}){p(this,"annotations");p(this,"_tag","AnyKeyword");this.annotations=t}toString(){return Li(this)}toJSON(){return{_tag:this._tag,annotations:dt(this.annotations)}}}const ET=new wT({[Rr]:"any"});class OT{constructor(t={}){p(this,"annotations");p(this,"_tag","StringKeyword");this.annotations=t}toString(){return Li(this)}toJSON(){return{_tag:this._tag,annotations:dt(this.annotations)}}}const TT=new OT({[Rr]:"string",[Nc]:"a string"}),IT=Qs("StringKeyword");class AT{constructor(t={}){p(this,"annotations");p(this,"_tag","NumberKeyword");this.annotations=t}toString(){return Li(this)}toJSON(){return{_tag:this._tag,annotations:dt(this.annotations)}}}const RT=new AT({[Rr]:"number",[Nc]:"a number"}),xT=Qs("SymbolKeyword");let Dc=class{constructor(t,n={}){p(this,"type");p(this,"annotations");this.type=t,this.annotations=n}toJSON(){return{type:this.type.toJSON(),annotations:dt(this.annotations)}}toString(){return String(this.type)}};class zr extends Dc{constructor(n,i,o={}){super(n,o);p(this,"isOptional");this.isOptional=i}toJSON(){return{type:this.type.toJSON(),isOptional:this.isOptional,annotations:dt(this.annotations)}}toString(){return String(this.type)+(this.isOptional?"?":"")}}const am=e=>e.map(t=>t.type);class Nl{constructor(t,n,i,o={}){p(this,"elements");p(this,"rest");p(this,"isReadonly");p(this,"annotations");p(this,"_tag","TupleType");this.elements=t,this.rest=n,this.isReadonly=i,this.annotations=o;let u=!1,a=!1;for(const f of t)if(f.isOptional)u=!0;else if(u){a=!0;break}if(a||u&&n.length>1)throw new Error(ZO)}toString(){return ht(Jn(this),()=>kT(this))}toJSON(){return{_tag:this._tag,elements:this.elements.map(t=>t.toJSON()),rest:this.rest.map(t=>t.toJSON()),isReadonly:this.isReadonly,annotations:dt(this.annotations)}}}const kT=e=>{const t=e.elements.map(String).join(", ");return xO(e.rest,{onEmpty:()=>`readonly [${t}]`,onNonEmpty:(n,i)=>{const o=String(n),u=o.includes(" | ")?`(${o})`:o;if(i.length>0){const a=i.map(String).join(", ");return e.elements.length>0?`readonly [${t}, ...${u}[], ${a}]`:`readonly [...${u}[], ${a}]`}else return e.elements.length>0?`readonly [${t}, ...${u}[]]`:`ReadonlyArray<${o}>`}})};class Ot extends zr{constructor(n,i,o,u,a){super(i,o,a);p(this,"name");p(this,"isReadonly");this.name=n,this.isReadonly=u}toString(){return(this.isReadonly?"readonly ":"")+String(this.name)+(this.isOptional?"?":"")+": "+this.type}toJSON(){return{name:String(this.name),type:this.type.toJSON(),isOptional:this.isOptional,isReadonly:this.isReadonly,annotations:dt(this.annotations)}}}const lm=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return!0;case"Refinement":return lm(e.from)}return!1};class Uc{constructor(t,n,i){p(this,"type");p(this,"isReadonly");p(this,"parameter");if(this.type=n,this.isReadonly=i,lm(t))this.parameter=t;else throw new Error(XO)}toString(){return(this.isReadonly?"readonly ":"")+`[x: ${this.parameter}]: ${this.type}`}toJSON(){return{parameter:this.parameter.toJSON(),type:this.type.toJSON(),isReadonly:this.isReadonly}}}class Yr{constructor(t,n,i={}){p(this,"annotations");p(this,"_tag","TypeLiteral");p(this,"propertySignatures");p(this,"indexSignatures");this.annotations=i;const o={};for(let a=0;a<t.length;a++){const f=t[a].name;if(Object.prototype.hasOwnProperty.call(o,f))throw new Error(QO(f));o[f]=null}const u={string:!1,symbol:!1};for(let a=0;a<n.length;a++){const f=Em(n[a].parameter);if(IT(f)){if(u.string)throw new Error(Kg("string"));u.string=!0}else if(xT(f)){if(u.symbol)throw new Error(Kg("symbol"));u.symbol=!0}}this.propertySignatures=t,this.indexSignatures=n}toString(){return ht(Jn(this),()=>$T(this))}toJSON(){return{_tag:this._tag,propertySignatures:this.propertySignatures.map(t=>t.toJSON()),indexSignatures:this.indexSignatures.map(t=>t.toJSON()),annotations:dt(this.annotations)}}}const fm=e=>e.map(String).join("; "),$T=e=>{if(e.propertySignatures.length>0){const t=e.propertySignatures.map(String).join("; ");return e.indexSignatures.length>0?`{ ${t}; ${fm(e.indexSignatures)} }`:`{ ${t} }`}else return e.indexSignatures.length>0?`{ ${fm(e.indexSignatures)} }`:"{}"},MT=Xs(Og(Pi,e=>{switch(e._tag){case"AnyKeyword":return 0;case"UnknownKeyword":return 1;case"ObjectKeyword":return 2;case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":return 3}return 4})),CT={string:"StringKeyword",number:"NumberKeyword",boolean:"BooleanKeyword",bigint:"BigIntKeyword"},hm=e=>Mg(e,t=>pm(t)?hm(t.types):[t]),PT=e=>{const t=MT(e),n=[],i={},o=[];for(const u of t)switch(u._tag){case"NeverKeyword":break;case"AnyKeyword":return[ET];case"UnknownKeyword":return[ST];case"ObjectKeyword":case"UndefinedKeyword":case"VoidKeyword":case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":{i[u._tag]||(i[u._tag]=u,n.push(u));break}case"Literal":{const a=typeof u.literal;switch(a){case"string":case"number":case"bigint":case"boolean":{const f=CT[a];!i[f]&&!o.includes(u.literal)&&(o.push(u.literal),n.push(u));break}case"object":{o.includes(u.literal)||(o.push(u.literal),n.push(u));break}}break}case"UniqueSymbol":{!i.SymbolKeyword&&!o.includes(u.symbol)&&(o.push(u.symbol),n.push(u));break}case"TupleType":{i.ObjectKeyword||n.push(u);break}case"TypeLiteral":{u.propertySignatures.length===0&&u.indexSignatures.length===0?i["{}"]||(i["{}"]=u,n.push(u)):i.ObjectKeyword||n.push(u);break}default:n.push(u)}return n};let ir=(pr=class{constructor(t,n={}){p(this,"types");p(this,"annotations");p(this,"_tag","Union");this.types=t,this.annotations=n}toString(){return ht(Jn(this),()=>this.types.map(String).join(" | "))}toJSON(){return{_tag:this._tag,types:this.types.map(t=>t.toJSON()),annotations:dt(this.annotations)}}},p(pr,"make",(t,n)=>dm(t)?new pr(t,n):t.length===1?t[0]:Fl),p(pr,"unify",(t,n)=>pr.make(PT(hm(t)),n)),pr);const dm=e=>e.length>1,pm=Qs("Union"),Ll=Ee(Symbol.for("effect/Schema/AST/toJSONMemoMap"),()=>new WeakMap);class gm{constructor(t,n={}){p(this,"f");p(this,"annotations");p(this,"_tag","Suspend");this.f=t,this.annotations=n,this.f=Lg(t)}toString(){return Jn(this).pipe(Ar(()=>kc(wO(this.f)(),t=>Jn(t))),ht(()=>"<suspended schema>"))}toJSON(){const t=this.f();let n=Ll.get(t);return n||(Ll.set(t,{_tag:this._tag}),n={_tag:this._tag,ast:t.toJSON(),annotations:dt(this.annotations)},Ll.set(t,n),n)}}let FT=class{constructor(t,n,i={}){p(this,"from");p(this,"filter");p(this,"annotations");p(this,"_tag","Refinement");this.from=t,this.filter=n,this.annotations=i}toString(){return Lc(this).pipe(ht(()=>Ht(Om(this),{onNone:()=>`{ ${this.from} | filter }`,onSome:t=>mm(this.from)?String(this.from)+" & "+t:t})))}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),annotations:dt(this.annotations)}}};const mm=Qs("Refinement"),Dl={};let ym=class{constructor(t,n,i,o={}){p(this,"from");p(this,"to");p(this,"transformation");p(this,"annotations");p(this,"_tag","Transformation");this.from=t,this.to=n,this.transformation=i,this.annotations=o}toString(){return ht(Jn(this),()=>`(${String(this.from)} <-> ${String(this.to)})`)}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),to:this.to.toJSON(),annotations:dt(this.annotations)}}};class NT{constructor(t,n){p(this,"decode");p(this,"encode");p(this,"_tag","FinalTransformation");this.decode=t,this.encode=n}}let LT=class{constructor(t,n,i,o){p(this,"from");p(this,"to");p(this,"decode");p(this,"encode");this.from=t,this.to=n,this.decode=i,this.encode=o}};class DT{constructor(t){p(this,"propertySignatureTransformations");p(this,"_tag","TypeLiteralTransformation");this.propertySignatureTransformations=t;const n={},i={};for(const o of t){const u=o.from;if(n[u])throw new Error(Bg(u));n[u]=!0;const a=o.to;if(i[a])throw new Error(Bg(a));i[a]=!0}}}const Fi=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),i={...e.annotations,...t},o=sm(e);return wt(o)&&(i[tm]=Fi(o.value,t)),n.annotations.value=i,Object.create(Object.getPrototypeOf(e),n)},UT="[\\s\\S]*",KT="[+-]?\\d*\\.?\\d+(?:[Ee][+-]?\\d+)?",_m=(e,t)=>{switch(e._tag){case"Literal":return Fc(String(e.literal));case"StringKeyword":return UT;case"NumberKeyword":return KT;case"TemplateLiteral":return bm(e);case"Union":return e.types.map(n=>_m(n)).join("|")}},BT=(e,t,n,i)=>pm(e)?`(${t})`:t,bm=(e,t,n)=>{let i="";if(e.head!==""){const o=Fc(e.head);i+=o}for(const o of e.spans){const u=_m(o.type);if(i+=BT(o.type,u),o.literal!==""){const a=Fc(o.literal);i+=a}}return i},jT=e=>new RegExp(`^${bm(e)}$`),vm=(e,t)=>{const n=[],i=[],o=u=>{switch(u._tag){case"NeverKeyword":break;case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":case"Refinement":i.push(new Uc(u,t,!0));break;case"Literal":if(Bn(u.literal)||Jr(u.literal))n.push(new Ot(u.literal,t,!1,!0));else throw new Error(YO(u.literal));break;case"Enums":{for(const[a,f]of u.enums)n.push(new Ot(f,t,!1,!0));break}case"UniqueSymbol":n.push(new Ot(u.symbol,t,!1,!0));break;case"Union":u.types.forEach(o);break;default:throw new Error(zO(u))}};return o(e),{propertySignatures:n,indexSignatures:i}},Sm=e=>t=>{let n;for(const i of e)Object.prototype.hasOwnProperty.call(t.annotations,i)&&(n===void 0&&(n={}),n[i]=t.annotations[i]);return n},WT=Sm([qg,Jg,Gg,Hg,Vg,zg]),Lt=e=>{switch(e._tag){case"Declaration":{const t=cn(e.typeParameters,Lt);return t===e.typeParameters?e:new cm(t,e.decodeUnknown,e.encodeUnknown,e.annotations)}case"TupleType":{const t=cn(e.elements,o=>{const u=Lt(o.type);return u===o.type?o:new zr(u,o.isOptional)}),n=am(e.rest),i=cn(n,Lt);return t===e.elements&&i===n?e:new Nl(t,i.map(o=>new Dc(o)),e.isReadonly,e.annotations)}case"TypeLiteral":{const t=cn(e.propertySignatures,i=>{const o=Lt(i.type);return o===i.type?i:new Ot(i.name,o,i.isOptional,i.isReadonly)}),n=cn(e.indexSignatures,i=>{const o=Lt(i.type);return o===i.type?i:new Uc(i.parameter,o,i.isReadonly)});return t===e.propertySignatures&&n===e.indexSignatures?e:new Yr(t,n,e.annotations)}case"Union":{const t=cn(e.types,Lt);return t===e.types?e:ir.make(t,e.annotations)}case"Suspend":return new gm(()=>Lt(e.f()),e.annotations);case"Refinement":{const t=Lt(e.from);return t===e.from?e:new FT(t,e.filter,e.annotations)}case"Transformation":{const t=WT(e);return Lt(t!==void 0?Fi(e.to,t):e.to)}}return e},Ni=e=>Ht(gT(e),{onNone:()=>{},onSome:t=>({[om]:t})});function cn(e,t){let n=!1;const i=$c(e.length);for(let o=0;o<e.length;o++){const u=e[o],a=t(u);a!==u&&(n=!0),i[o]=a}return n?i:e}const qn=(e,t)=>{switch(e._tag){case"Declaration":{const n=cn(e.typeParameters,i=>qn(i));return n===e.typeParameters?e:new cm(n,e.decodeUnknown,e.encodeUnknown,e.annotations)}case"TupleType":{const n=cn(e.elements,u=>{const a=qn(u.type);return a===u.type?u:new zr(a,u.isOptional)}),i=am(e.rest),o=cn(i,u=>qn(u));return n===e.elements&&o===i?e:new Nl(n,o.map(u=>new Dc(u)),e.isReadonly,Ni(e))}case"TypeLiteral":{const n=cn(e.propertySignatures,o=>{const u=qn(o.type);return u===o.type?o:new Ot(o.name,u,o.isOptional,o.isReadonly)}),i=cn(e.indexSignatures,o=>{const u=qn(o.type);return u===o.type?o:new Uc(o.parameter,u,o.isReadonly)});return n===e.propertySignatures&&i===e.indexSignatures?e:new Yr(n,i,Ni(e))}case"Union":{const n=cn(e.types,i=>qn(i));return n===e.types?e:ir.make(n,Ni(e))}case"Suspend":return new gm(()=>qn(e.f()),Ni(e));case"Refinement":{const n=qn(e.from),i=Ni(e);return i?Fi(n,i):n}case"Transformation":{const n=Ni(e);return qn(n?Fi(e.from,n):e.from)}}return e},wm=e=>qn(e),dt=e=>{const t={};for(const n of Object.getOwnPropertySymbols(e))t[String(n)]=e[n];return t},Em=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return e;case"Refinement":return Em(e.from)}},Li=e=>ht(Jn(e),()=>e._tag);function qT(e){return Ht(iT(e),{onNone:()=>"",onSome:t=>t.map(n=>` & Brand<${Wn(n)}>`).join("")})}const Om=e=>nm(e).pipe(Ar(()=>im(e)),Ar(()=>rm(e)),Tg(t=>t+qT(e))),Jn=e=>Ar(Lc(e),()=>Om(e)),JT=Symbol.for("effect/Context/Tag"),Kc=Symbol.for("effect/Context/Reference"),Tm={...Vs,_op:"Tag",[Symbol.for("effect/STM")]:xi,[JT]:{_Service:e=>e,_Identifier:e=>e},toString(){return ft(this.toJSON())},toJSON(){return{_id:"Tag",key:this.key,stack:this.stack}},[Be](){return this.toJSON()},of(e){return e},context(e){return Am(this,e)}},GT={...Tm,[Kc]:Kc},HT=e=>{const t=Error.stackTraceLimit;Error.stackTraceLimit=2;const n=new Error;Error.stackTraceLimit=t;const i=Object.create(Tm);return Object.defineProperty(i,"stack",{get(){return n.stack}}),i.key=e,i},VT=()=>(e,t)=>{const n=Error.stackTraceLimit;Error.stackTraceLimit=2;const i=new Error;Error.stackTraceLimit=n;function o(){}return Object.setPrototypeOf(o,GT),o.key=e,o.defaultValue=t.defaultValue,Object.defineProperty(o,"stack",{get(){return i.stack}}),o},Im=Symbol.for("effect/Context"),zT={[Im]:{_Services:e=>e},[le](e){if(XT(e)&&this.unsafeMap.size===e.unsafeMap.size){for(const t of this.unsafeMap.keys())if(!e.unsafeMap.has(t)||!fe(this.unsafeMap.get(t),e.unsafeMap.get(t)))return!1;return!0}return!1},[de](){return Je(this,wl(this.unsafeMap.size))},pipe(){return re(this,arguments)},toString(){return ft(this.toJSON())},toJSON(){return{_id:"Context",services:Array.from(this.unsafeMap).map(it)}},[Be](){return this.toJSON()}},Di=e=>{const t=Object.create(zT);return t.unsafeMap=e,t},YT=e=>{const t=new Error(`Service not found${e.key?`: ${String(e.key)}`:""}`);if(e.stack){const n=e.stack.split(`
`);if(n.length>2){const i=n[2].match(/at (.*)/);i&&(t.message=t.message+` (defined at ${i[1]})`)}}if(t.stack){const n=t.stack.split(`
`);n.splice(1,3),t.stack=n.join(`
`)}return t},XT=e=>ue(e,Im),ZT=e=>ue(e,Kc),QT=Di(new Map),eI=()=>QT,Am=(e,t)=>Di(new Map([[e.key,t]])),tI=I(3,(e,t,n)=>{const i=new Map(e.unsafeMap);return i.set(t.key,n),Di(i)}),Ul=Ee("effect/Context/defaultValueCache",()=>new Map),Kl=e=>{if(Ul.has(e.key))return Ul.get(e.key);const t=e.defaultValue();return Ul.set(e.key,t),t},nI=(e,t)=>e.unsafeMap.has(t.key)?e.unsafeMap.get(t.key):Kl(t),Rm=I(2,(e,t)=>{if(!e.unsafeMap.has(t.key)){if(Kc in t)return Kl(t);throw YT(t)}return e.unsafeMap.get(t.key)}),rI=Rm,iI=I(2,(e,t)=>e.unsafeMap.has(t.key)?Rl(e.unsafeMap.get(t.key)):ZT(t)?Rl(Kl(t)):mg),sI=I(2,(e,t)=>{const n=new Map(e.unsafeMap);for(const[i,o]of t.unsafeMap)n.set(i,o);return Di(n)}),Xr=HT,Bl=eI,oI=Am,eo=tI,xm=rI,km=Rm,to=iI,$m=sI,Mm=VT,Cm=Symbol.for("effect/Chunk");function cI(e,t,n,i,o){for(let u=t;u<Math.min(e.length,t+o);u++)n[i+u-t]=e[u];return n}const Pm=[],uI=(e=>gl((t,n)=>t.length===n.length&&Zr(t).every((i,o)=>e(i,Ki(n,o)))))(fe),aI={[Cm]:{_A:e=>e},toString(){return ft(this.toJSON())},toJSON(){return{_id:"Chunk",values:Zr(this).map(it)}},[Be](){return this.toJSON()},[le](e){return Fm(e)&&uI(this,e)},[de](){return Je(this,Js(Zr(this)))},[Symbol.iterator](){switch(this.backing._tag){case"IArray":return this.backing.array[Symbol.iterator]();case"IEmpty":return Pm[Symbol.iterator]();default:return Zr(this)[Symbol.iterator]()}},pipe(){return re(this,arguments)}},st=e=>{const t=Object.create(aI);switch(t.backing=e,e._tag){case"IEmpty":{t.length=0,t.depth=0,t.left=t,t.right=t;break}case"IConcat":{t.length=e.left.length+e.right.length,t.depth=1+Math.max(e.left.depth,e.right.depth),t.left=e.left,t.right=e.right;break}case"IArray":{t.length=e.array.length,t.depth=0,t.left=Gn,t.right=Gn;break}case"ISingleton":{t.length=1,t.depth=0,t.left=Gn,t.right=Gn;break}case"ISlice":{t.length=e.length,t.depth=e.chunk.depth+1,t.left=Gn,t.right=Gn;break}}return t},Fm=e=>ue(e,Cm),Gn=st({_tag:"IEmpty"}),sr=()=>Gn,jl=(...e)=>lI(e),Vt=e=>st({_tag:"ISingleton",a:e}),Nm=e=>Fm(e)?e:Bc(et(e)),Wl=(e,t,n)=>{switch(e.backing._tag){case"IArray":{cI(e.backing.array,0,t,n,e.length);break}case"IConcat":{Wl(e.left,t,n),Wl(e.right,t,n+e.left.length);break}case"ISingleton":{t[n]=e.backing.a;break}case"ISlice":{let i=0,o=n;for(;i<e.length;)t[o]=Ki(e,i),i+=1,o+=1;break}}},Zr=e=>{switch(e.backing._tag){case"IEmpty":return Pm;case"IArray":return e.backing.array;default:{const t=new Array(e.length);return Wl(e,t,0),e.backing={_tag:"IArray",array:t},e.left=Gn,e.right=Gn,e.depth=0,t}}},Ui=e=>{switch(e.backing._tag){case"IEmpty":case"ISingleton":return e;case"IArray":return st({_tag:"IArray",array:kg(e.backing.array)});case"IConcat":return st({_tag:"IConcat",left:Ui(e.backing.right),right:Ui(e.backing.left)});case"ISlice":return Bc(kg(Zr(e)))}},Bc=e=>e.length===0?sr():e.length===1?Vt(e[0]):st({_tag:"IArray",array:e}),lI=e=>Bc(e),Ki=I(2,(e,t)=>{switch(e.backing._tag){case"IEmpty":throw new Error("Index out of bounds");case"ISingleton":{if(t!==0)throw new Error("Index out of bounds");return e.backing.a}case"IArray":{if(t>=e.length||t<0)throw new Error("Index out of bounds");return e.backing.array[t]}case"IConcat":return t<e.left.length?Ki(e.left,t):Ki(e.right,t-e.left.length);case"ISlice":return Ki(e.backing.chunk,t+e.backing.offset)}}),fI=I(2,(e,t)=>An(e,Vt(t))),In=I(2,(e,t)=>An(Vt(t),e)),ql=I(2,(e,t)=>{if(t<=0)return e;if(t>=e.length)return Gn;switch(e.backing._tag){case"ISlice":return st({_tag:"ISlice",chunk:e.backing.chunk,offset:e.backing.offset+t,length:e.backing.length-t});case"IConcat":return t>e.left.length?ql(e.right,t-e.left.length):st({_tag:"IConcat",left:ql(e.left,t),right:e.right});default:return st({_tag:"ISlice",chunk:e,offset:t,length:e.length-t})}}),An=I(2,(e,t)=>{if(e.backing._tag==="IEmpty")return t;if(t.backing._tag==="IEmpty")return e;const n=t.depth-e.depth;if(Math.abs(n)<=1)return st({_tag:"IConcat",left:e,right:t});if(n<-1)if(e.left.depth>=e.right.depth){const i=An(e.right,t);return st({_tag:"IConcat",left:e.left,right:i})}else{const i=An(e.right.right,t);if(i.depth===e.depth-3){const o=st({_tag:"IConcat",left:e.right.left,right:i});return st({_tag:"IConcat",left:e.left,right:o})}else{const o=st({_tag:"IConcat",left:e.left,right:e.right.left});return st({_tag:"IConcat",left:o,right:i})}}else if(t.right.depth>=t.left.depth){const i=An(e,t.left);return st({_tag:"IConcat",left:i,right:t.right})}else{const i=An(e,t.left.left);if(i.depth===t.depth-3){const o=st({_tag:"IConcat",left:i,right:t.left.right});return st({_tag:"IConcat",left:o,right:t.right})}else{const o=st({_tag:"IConcat",left:t.left.right,right:t.right});return st({_tag:"IConcat",left:i,right:o})}}}),hI=e=>e.length===0,Bi=e=>e.length>0,Lm=e=>Ki(e,0),ji=Lm,Qr=e=>ql(e,1),Jl=Symbol.for("effect/Duration"),Dm=BigInt(0),Um=BigInt(24),jc=BigInt(60),Gl=BigInt(1e3),Km=BigInt(1e6),Bm=BigInt(1e9),dI=/^(-?\d+(?:\.\d+)?)\s+(nanos?|micros?|millis?|seconds?|minutes?|hours?|days?|weeks?)$/,or=e=>{if(Wm(e))return e;if(Jr(e))return Vl(e);if(_c(e))return Hl(e);if(Array.isArray(e)&&e.length===2&&e.every(Jr))return e[0]===-1/0||e[1]===-1/0||Number.isNaN(e[0])||Number.isNaN(e[1])?qm:e[0]===1/0||e[1]===1/0?yI:Hl(BigInt(Math.round(e[0]*1e9))+BigInt(Math.round(e[1])));if(Bn(e)){const t=dI.exec(e);if(t){const[n,i,o]=t,u=Number(i);switch(o){case"nano":case"nanos":return Hl(BigInt(i));case"micro":case"micros":return _I(BigInt(i));case"milli":case"millis":return Vl(u);case"second":case"seconds":return bI(u);case"minute":case"minutes":return vI(u);case"hour":case"hours":return SI(u);case"day":case"days":return wI(u);case"week":case"weeks":return EI(u)}}}throw new Error("Invalid DurationInput")},jm={_tag:"Millis",millis:0},pI={_tag:"Infinity"},gI={[Jl]:Jl,[de](){return Je(this,og(this.value))},[le](e){return Wm(e)&&xI(this,e)},toString(){return`Duration(${$I(this)})`},toJSON(){switch(this.value._tag){case"Millis":return{_id:"Duration",_tag:"Millis",millis:this.value.millis};case"Nanos":return{_id:"Duration",_tag:"Nanos",hrtime:TI(this)};case"Infinity":return{_id:"Duration",_tag:"Infinity"}}},[Be](){return this.toJSON()},pipe(){return re(this,arguments)}},Hn=e=>{const t=Object.create(gI);return Jr(e)?isNaN(e)||e<=0?t.value=jm:Number.isFinite(e)?Number.isInteger(e)?t.value={_tag:"Millis",millis:e}:t.value={_tag:"Nanos",nanos:BigInt(Math.round(e*1e6))}:t.value=pI:e<=Dm?t.value=jm:t.value={_tag:"Nanos",nanos:e},t},Wm=e=>ue(e,Jl),mI=e=>{switch(e.value._tag){case"Millis":return e.value.millis===0;case"Nanos":return e.value.nanos===Dm;case"Infinity":return!1}},qm=Hn(0),yI=Hn(1/0),Hl=e=>Hn(e),_I=e=>Hn(e*Gl),Vl=e=>Hn(e),bI=e=>Hn(e*1e3),vI=e=>Hn(e*6e4),SI=e=>Hn(e*36e5),wI=e=>Hn(e*864e5),EI=e=>Hn(e*6048e5),zl=e=>II(e,{onMillis:t=>t,onNanos:t=>Number(t)/1e6}),OI=e=>{const t=or(e);switch(t.value._tag){case"Infinity":throw new Error("Cannot convert infinite duration to nanos");case"Nanos":return t.value.nanos;case"Millis":return BigInt(Math.round(t.value.millis*1e6))}},TI=e=>{const t=or(e);switch(t.value._tag){case"Infinity":return[1/0,0];case"Nanos":return[Number(t.value.nanos/Bm),Number(t.value.nanos%Bm)];case"Millis":return[Math.floor(t.value.millis/1e3),Math.round(t.value.millis%1e3*1e6)]}},II=I(2,(e,t)=>{const n=or(e);switch(n.value._tag){case"Nanos":return t.onNanos(n.value.nanos);case"Infinity":return t.onMillis(1/0);case"Millis":return t.onMillis(n.value.millis)}}),Jm=I(3,(e,t,n)=>{const i=or(e),o=or(t);if(i.value._tag==="Infinity"||o.value._tag==="Infinity")return n.onMillis(zl(i),zl(o));if(i.value._tag==="Nanos"||o.value._tag==="Nanos"){const u=i.value._tag==="Nanos"?i.value.nanos:BigInt(Math.round(i.value.millis*1e6)),a=o.value._tag==="Nanos"?o.value.nanos:BigInt(Math.round(o.value.millis*1e6));return n.onNanos(u,a)}return n.onMillis(i.value.millis,o.value.millis)}),AI=(e,t)=>Jm(e,t,{onMillis:(n,i)=>n===i,onNanos:(n,i)=>n===i}),RI=I(2,(e,t)=>Jm(e,t,{onMillis:(n,i)=>n>=i,onNanos:(n,i)=>n>=i})),xI=I(2,(e,t)=>AI(or(e),or(t))),kI=e=>{const t=or(e);if(t.value._tag==="Infinity")return{days:1/0,hours:1/0,minutes:1/0,seconds:1/0,millis:1/0,nanos:1/0};const n=OI(t),i=n/Km,o=i/Gl,u=o/jc,a=u/jc,f=a/Um;return{days:Number(f),hours:Number(a%Um),minutes:Number(u%jc),seconds:Number(o%jc),millis:Number(i%Gl),nanos:Number(n%Km)}},$I=e=>{const t=or(e);if(t.value._tag==="Infinity")return"Infinity";if(mI(t))return"0";const n=kI(t),i=[];return n.days!==0&&i.push(`${n.days}d`),n.hours!==0&&i.push(`${n.hours}h`),n.minutes!==0&&i.push(`${n.minutes}m`),n.seconds!==0&&i.push(`${n.seconds}s`),n.millis!==0&&i.push(`${n.millis}ms`),n.nanos!==0&&i.push(`${n.nanos}ns`),i.join(" ")},ei=5,Yl=Math.pow(2,ei),MI=Yl-1,CI=Yl/2,PI=Yl/4;function FI(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function Wi(e,t){return t>>>e&MI}function qi(e){return 1<<e}function Gm(e,t){return FI(e&t-1)}const NI=(e,t)=>({value:e,previous:t});function Ji(e,t,n,i){let o=i;if(!e){const u=i.length;o=new Array(u);for(let a=0;a<u;++a)o[a]=i[a]}return o[t]=n,o}function Hm(e,t,n){const i=n.length-1;let o=0,u=0,a=n;if(e)o=u=t;else for(a=new Array(i);o<t;)a[u++]=n[o++];for(++o;o<=i;)a[u++]=n[o++];return e&&(a.length=i),a}function LI(e,t,n,i){const o=i.length;if(e){let d=o;for(;d>=t;)i[d--]=i[d];return i[t]=n,i}let u=0,a=0;const f=new Array(o+1);for(;u<t;)f[a++]=i[u++];for(f[t]=n;u<o;)f[++a]=i[u++];return f}class xr{constructor(){p(this,"_tag","EmptyNode")}modify(t,n,i,o,u,a){const f=i(te());return yt(f)?new xr:(++a.value,new ti(t,o,u,f))}}function Rn(e){return ng(e,"EmptyNode")}function DI(e){return Rn(e)||e._tag==="LeafNode"||e._tag==="CollisionNode"}function Wc(e,t){return Rn(e)?!1:t===e.edit}class ti{constructor(t,n,i,o){p(this,"edit");p(this,"hash");p(this,"key");p(this,"value");p(this,"_tag","LeafNode");this.edit=t,this.hash=n,this.key=i,this.value=o}modify(t,n,i,o,u,a){if(fe(u,this.key)){const d=i(this.value);return d===this.value?this:yt(d)?(--a.value,new xr):Wc(this,t)?(this.value=d,this):new ti(t,o,u,d)}const f=i(te());return yt(f)?this:(++a.value,Vm(t,n,this.hash,this,o,new ti(t,o,u,f)))}}class Xl{constructor(t,n,i){p(this,"edit");p(this,"hash");p(this,"children");p(this,"_tag","CollisionNode");this.edit=t,this.hash=n,this.children=i}modify(t,n,i,o,u,a){if(o===this.hash){const d=Wc(this,t),g=this.updateCollisionList(d,t,this.hash,this.children,i,u,a);return g===this.children?this:g.length>1?new Xl(t,this.hash,g):g[0]}const f=i(te());return yt(f)?this:(++a.value,Vm(t,n,this.hash,this,o,new ti(t,o,u,f)))}updateCollisionList(t,n,i,o,u,a,f){const d=o.length;for(let b=0;b<d;++b){const v=o[b];if("key"in v&&fe(a,v.key)){const O=v.value,T=u(O);return T===O?o:yt(T)?(--f.value,Hm(t,b,o)):Ji(t,b,new ti(n,i,a,T),o)}}const g=u(te());return yt(g)?o:(++f.value,Ji(t,d,new ti(n,i,a,g),o))}}class Gi{constructor(t,n,i){p(this,"edit");p(this,"mask");p(this,"children");p(this,"_tag","IndexedNode");this.edit=t,this.mask=n,this.children=i}modify(t,n,i,o,u,a){const f=this.mask,d=this.children,g=Wi(n,o),b=qi(g),v=Gm(f,b),O=f&b,T=Wc(this,t);if(!O){const z=new xr().modify(t,n+ei,i,o,u,a);return z?d.length>=CI?KI(t,g,z,f,d):new Gi(t,f|b,LI(T,v,z,d)):this}const R=d[v],W=R.modify(t,n+ei,i,o,u,a);if(R===W)return this;let F=f,L;if(Rn(W)){if(F&=~b,!F)return new xr;if(d.length<=2&&DI(d[v^1]))return d[v^1];L=Hm(T,v,d)}else L=Ji(T,v,W,d);return T?(this.mask=F,this.children=L,this):new Gi(t,F,L)}}class Zl{constructor(t,n,i){p(this,"edit");p(this,"size");p(this,"children");p(this,"_tag","ArrayNode");this.edit=t,this.size=n,this.children=i}modify(t,n,i,o,u,a){let f=this.size;const d=this.children,g=Wi(n,o),b=d[g],v=(b||new xr).modify(t,n+ei,i,o,u,a);if(b===v)return this;const O=Wc(this,t);let T;if(Rn(b)&&!Rn(v))++f,T=Ji(O,g,v,d);else if(!Rn(b)&&Rn(v)){if(--f,f<=PI)return UI(t,f,g,d);T=Ji(O,g,new xr,d)}else T=Ji(O,g,v,d);return O?(this.size=f,this.children=T,this):new Zl(t,f,T)}}function UI(e,t,n,i){const o=new Array(t-1);let u=0,a=0;for(let f=0,d=i.length;f<d;++f)if(f!==n){const g=i[f];g&&!Rn(g)&&(o[u++]=g,a|=1<<f)}return new Gi(e,a,o)}function KI(e,t,n,i,o){const u=[];let a=i,f=0;for(let d=0;a;++d)a&1&&(u[d]=o[f++]),a>>>=1;return u[t]=n,new Zl(e,f+1,u)}function BI(e,t,n,i,o,u){if(n===o)return new Xl(e,n,[u,i]);const a=Wi(t,n),f=Wi(t,o);if(a===f)return d=>new Gi(e,qi(a)|qi(f),[d]);{const d=a<f?[i,u]:[u,i];return new Gi(e,qi(a)|qi(f),d)}}function Vm(e,t,n,i,o,u){let a,f=t;for(;;){const d=BI(e,f,n,i,o,u);if(typeof d=="function")a=NI(d,a),f=f+ei;else{let g=d;for(;a!=null;)g=a.value(g),a=a.previous;return g}}}const zm="effect/HashMap",Ql=Symbol.for(zm),jI={[Ql]:Ql,[Symbol.iterator](){return new qc(this,(e,t)=>[e,t])},[de](){let e=X(zm);for(const t of this)e^=C(X(t[0]),Se(X(t[1])));return Je(this,e)},[le](e){if(JI(e)){if(e._size!==this._size)return!1;for(const t of this){const n=C(e,tf(t[0],X(t[0])));if(yt(n))return!1;if(!fe(t[1],n.value))return!1}return!0}return!1},toString(){return ft(this.toJSON())},toJSON(){return{_id:"HashMap",values:Array.from(this).map(it)}},[Be](){return this.toJSON()},pipe(){return re(this,arguments)}},ef=(e,t,n,i)=>{const o=Object.create(jI);return o._editable=e,o._edit=t,o._root=n,o._size=i,o};class qc{constructor(t,n){p(this,"map");p(this,"f");p(this,"v");this.map=t,this.f=n,this.v=Ym(this.map._root,this.f,void 0)}next(){if(yt(this.v))return{done:!0,value:void 0};const t=this.v.value;return this.v=Jc(t.cont),{done:!1,value:t.value}}[Symbol.iterator](){return new qc(this.map,this.f)}}const Jc=e=>e?Xm(e[0],e[1],e[2],e[3],e[4]):te(),Ym=(e,t,n=void 0)=>{switch(e._tag){case"LeafNode":return wt(e.value)?be({value:t(e.key,e.value.value),cont:n}):Jc(n);case"CollisionNode":case"ArrayNode":case"IndexedNode":{const i=e.children;return Xm(i.length,i,0,t,n)}default:return Jc(n)}},Xm=(e,t,n,i,o)=>{for(;n<e;){const u=t[n++];if(u&&!Rn(u))return Ym(u,i,[e,t,n,i,o])}return Jc(o)},WI=ef(!1,0,new xr,0),Gc=()=>WI,qI=e=>{const t=Qm(Gc());for(const n of e)no(t,n[0],n[1]);return YI(t)},JI=e=>ue(e,Ql),GI=e=>e&&Rn(e._root),HI=I(2,(e,t)=>tf(e,t,X(t))),tf=I(3,(e,t,n)=>{let i=e._root,o=0;for(;;)switch(i._tag){case"LeafNode":return fe(t,i.key)?i.value:te();case"CollisionNode":{if(n===i.hash){const u=i.children;for(let a=0,f=u.length;a<f;++a){const d=u[a];if("key"in d&&fe(t,d.key))return d.value}}return te()}case"IndexedNode":{const u=Wi(o,n),a=qi(u);if(i.mask&a){i=i.children[Gm(i.mask,a)],o+=ei;break}return te()}case"ArrayNode":{if(i=i.children[Wi(o,n)],i){o+=ei;break}return te()}default:return te()}}),VI=I(2,(e,t)=>wt(tf(e,t,X(t)))),no=I(3,(e,t,n)=>rf(e,t,()=>be(n))),zI=I(3,(e,t,n)=>e._editable?(e._root=t,e._size=n,e):t===e._root?e:ef(e._editable,e._edit,t,n)),Zm=e=>new qc(e,t=>t),nf=e=>e._size,Qm=e=>ef(!0,e._edit+1,e._root,e._size),YI=e=>(e._editable=!1,e),rf=I(3,(e,t,n)=>XI(e,t,X(t),n)),XI=I(4,(e,t,n,i)=>{const o={value:e._size},u=e._root.modify(e._editable?e._edit:NaN,0,i,n,t,o);return C(e,zI(u,o.value))}),ey=I(2,(e,t)=>rf(e,t,te)),ZI=I(2,(e,t)=>Hc(e,Gc(),(n,i,o)=>no(n,o,t(i,o)))),QI=I(2,(e,t)=>Hc(e,void 0,(n,i,o)=>t(i,o))),Hc=I(3,(e,t,n)=>{const i=e._root;if(i._tag==="LeafNode")return wt(i.value)?n(t,i.value.value,i.key):t;if(i._tag==="EmptyNode")return t;const o=[i.children];let u;for(;u=o.pop();)for(let a=0,f=u.length;a<f;){const d=u[a++];d&&!Rn(d)&&(d._tag==="LeafNode"?wt(d.value)&&(t=n(t,d.value.value,d.key)):o.push(d.children))}return t}),ty="effect/HashSet",sf=Symbol.for(ty),eA={[sf]:sf,[Symbol.iterator](){return Zm(this._keyMap)},[de](){return Je(this,Se(X(this._keyMap))(X(ty)))},[le](e){return tA(e)?nf(this._keyMap)===nf(e._keyMap)&&fe(this._keyMap,e._keyMap):!1},toString(){return ft(this.toJSON())},toJSON(){return{_id:"HashSet",values:Array.from(this).map(it)}},[Be](){return this.toJSON()},pipe(){return re(this,arguments)}},Vc=e=>{const t=Object.create(eA);return t._keyMap=e,t},tA=e=>ue(e,sf),nA=Vc(Gc()),zc=()=>nA,rA=e=>{const t=of(zc());for(const n of e)ro(t,n);return cf(t)},iA=(...e)=>{const t=of(zc());for(const n of e)ro(t,n);return cf(t)},sA=I(2,(e,t)=>VI(e._keyMap,t)),oA=e=>nf(e._keyMap),of=e=>Vc(Qm(e._keyMap)),cf=e=>(e._keyMap._editable=!1,e),ny=I(2,(e,t)=>{const n=of(e);return t(n),cf(n)}),ro=I(2,(e,t)=>e._keyMap._editable?(no(t,!0)(e._keyMap),e):Vc(no(t,!0)(e._keyMap))),ry=I(2,(e,t)=>e._keyMap._editable?(ey(t)(e._keyMap),e):Vc(ey(t)(e._keyMap))),cA=I(2,(e,t)=>ny(e,n=>{for(const i of t)ry(n,i)})),uA=I(2,(e,t)=>ny(zc(),n=>{aA(e,i=>ro(n,i));for(const i of t)ro(n,i)})),aA=I(2,(e,t)=>QI(e._keyMap,(n,i)=>t(i))),lA=I(3,(e,t,n)=>Hc(e._keyMap,t,(i,o,u)=>n(i,u))),ni=zc,fA=rA,uf=iA,hA=sA,iy=oA,io=ro,sy=ry,oy=cA,so=uA,Yc=lA,cy=Symbol.for("effect/MutableRef"),dA={[cy]:cy,toString(){return ft(this.toJSON())},toJSON(){return{_id:"MutableRef",current:it(this.current)}},[Be](){return this.toJSON()},pipe(){return re(this,arguments)}},uy=e=>{const t=Object.create(dA);return t.current=e,t},Xc=e=>e.current,ay=I(2,(e,t)=>(e.current=t,e)),af="effect/FiberId",oo=Symbol.for(af),Zc="None",lf="Runtime",pA="Composite",gA=Qe(`${af}-${Zc}`);let mA=class{constructor(){p(this,k0,oo);p(this,"_tag",Zc);p(this,"id",-1);p(this,"startTimeMillis",-1)}[(k0=oo,de)](){return gA}[le](t){return ly(t)&&t._tag===Zc}toString(){return ft(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag}}[Be](){return this.toJSON()}};class yA{constructor(t,n){p(this,"id");p(this,"startTimeMillis");p(this,$0,oo);p(this,"_tag",lf);this.id=t,this.startTimeMillis=n}[($0=oo,de)](){return Je(this,Qe(`${af}-${this._tag}-${this.id}-${this.startTimeMillis}`))}[le](t){return ly(t)&&t._tag===lf&&this.id===t.id&&this.startTimeMillis===t.startTimeMillis}toString(){return ft(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag,id:this.id,startTimeMillis:this.startTimeMillis}}[Be](){return this.toJSON()}}const _A=new mA,ly=e=>ue(e,oo),ff=e=>{switch(e._tag){case Zc:return ni();case lf:return uf(e.id);case pA:return C(ff(e.left),so(ff(e.right)))}},fy=Ee(Symbol.for("effect/Fiber/Id/_fiberCounter"),()=>uy(0)),hy=e=>Array.from(ff(e)).map(n=>`#${n}`).join(","),bA=()=>{const e=Xc(fy);return C(fy,ay(e+1)),new yA(e,Date.now())},Hi=_A,vA=hy,dy=bA,hf=Gc,SA=qI,wA=GI,py=HI,gy=no,my=Zm,EA=rf,OA=ZI,yy=Hc,co=Symbol.for("effect/List"),df=e=>et(e),TA=(e=>$E($l(e),df))(fe),IA={[co]:co,_tag:"Cons",toString(){return ft(this.toJSON())},toJSON(){return{_id:"List",_tag:"Cons",values:df(this).map(it)}},[Be](){return this.toJSON()},[le](e){return by(e)&&this._tag===e._tag&&TA(this,e)},[de](){return Je(this,Js(df(this)))},[Symbol.iterator](){let e=!1,t=this;return{next(){if(e)return this.return();if(t._tag==="Nil")return e=!0,this.return();const n=t.head;return t=t.tail,{done:e,value:n}},return(n){return e||(e=!0),{done:!0,value:n}}}},pipe(){return re(this,arguments)}},Qc=(e,t)=>{const n=Object.create(IA);return n.head=e,n.tail=t,n},AA=Qe("Nil"),RA={[co]:co,_tag:"Nil",toString(){return ft(this.toJSON())},toJSON(){return{_id:"List",_tag:"Nil"}},[Be](){return this.toJSON()},[de](){return AA},[le](e){return by(e)&&this._tag===e._tag},[Symbol.iterator](){return{next(){return{done:!0,value:void 0}}}},pipe(){return re(this,arguments)}},_y=Object.create(RA),by=e=>ue(e,co),cr=e=>e._tag==="Nil",xA=e=>e._tag==="Cons",kA=()=>_y,ri=(e,t)=>Qc(e,t),Vi=kA,pf=e=>Qc(e,_y),$A=I(2,(e,t)=>CA(t,e)),MA=I(2,(e,t)=>ri(t,e)),CA=I(2,(e,t)=>{if(cr(e))return t;if(cr(t))return e;{const n=Qc(t.head,e);let i=n,o=t.tail;for(;!cr(o);){const u=Qc(o.head,e);i.tail=u,i=u,o=o.tail}return n}}),PA=I(3,(e,t,n)=>{let i=t,o=e;for(;!cr(o);)i=n(i,o.head),o=o.tail;return i}),FA=e=>{let t=Vi(),n=e;for(;!cr(n);)t=MA(t,n.head),n=n.tail;return t},gf=function(){function e(t){t&&Object.assign(this,t)}return e.prototype=Al,e}(),NA=Symbol.for("effect/DifferContextPatch");function vy(e){return e}const uo={...gf.prototype,[NA]:{_Value:vy,_Patch:vy}},LA=Object.create(Object.assign(Object.create(uo),{_tag:"Empty"})),Sy=()=>LA,DA=Object.assign(Object.create(uo),{_tag:"AndThen"}),UA=(e,t)=>{const n=Object.create(DA);return n.first=e,n.second=t,n},KA=Object.assign(Object.create(uo),{_tag:"AddService"}),BA=(e,t)=>{const n=Object.create(KA);return n.key=e,n.service=t,n},jA=Object.assign(Object.create(uo),{_tag:"RemoveService"}),WA=e=>{const t=Object.create(jA);return t.key=e,t},qA=Object.assign(Object.create(uo),{_tag:"UpdateService"}),JA=(e,t)=>{const n=Object.create(qA);return n.key=e,n.update=t,n},GA=(e,t)=>{const n=new Map(e.unsafeMap);let i=Sy();for(const[o,u]of t.unsafeMap.entries())if(n.has(o)){const a=n.get(o);n.delete(o),fe(a,u)||(i=eu(JA(o,()=>u))(i))}else n.delete(o),i=eu(BA(o,u))(i);for(const[o]of n.entries())i=eu(WA(o))(i);return i},eu=I(2,(e,t)=>UA(e,t)),HA=I(2,(e,t)=>{if(e._tag==="Empty")return t;let n=!1,i=Vt(e);const o=new Map(t.unsafeMap);for(;Bi(i);){const a=ji(i),f=Qr(i);switch(a._tag){case"Empty":{i=f;break}case"AddService":{o.set(a.key,a.service),i=f;break}case"AndThen":{i=In(In(f,a.second),a.first);break}case"RemoveService":{o.delete(a.key),i=f;break}case"UpdateService":{o.set(a.key,a.update(o.get(a.key))),n=!0,i=f;break}}}if(!n)return Di(o);const u=new Map;for(const[a]of t.unsafeMap)o.has(a)&&(u.set(a,o.get(a)),o.delete(a));for(const[a,f]of o)u.set(a,f);return Di(u)}),VA=Symbol.for("effect/DifferHashSetPatch");function mf(e){return e}const tu={...gf.prototype,[VA]:{_Value:mf,_Key:mf,_Patch:mf}},zA=Object.create(Object.assign(Object.create(tu),{_tag:"Empty"})),wy=()=>zA,YA=Object.assign(Object.create(tu),{_tag:"AndThen"}),XA=(e,t)=>{const n=Object.create(YA);return n.first=e,n.second=t,n},ZA=Object.assign(Object.create(tu),{_tag:"Add"}),QA=e=>{const t=Object.create(ZA);return t.value=e,t},eR=Object.assign(Object.create(tu),{_tag:"Remove"}),tR=e=>{const t=Object.create(eR);return t.value=e,t},nR=(e,t)=>{const[n,i]=Yc([e,wy()],([o,u],a)=>hA(a)(o)?[sy(a)(o),u]:[o,yf(QA(a))(u)])(t);return Yc(i,(o,u)=>yf(tR(u))(o))(n)},yf=I(2,(e,t)=>XA(e,t)),rR=I(2,(e,t)=>{if(e._tag==="Empty")return t;let n=t,i=Vt(e);for(;Bi(i);){const o=ji(i),u=Qr(i);switch(o._tag){case"Empty":{i=u;break}case"AndThen":{i=In(o.first)(In(o.second)(u));break}case"Add":{n=io(o.value)(n),i=u;break}case"Remove":n=sy(o.value)(n),i=u}}return n}),iR=Symbol.for("effect/DifferReadonlyArrayPatch");function Ey(e){return e}const ao={...gf.prototype,[iR]:{_Value:Ey,_Patch:Ey}},sR=Object.create(Object.assign(Object.create(ao),{_tag:"Empty"})),Oy=()=>sR,oR=Object.assign(Object.create(ao),{_tag:"AndThen"}),cR=(e,t)=>{const n=Object.create(oR);return n.first=e,n.second=t,n},uR=Object.assign(Object.create(ao),{_tag:"Append"}),aR=e=>{const t=Object.create(uR);return t.values=e,t},lR=Object.assign(Object.create(ao),{_tag:"Slice"}),fR=(e,t)=>{const n=Object.create(lR);return n.from=e,n.until=t,n},hR=Object.assign(Object.create(ao),{_tag:"Update"}),dR=(e,t)=>{const n=Object.create(hR);return n.index=e,n.patch=t,n},pR=e=>{let t=0,n=Oy();for(;t<e.oldValue.length&&t<e.newValue.length;){const i=e.oldValue[t],o=e.newValue[t],u=e.differ.diff(i,o);fe(u,e.differ.empty)||(n=nu(n,dR(t,u))),t=t+1}return t<e.oldValue.length&&(n=nu(n,fR(0,t))),t<e.newValue.length&&(n=nu(n,aR(DO(t)(e.newValue)))),n},nu=I(2,(e,t)=>cR(e,t)),gR=I(3,(e,t,n)=>{if(e._tag==="Empty")return t;let i=t.slice(),o=Tn(e);for(;Cc(o);){const u=Nt(o),a=Hr(o);switch(u._tag){case"Empty":{o=a;break}case"AndThen":{a.unshift(u.first,u.second),o=a;break}case"Append":{for(const f of u.values)i.push(f);o=a;break}case"Slice":{i=i.slice(u.from,u.until),o=a;break}case"Update":{i[u.index]=n.patch(u.patch,i[u.index]),o=a;break}}}return i}),mR={[Symbol.for("effect/Differ")]:{_P:Ze,_V:Ze},pipe(){return re(this,arguments)}},zi=e=>{const t=Object.create(mR);return t.empty=e.empty,t.diff=e.diff,t.combine=e.combine,t.patch=e.patch,t},yR=()=>zi({empty:Sy(),combine:(e,t)=>eu(t)(e),diff:(e,t)=>GA(e,t),patch:(e,t)=>HA(t)(e)}),_R=()=>zi({empty:wy(),combine:(e,t)=>yf(t)(e),diff:(e,t)=>nR(e,t),patch:(e,t)=>rR(t)(e)}),bR=e=>zi({empty:Oy(),combine:(t,n)=>nu(t,n),diff:(t,n)=>pR({oldValue:t,newValue:n,differ:e}),patch:(t,n)=>gR(t,n,e)}),Ty=()=>vR((e,t)=>t),vR=e=>zi({empty:Ze,combine:(t,n)=>t===Ze?n:n===Ze?t:i=>n(t(i)),diff:(t,n)=>fe(t,n)?Ze:gc(n),patch:(t,n)=>e(n,t(n))}),lo=255,Iy=8,_f=e=>e&lo,bf=e=>e>>Iy&lo,fo=(e,t)=>(e&lo)+((t&e&lo)<<Iy),SR=fo(0,0),wR=e=>fo(e,e),ER=e=>fo(e,0),OR=I(2,(e,t)=>fo(_f(e)&~t,bf(e))),TR=I(2,(e,t)=>e|t),IR=e=>~e>>>0&lo,AR=0,Yi=1,RR=2,Ay=4,vf=16,Ry=32,xR=e=>ru(e,Ry),kR=I(2,(e,t)=>e|t),kr=e=>xy(e)&&!MR(e),xy=e=>ru(e,Yi),ru=I(2,(e,t)=>(e&t)!==0),ky=(...e)=>e.reduce((t,n)=>t|n,0),$R=ky(AR),$y=e=>ru(e,Ay),MR=e=>ru(e,vf),iu=I(2,(e,t)=>fo(e^t,t)),su=I(2,(e,t)=>e&(IR(_f(t))|bf(t))|_f(t)&bf(t)),My=zi({empty:SR,diff:(e,t)=>iu(e,t),combine:(e,t)=>TR(t)(e),patch:(e,t)=>su(t,e)}),CR=wR,Cy=ER,Py=OR,Fy=(e,t)=>({_tag:"Par",left:e,right:t}),ou=(e,t)=>({_tag:"Seq",left:e,right:t}),PR=e=>{let t=pf(e),n=Vi();for(;;){const[i,o]=PA(t,[Ny(),Vi()],([u,a],f)=>{const[d,g]=FR(f);return[KR(u,d),$A(a,g)]});if(n=NR(n,i),cr(o))return FA(n);t=o}throw new Error("BUG: BlockedRequests.flatten - please report an issue at https://github.com/Effect-TS/effect/issues")},FR=e=>{let t=e,n=Ny(),i=Vi(),o=Vi();for(;;)switch(t._tag){case"Empty":{if(cr(i))return[n,o];t=i.head,i=i.tail;break}case"Par":{i=ri(t.right,i),t=t.left;break}case"Seq":{const u=t.left,a=t.right;switch(u._tag){case"Empty":{t=a;break}case"Par":{const f=u.left,d=u.right;t=Fy(ou(f,a),ou(d,a));break}case"Seq":{const f=u.left,d=u.right;t=ou(f,ou(d,a));break}case"Single":{t=u,o=ri(a,o);break}}break}case"Single":{if(n=UR(n,t),cr(i))return[n,o];t=i.head,i=i.tail;break}}throw new Error("BUG: BlockedRequests.step - please report an issue at https://github.com/Effect-TS/effect/issues")},NR=(e,t)=>{if(cr(e))return pf(wf(t));if(BR(t))return e;const n=HR(e.head),i=jR(t);return n.length===1&&i.length===1&&fe(n[0],i[0])?ri(GR(e.head,wf(t)),e.tail):ri(wf(t),e)},LR=Symbol.for("effect/RequestBlock/RequestBlockParallel"),DR={_R:e=>e};M0=LR;class Sf{constructor(t){p(this,"map");p(this,M0,DR);this.map=t}}const Ny=()=>new Sf(hf()),UR=(e,t)=>new Sf(EA(e.map,t.dataSource,n=>SO(Tg(n,fI(t.blockedRequest)),()=>Vt(t.blockedRequest)))),KR=(e,t)=>new Sf(yy(e.map,t.map,(n,i,o)=>gy(n,o,Ht(py(n,o),{onNone:()=>i,onSome:u=>An(i,u)})))),BR=e=>wA(e.map),jR=e=>Array.from(my(e.map)),wf=e=>JR(OA(e.map,t=>Vt(t))),WR=Symbol.for("effect/RequestBlock/RequestBlockSequential"),qR={_R:e=>e};C0=WR;class Ly{constructor(t){p(this,"map");p(this,C0,qR);this.map=t}}const JR=e=>new Ly(e),GR=(e,t)=>new Ly(yy(t.map,e.map,(n,i,o)=>gy(n,o,Ht(py(n,o),{onNone:()=>sr(),onSome:u=>An(u,i)})))),HR=e=>Array.from(my(e.map)),VR=e=>Array.from(e.map),ho="Die",ii="Empty",si="Fail",Xi="Interrupt",Zi="Parallel",Qi="Sequential",Dy="effect/Cause",Uy=Symbol.for(Dy),zR={_E:e=>e},es={[Uy]:zR,[de](){return C(X(Dy),Se(X(ax(this))),Je(this))},[le](e){return YR(e)&&ux(this,e)},pipe(){return re(this,arguments)},toJSON(){switch(this._tag){case"Empty":return{_id:"Cause",_tag:this._tag};case"Die":return{_id:"Cause",_tag:this._tag,defect:it(this.defect)};case"Interrupt":return{_id:"Cause",_tag:this._tag,fiberId:this.fiberId.toJSON()};case"Fail":return{_id:"Cause",_tag:this._tag,failure:it(this.error)};case"Sequential":case"Parallel":return{_id:"Cause",_tag:this._tag,left:it(this.left),right:it(this.right)}}},toString(){return ns(this)},[Be](){return this.toJSON()}},po=(()=>{const e=Object.create(es);return e._tag=ii,e})(),cu=e=>{const t=Object.create(es);return t._tag=si,t.error=e,t},Vn=e=>{const t=Object.create(es);return t._tag=ho,t.defect=e,t},$r=e=>{const t=Object.create(es);return t._tag=Xi,t.fiberId=e,t},uu=(e,t)=>{const n=Object.create(es);return n._tag=Zi,n.left=e,n.right=t,n},un=(e,t)=>{const n=Object.create(es);return n._tag=Qi,n.left=e,n.right=t,n},YR=e=>ue(e,Uy),XR=e=>e._tag===ii,ZR=e=>e._tag===si,QR=e=>e._tag===ii?!0:ts(e,!0,(t,n)=>{switch(n._tag){case ii:return be(t);case ho:case si:case Xi:return be(!1);default:return te()}}),ex=e=>wt(ox(e)),Ef=e=>Tf(void 0,fx)(e),tx=e=>Ui(ts(e,sr(),(t,n)=>n._tag===si?be(C(t,In(n.error))):te())),nx=e=>Ui(ts(e,sr(),(t,n)=>n._tag===ho?be(C(t,In(n.defect))):te())),rx=e=>ts(e,ni(),(t,n)=>n._tag===Xi?be(C(t,io(n.fiberId))):te()),ix=e=>By(e,t=>t._tag===si?be(t.error):te()),sx=e=>{const t=ix(e);switch(t._tag){case"None":return Oe(e);case"Some":return ge(t.value)}},ox=e=>By(e,t=>t._tag===Xi?be(t.fiberId):te()),Ky=e=>qy(e,{onEmpty:po,onFail:()=>po,onDie:Vn,onInterrupt:$r,onSequential:un,onParallel:uu}),cx=e=>qy(e,{onEmpty:po,onFail:Vn,onDie:Vn,onInterrupt:$r,onSequential:un,onParallel:uu}),ux=(e,t)=>{let n=Vt(e),i=Vt(t);for(;Bi(n)&&Bi(i);){const[o,u]=C(ji(n),ts([ni(),sr()],([d,g],b)=>{const[v,O]=Of(b);return be([C(d,so(v)),C(g,An(O))])})),[a,f]=C(ji(i),ts([ni(),sr()],([d,g],b)=>{const[v,O]=Of(b);return be([C(d,so(v)),C(g,An(O))])}));if(!fe(o,a))return!1;n=u,i=f}return!0},ax=e=>lx(Vt(e),sr()),lx=(e,t)=>{for(;;){const[n,i]=C(e,Cg([ni(),sr()],([u,a],f)=>{const[d,g]=Of(f);return[C(u,so(d)),C(a,An(g))]})),o=iy(n)>0?C(t,In(n)):t;if(hI(i))return Ui(o);e=i,t=o}throw new Error(bc("Cause.flattenCauseLoop"))},By=I(2,(e,t)=>{const n=[e];for(;n.length>0;){const i=n.pop(),o=t(i);switch(o._tag){case"None":{switch(i._tag){case Qi:case Zi:{n.push(i.right),n.push(i.left);break}}break}case"Some":return o}}return te()}),Of=e=>{let t=e;const n=[];let i=ni(),o=sr();for(;t!==void 0;)switch(t._tag){case ii:{if(n.length===0)return[i,o];t=n.pop();break}case si:{if(i=io(i,jl(t._tag,t.error)),n.length===0)return[i,o];t=n.pop();break}case ho:{if(i=io(i,jl(t._tag,t.defect)),n.length===0)return[i,o];t=n.pop();break}case Xi:{if(i=io(i,jl(t._tag,t.fiberId)),n.length===0)return[i,o];t=n.pop();break}case Qi:{switch(t.left._tag){case ii:{t=t.right;break}case Qi:{t=un(t.left.left,un(t.left.right,t.right));break}case Zi:{t=uu(un(t.left.left,t.right),un(t.left.right,t.right));break}default:{o=In(o,t.right),t=t.left;break}}break}case Zi:{n.push(t.right),t=t.left;break}}throw new Error(bc("Cause.evaluateCauseLoop"))},fx={emptyCase:eg,failCase:pl,dieCase:pl,interruptCase:eg,sequentialCase:(e,t,n)=>t&&n,parallelCase:(e,t,n)=>t&&n},jy="SequentialCase",Wy="ParallelCase",qy=I(2,(e,{onDie:t,onEmpty:n,onFail:i,onInterrupt:o,onParallel:u,onSequential:a})=>Tf(e,void 0,{emptyCase:()=>n,failCase:(f,d)=>i(d),dieCase:(f,d)=>t(d),interruptCase:(f,d)=>o(d),sequentialCase:(f,d,g)=>a(d,g),parallelCase:(f,d,g)=>u(d,g)})),ts=I(3,(e,t,n)=>{let i=t,o=e;const u=[];for(;o!==void 0;){const a=n(i,o);switch(i=wt(a)?a.value:i,o._tag){case Qi:{u.push(o.right),o=o.left;break}case Zi:{u.push(o.right),o=o.left;break}default:{o=void 0;break}}o===void 0&&u.length>0&&(o=u.pop())}return i}),Tf=I(3,(e,t,n)=>{const i=[e],o=[];for(;i.length>0;){const a=i.pop();switch(a._tag){case ii:{o.push(Oe(n.emptyCase(t)));break}case si:{o.push(Oe(n.failCase(t,a.error)));break}case ho:{o.push(Oe(n.dieCase(t,a.defect)));break}case Xi:{o.push(Oe(n.interruptCase(t,a.fiberId)));break}case Qi:{i.push(a.right),i.push(a.left),o.push(ge({_tag:jy}));break}case Zi:{i.push(a.right),i.push(a.left),o.push(ge({_tag:Wy}));break}}}const u=[];for(;o.length>0;){const a=o.pop();switch(a._tag){case"Left":{switch(a.left._tag){case jy:{const f=u.pop(),d=u.pop(),g=n.sequentialCase(t,f,d);u.push(g);break}case Wy:{const f=u.pop(),d=u.pop(),g=n.parallelCase(t,f,d);u.push(g);break}}break}case"Right":{u.push(a.right);break}}}if(u.length===0)throw new Error("BUG: Cause.reduceWithContext - please report an issue at https://github.com/Effect-TS/effect/issues");return u.pop()}),ns=(e,t)=>Ef(e)?"All fibers interrupted without errors.":Gy(e).map(function(n){return(t==null?void 0:t.renderErrorCause)!==!0||n.cause===void 0?n.stack:`${n.stack} {
${Jy(n.cause,"  ")}
}`}).join(`
`),Jy=(e,t)=>{const n=e.stack.split(`
`);let i=`${t}[cause]: ${n[0]}`;for(let o=1,u=n.length;o<u;o++)i+=`
${t}${n[o]}`;return e.cause&&(i+=` {
${Jy(e.cause,`${t}  `)}
${t}}`),i};class au extends globalThis.Error{constructor(n){const i=typeof n=="object"&&n!==null,o=Error.stackTraceLimit;Error.stackTraceLimit=1;super(hx(n),i&&"cause"in n&&typeof n.cause<"u"?{cause:new au(n.cause)}:void 0);p(this,"span");this.message===""&&(this.message="An error has occurred"),Error.stackTraceLimit=o,this.name=n instanceof Error?n.name:"Error",i&&(rs in n&&(this.span=n[rs]),Object.keys(n).forEach(u=>{u in this||(this[u]=n[u])})),this.stack=gx(`${this.name}: ${this.message}`,n instanceof Error&&n.stack?n.stack:"",this.span)}}const hx=e=>{if(typeof e=="string")return e;if(typeof e=="object"&&e!==null&&e instanceof Error)return e.message;try{if(ue(e,"toString")&&Ws(e.toString)&&e.toString!==Object.prototype.toString&&e.toString!==globalThis.Array.prototype.toString)return e.toString()}catch{}return cg(e)},dx=/\((.*)\)/g,px=Ee("effect/Tracer/spanToTrace",()=>new WeakMap),gx=(e,t,n)=>{const i=[e],o=t.startsWith(e)?t.slice(e.length).split(`
`):t.split(`
`);for(let u=1;u<o.length&&!o[u].includes("Generator.next");u++){if(o[u].includes("effect_internal_function")){i.pop();break}i.push(o[u].replace(/at .*effect_instruction_i.*\((.*)\)/,"at $1").replace(/EffectPrimitive\.\w+/,"<anonymous>"))}if(n){let u=n,a=0;for(;u&&u._tag==="Span"&&a<10;){const f=px.get(u);if(typeof f=="function"){const d=f();if(typeof d=="string"){const g=d.matchAll(dx);let b=!1;for(const[,v]of g)b=!0,i.push(`    at ${u.name} (${v})`);b||i.push(`    at ${u.name} (${d.replace(/^at /,"")})`)}else i.push(`    at ${u.name}`)}else i.push(`    at ${u.name}`);u=jn(u.parent),a++}}return i.join(`
`)},rs=Symbol.for("effect/SpanAnnotation"),Gy=e=>Tf(e,void 0,{emptyCase:()=>[],dieCase:(t,n)=>[new au(n)],failCase:(t,n)=>[new au(n)],interruptCase:()=>[],parallelCase:(t,n,i)=>[...n,...i],sequentialCase:(t,n,i)=>[...n,...i]}),lu="Pending",Hy="Done",mx=Symbol.for("effect/Deferred"),yx={_E:e=>e,_A:e=>e},_x=e=>({_tag:lu,joiners:e}),bx=e=>({_tag:Hy,effect:e});class go{constructor(t){p(this,"self");p(this,"called",!1);this.self=t}next(t){return this.called?{value:t,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(t){return{value:t,done:!0}}throw(t){throw t}[Symbol.iterator](){return new go(this.self)}}const Vy=(e,t)=>{const n=new bt("Blocked");return n.effect_instruction_i0=e,n.effect_instruction_i1=t,n},vx=e=>{const t=new bt("RunBlocked");return t.effect_instruction_i0=e,t},is=Symbol.for("effect/Effect");class Sx{constructor(t,n){p(this,"patch");p(this,"op");p(this,"_op",Il);this.patch=t,this.op=n}}class bt{constructor(t){p(this,"_op");p(this,"effect_instruction_i0");p(this,"effect_instruction_i1");p(this,"effect_instruction_i2");p(this,"trace");p(this,P0,xi);this._op=t}[(P0=is,le)](t){return this===t}[de](){return Je(this,Sl(this))}pipe(){return re(this,arguments)}toJSON(){return{_id:"Effect",_op:this._op,effect_instruction_i0:it(this.effect_instruction_i0),effect_instruction_i1:it(this.effect_instruction_i1),effect_instruction_i2:it(this.effect_instruction_i2)}}toString(){return ft(this.toJSON())}[Be](){return this.toJSON()}[Symbol.iterator](){return new go(new qs(this))}}class zy{constructor(t){p(this,"_op");p(this,"effect_instruction_i0");p(this,"effect_instruction_i1");p(this,"effect_instruction_i2");p(this,"trace");p(this,F0,xi);this._op=t,this._tag=t}[(F0=is,le)](t){return Lf(t)&&t._op==="Failure"&&fe(this.effect_instruction_i0,t.effect_instruction_i0)}[de](){return C(Qe(this._tag),Se(X(this.effect_instruction_i0)),Je(this))}get cause(){return this.effect_instruction_i0}pipe(){return re(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,cause:this.cause.toJSON()}}toString(){return ft(this.toJSON())}[Be](){return this.toJSON()}[Symbol.iterator](){return new go(new qs(this))}}class Yy{constructor(t){p(this,"_op");p(this,"effect_instruction_i0");p(this,"effect_instruction_i1");p(this,"effect_instruction_i2");p(this,"trace");p(this,N0,xi);this._op=t,this._tag=t}[(N0=is,le)](t){return Lf(t)&&t._op==="Success"&&fe(this.effect_instruction_i0,t.effect_instruction_i0)}[de](){return C(Qe(this._tag),Se(X(this.effect_instruction_i0)),Je(this))}get value(){return this.effect_instruction_i0}pipe(){return re(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,value:it(this.value)}}toString(){return ft(this.toJSON())}[Be](){return this.toJSON()}[Symbol.iterator](){return new go(new qs(this))}}const fu=e=>ue(e,is),zt=e=>{const t=new bt(lg);return t.effect_instruction_i0=e,t},wx=I(3,(e,t,n)=>mu(i=>se(e,o=>se(t_(ot(()=>i(t(o)))),u=>ot(()=>n(o,u)).pipe(ss({onFailure:a=>{switch(u._tag){case En:return xn(un(u.effect_instruction_i0,a));case On:return xn(a)}},onSuccess:()=>u})))))),mo=I(2,(e,t)=>se(e,()=>je(t))),yo=e=>mo(e,void 0),Xy=function(){const e=new bt(Ec);switch(arguments.length){case 2:{e.effect_instruction_i0=arguments[0],e.commit=arguments[1];break}case 3:{e.effect_instruction_i0=arguments[0],e.effect_instruction_i1=arguments[1],e.commit=arguments[2];break}case 4:{e.effect_instruction_i0=arguments[0],e.effect_instruction_i1=arguments[1],e.effect_instruction_i2=arguments[2],e.commit=arguments[3];break}default:throw new Error(bc("you're not supposed to end up here"))}return e},hu=(e,t=Hi)=>{const n=new bt(Gs);let i;return n.effect_instruction_i0=o=>{i=e(o)},n.effect_instruction_i1=t,c_(n,o=>fu(i)?i:kn)},Ex=(e,t=Hi)=>ot(()=>hu(e,t)),_o=(e,t=Hi)=>Xy(e,function(){let n,i;function o(d){n?n(d):i===void 0&&(i=d)}const u=new bt(Gs);u.effect_instruction_i0=d=>{n=d,i&&d(i)},u.effect_instruction_i1=t;let a,f;return this.effect_instruction_i0.length!==1?(f=new AbortController,a=kt(()=>this.effect_instruction_i0(o,f.signal))):a=kt(()=>this.effect_instruction_i0(o)),a||f?c_(u,d=>(f&&f.abort(),a??kn)):u}),If=I(2,(e,t)=>Rf(e,{onFailure:t,onSuccess:je})),Zy=Symbol.for("effect/OriginalAnnotation"),Af=(e,t)=>wt(t)?new Proxy(e,{has(n,i){return i===rs||i===Zy||i in n},get(n,i){return i===rs?t.value:i===Zy?e:n[i]}}):e,Qy=e=>Ir(e)&&!(rs in e)?zt(t=>xn(Vn(Af(e,Uf(t))))):xn(Vn(e)),e_=e=>Ox(()=>Vn(new Qx(e))),du=e=>Rf(e,{onFailure:t=>je(ge(t)),onSuccess:t=>je(Oe(t))}),t_=e=>Ax(e,{onFailure:Le,onSuccess:tt}),Dt=e=>Ir(e)&&!(rs in e)?zt(t=>xn(cu(Af(e,Uf(t))))):xn(cu(e)),n_=e=>se(ce(e),Dt),xn=e=>{const t=new zy(En);return t.effect_instruction_i0=e,t},Ox=e=>se(ce(e),xn),Tx=zt(e=>je(e.id())),r_=e=>zt(t=>e(t.id())),se=I(2,(e,t)=>{const n=new bt(Oc);return n.effect_instruction_i0=e,n.effect_instruction_i1=t,n}),Ix=e=>{const t=new bt("OnStep");return t.effect_instruction_i0=e,t},i_=e=>se(e,Ze),Ax=I(2,(e,t)=>ss(e,{onFailure:n=>je(t.onFailure(n)),onSuccess:n=>je(t.onSuccess(n))})),ss=I(2,(e,t)=>{const n=new bt(Tc);return n.effect_instruction_i0=e,n.effect_instruction_i1=t.onFailure,n.effect_instruction_i2=t.onSuccess,n}),Rf=I(2,(e,t)=>ss(e,{onFailure:n=>{if(nx(n).length>0)return xn(cx(n));const o=tx(n);return o.length>0?t.onFailure(Lm(o)):xn(n)},onSuccess:t.onSuccess})),Mr=I(2,(e,t)=>ot(()=>{const n=et(e),i=$c(n.length);let o=0;return mo(kf({while:()=>o<n.length,body:()=>t(n[o],o),step:u=>{i[o++]=u}}),i)})),pu=I(2,(e,t)=>ot(()=>{const n=et(e);let i=0;return kf({while:()=>i<n.length,body:()=>t(n[i],i),step:()=>{i++}})})),s_=e=>{const t=new bt(Hs);return t.effect_instruction_i0=CR(Yi),t.effect_instruction_i1=()=>e,t},Ut=I(2,(e,t)=>se(e,n=>ce(()=>t(n)))),o_=I(2,(e,t)=>Rf(e,{onFailure:n=>n_(()=>t.onFailure(n)),onSuccess:n=>ce(()=>t.onSuccess(n))})),gu=I(2,(e,t)=>ss(e,{onFailure:n=>{const i=sx(n);switch(i._tag){case"Left":return n_(()=>t(i.left));case"Right":return xn(i.right)}},onSuccess:je})),xf=I(2,(e,t)=>mu(n=>ss(n(e),{onFailure:i=>{const o=Le(i);return ss(t(o),{onFailure:u=>Le(un(i,u)),onSuccess:()=>o})},onSuccess:i=>{const o=tt(i);return yu(t(o),o)}}))),c_=I(2,(e,t)=>xf(e,O_({onFailure:n=>Ef(n)?yo(t(rx(n))):kn,onSuccess:()=>kn}))),je=e=>{const t=new Yy(On);return t.effect_instruction_i0=e,t},ot=e=>{const t=new bt(Ec);return t.commit=e,t},ce=e=>{const t=new bt(ag);return t.effect_instruction_i0=e,t},Rx=I(e=>e.length===3||e.length===2&&!(Ir(e[1])&&"onlyEffect"in e[1]),(e,t)=>se(e,n=>{const i=typeof t=="function"?t(n):t;return fu(i)?mo(i,n):UE(i)?hu(o=>{i.then(u=>o(je(n)),u=>o(Dt(new nk(u,"An unknown error occurred in Effect.tap"))))}):je(n)})),xx=e=>zt(t=>{const n=t.getFiberRef(Ff),i=C(n,ht(()=>t.scope()));return e(_u(Ff,be(i)))}),u_=e=>{const t=new bt(Hs);return t.effect_instruction_i0=Cy(Yi),t.effect_instruction_i1=()=>e,t},mu=e=>Xy(e,function(){const t=new bt(Hs);return t.effect_instruction_i0=Cy(Yi),t.effect_instruction_i1=n=>xy(n)?kt(()=>this.effect_instruction_i0(s_)):kt(()=>this.effect_instruction_i0(u_)),t}),kn=je(void 0),kx=e=>{const t=new bt(Hs);return t.effect_instruction_i0=e,t.effect_instruction_i1=void 0,t},kf=e=>{const t=new bt(Ic);return t.effect_instruction_i0=e.while,t.effect_instruction_i1=e.body,t.effect_instruction_i2=e.step,t},$f=e=>{const t=new bt(Rc);return typeof(e==null?void 0:e.priority)<"u"?Hx(t,e.priority):t},a_=I(2,(e,t)=>se(e,n=>Ut(t,i=>[n,i]))),l_=I(2,(e,t)=>se(e,n=>mo(t,n))),yu=I(2,(e,t)=>se(e,()=>t)),$x=e=>se(Tx,t=>C(e,f_(t))),f_=I(2,(e,t)=>se(e.interruptAsFork(t),()=>e.await)),Mx={_tag:"All",syslog:0,label:"ALL",ordinal:Number.MIN_SAFE_INTEGER,pipe(){return re(this,arguments)}},Cx={_tag:"Fatal",syslog:2,label:"FATAL",ordinal:5e4,pipe(){return re(this,arguments)}},Px={_tag:"Error",syslog:3,label:"ERROR",ordinal:4e4,pipe(){return re(this,arguments)}},Fx={_tag:"Warning",syslog:4,label:"WARN",ordinal:3e4,pipe(){return re(this,arguments)}},h_={_tag:"Info",syslog:6,label:"INFO",ordinal:2e4,pipe(){return re(this,arguments)}},d_={_tag:"Debug",syslog:7,label:"DEBUG",ordinal:1e4,pipe(){return re(this,arguments)}},Nx={_tag:"Trace",syslog:7,label:"TRACE",ordinal:0,pipe(){return re(this,arguments)}},Lx={_tag:"None",syslog:7,label:"OFF",ordinal:Number.MAX_SAFE_INTEGER,pipe(){return re(this,arguments)}},Dx=Symbol.for("effect/FiberRef"),Ux={_A:e=>e},Mf=e=>zt(t=>tt(t.getFiberRef(e))),Cf=I(2,(e,t)=>se(Mf(e),t)),p_=I(2,(e,t)=>Kx(e,()=>[void 0,t])),Kx=I(2,(e,t)=>zt(n=>{const[i,o]=t(n.getFiberRef(e));return n.setFiberRef(e,o),je(i)})),_u=I(3,(e,t,n)=>wx(l_(Mf(t),p_(t,n)),()=>e,i=>p_(t,i))),Yt=(e,t)=>os(e,{differ:Ty(),fork:(t==null?void 0:t.fork)??Ze,join:t==null?void 0:t.join}),Bx=e=>{const t=_R();return os(e,{differ:t,fork:t.empty})},jx=e=>{const t=bR(Ty());return os(e,{differ:t,fork:t.empty})},g_=e=>{const t=yR();return os(e,{differ:t,fork:t.empty})},os=(e,t)=>({...zs,[Dx]:Ux,initial:e,commit(){return Mf(this)},diff:(i,o)=>t.differ.diff(i,o),combine:(i,o)=>t.differ.combine(i,o),patch:i=>o=>t.differ.patch(i,o),fork:t.fork,join:t.join??((i,o)=>o)}),Wx=e=>os(e,{differ:My,fork:My.empty}),bo=Ee(Symbol.for("effect/FiberRef/currentContext"),()=>g_(Bl())),bu=Ee(Symbol.for("effect/FiberRef/currentSchedulingPriority"),()=>Yt(0)),m_=Ee(Symbol.for("effect/FiberRef/currentMaxOpsBeforeYield"),()=>Yt(2048)),qx=Ee(Symbol.for("effect/FiberRef/currentLogAnnotation"),()=>Yt(hf())),Jx=Ee(Symbol.for("effect/FiberRef/currentLogLevel"),()=>Yt(h_)),Gx=Ee(Symbol.for("effect/FiberRef/currentLogSpan"),()=>Yt(Vi())),Hx=I(2,(e,t)=>_u(e,bu,t)),Vx=Ee(Symbol.for("effect/FiberRef/currentConcurrency"),()=>Yt("unbounded")),zx=Ee(Symbol.for("effect/FiberRef/currentRequestBatching"),()=>Yt(!0)),Yx=Ee(Symbol.for("effect/FiberRef/currentUnhandledErrorLogLevel"),()=>Yt(be(d_))),Pf=Ee(Symbol.for("effect/FiberRef/currentMetricLabels"),()=>jx(ki())),Ff=Ee(Symbol.for("effect/FiberRef/currentForkScopeOverride"),()=>Yt(te(),{fork:()=>te(),join:(e,t)=>e})),vu=Ee(Symbol.for("effect/FiberRef/currentInterruptedCause"),()=>Yt(po,{fork:()=>po,join:(e,t)=>e})),Xx=(e,t)=>e.addFinalizer(()=>yo(t)),Zx=(e,t)=>e.close(t),Su=(e,t)=>e.fork(t),Nf=function(){class e extends globalThis.Error{commit(){return Dt(this)}toJSON(){const n={...this};return this.message&&(n.message=this.message),this.cause&&(n.cause=this.cause),n}[Be](){return this.toString!==globalThis.Error.prototype.toString?this.stack?`${this.toString()}
${this.stack.split(`
`).slice(1).join(`
`)}`:this.toString():"Bun"in globalThis?ns(cu(this),{renderErrorCause:!0}):this}}return Object.assign(e.prototype,oO),e}(),y_=(e,t)=>{class n extends Nf{constructor(){super(...arguments);p(this,"_tag",t)}}return Object.assign(n.prototype,e),n.prototype.name=t,n},__=Symbol.for("effect/Cause/errors/RuntimeException"),Qx=y_({[__]:__},"RuntimeException"),ek=Symbol.for("effect/Cause/errors/InterruptedException"),tk=e=>ue(e,ek),b_=Symbol.for("effect/Cause/errors/NoSuchElement"),v_=y_({[b_]:b_},"NoSuchElementException"),S_=Symbol.for("effect/Cause/errors/UnknownException"),nk=function(){class e extends Nf{constructor(i,o){super(o??"An unknown error occurred",{cause:i});p(this,"_tag","UnknownException");p(this,"error");this.error=i}}return Object.assign(e.prototype,{[S_]:S_,name:"UnknownException"}),e}(),Lf=e=>fu(e)&&"_tag"in e&&(e._tag==="Success"||e._tag==="Failure"),rk=e=>e._tag==="Success",w_=(e,t)=>ck(e,t!=null&&t.parallel?uu:un),ik=e=>Le(Vn(e)),E_=e=>Le(cu(e)),Le=e=>{const t=new zy(En);return t.effect_instruction_i0=e,t},sk=e=>Le($r(e)),Df=I(2,(e,t)=>{switch(e._tag){case En:return Le(e.effect_instruction_i0);case On:return tt(t(e.effect_instruction_i0))}}),O_=I(2,(e,{onFailure:t,onSuccess:n})=>{switch(e._tag){case En:return t(e.effect_instruction_i0);case On:return n(e.effect_instruction_i0)}}),tt=e=>{const t=new Yy(On);return t.effect_instruction_i0=e,t},oi=tt(void 0),ok=I(3,(e,t,{onFailure:n,onSuccess:i})=>{switch(e._tag){case En:switch(t._tag){case On:return Le(e.effect_instruction_i0);case En:return Le(n(e.effect_instruction_i0,t.effect_instruction_i0))}case On:switch(t._tag){case On:return tt(i(e.effect_instruction_i0,t.effect_instruction_i0));case En:return Le(t.effect_instruction_i0)}}}),ck=(e,t)=>{const n=Nm(e);return Bi(n)?C(Qr(n),Cg(C(ji(n),Df(Vt)),(i,o)=>C(i,ok(o,{onSuccess:(u,a)=>C(u,In(a)),onFailure:t}))),Df(Ui),Df(i=>Zr(i)),be):te()},uk=e=>({...zs,[mx]:yx,state:uy(_x([])),commit(){return T_(this)},blockingOn:e}),T_=e=>Ex(t=>{const n=Xc(e.state);switch(n._tag){case Hy:return t(n.effect);case lu:return n.joiners.push(t),ak(e,t)}},e.blockingOn),I_=(e,t)=>{const n=Xc(e.state);if(n._tag===lu){ay(e.state,bx(t));for(let i=0,o=n.joiners.length;i<o;i++)n.joiners[i](t)}},ak=(e,t)=>ce(()=>{const n=Xc(e.state);if(n._tag===lu){const i=n.joiners.indexOf(t);i>=0&&n.joiners.splice(i,1)}}),lk=zt(e=>tt(e.currentContext)),fk=()=>lk,vo=e=>se(fk(),e),hk=I(2,(e,t)=>_u(bo,t)(e)),dk=I(2,(e,t)=>vo(n=>hk(e,t(n)))),Uf=e=>{const t=e.currentSpan;return t!==void 0&&t._tag==="Span"?be(t):te()},pk=rk,A_=Symbol.for("effect/MutableHashMap"),gk={[A_]:A_,[Symbol.iterator](){return new Kf(this)},toString(){return ft(this.toJSON())},toJSON(){return{_id:"MutableHashMap",values:Array.from(this).map(it)}},[Be](){return this.toJSON()},pipe(){return re(this,arguments)}};class Kf{constructor(t){p(this,"self");p(this,"referentialIterator");p(this,"bucketIterator");this.self=t,this.referentialIterator=t.referential[Symbol.iterator]()}next(){if(this.bucketIterator!==void 0)return this.bucketIterator.next();const t=this.referentialIterator.next();return t.done?(this.bucketIterator=new mk(this.self.buckets.values()),this.next()):t}[Symbol.iterator](){return new Kf(this.self)}}class mk{constructor(t){p(this,"backing");p(this,"currentBucket");this.backing=t}next(){if(this.currentBucket===void 0){const n=this.backing.next();if(n.done)return n;this.currentBucket=n.value[Symbol.iterator]()}const t=this.currentBucket.next();return t.done?(this.currentBucket=void 0,this.next()):t}}const yk=()=>{const e=Object.create(gk);return e.referential=new Map,e.buckets=new Map,e.bucketsSize=0,e},ci=I(2,(e,t)=>{if(wc(t)===!1)return e.referential.has(t)?be(e.referential.get(t)):te();const n=t[de](),i=e.buckets.get(n);return i===void 0?te():_k(e,i,t)}),_k=(e,t,n,i=!1)=>{for(let o=0,u=t.length;o<u;o++)if(n[le](t[o][0])){const a=t[o][1];return i&&(t.splice(o,1),e.bucketsSize--),be(a)}return te()},So=I(2,(e,t)=>wt(ci(e,t))),wo=I(3,(e,t,n)=>{if(wc(t)===!1)return e.referential.set(t,n),e;const i=t[de](),o=e.buckets.get(i);return o===void 0?(e.buckets.set(i,[[t,n]]),e.bucketsSize++,e):(bk(e,o,t),o.push([t,n]),e.bucketsSize++,e)}),bk=(e,t,n)=>{for(let i=0,o=t.length;i<o;i++)if(n[le](t[i][0])){t.splice(i,1),e.bucketsSize--;return}};function vk(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var R_={exports:{}},Ve=R_.exports={},zn,Yn;function Bf(){throw new Error("setTimeout has not been defined")}function jf(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?zn=setTimeout:zn=Bf}catch{zn=Bf}try{typeof clearTimeout=="function"?Yn=clearTimeout:Yn=jf}catch{Yn=jf}})();function x_(e){if(zn===setTimeout)return setTimeout(e,0);if((zn===Bf||!zn)&&setTimeout)return zn=setTimeout,setTimeout(e,0);try{return zn(e,0)}catch{try{return zn.call(null,e,0)}catch{return zn.call(this,e,0)}}}function Sk(e){if(Yn===clearTimeout)return clearTimeout(e);if((Yn===jf||!Yn)&&clearTimeout)return Yn=clearTimeout,clearTimeout(e);try{return Yn(e)}catch{try{return Yn.call(null,e)}catch{return Yn.call(this,e)}}}var ur=[],cs=!1,ui,wu=-1;function wk(){!cs||!ui||(cs=!1,ui.length?ur=ui.concat(ur):wu=-1,ur.length&&k_())}function k_(){if(!cs){var e=x_(wk);cs=!0;for(var t=ur.length;t;){for(ui=ur,ur=[];++wu<t;)ui&&ui[wu].run();wu=-1,t=ur.length}ui=null,cs=!1,Sk(e)}}Ve.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];ur.push(new $_(e,t)),ur.length===1&&!cs&&x_(k_)};function $_(e,t){this.fun=e,this.array=t}$_.prototype.run=function(){this.fun.apply(null,this.array)},Ve.title="browser",Ve.browser=!0,Ve.env={},Ve.argv=[],Ve.version="",Ve.versions={};function ar(){}Ve.on=ar,Ve.addListener=ar,Ve.once=ar,Ve.off=ar,Ve.removeListener=ar,Ve.removeAllListeners=ar,Ve.emit=ar,Ve.prependListener=ar,Ve.prependOnceListener=ar,Ve.listeners=function(e){return[]},Ve.binding=function(e){throw new Error("process.binding is not supported")},Ve.cwd=function(){return"/"},Ve.chdir=function(e){throw new Error("process.chdir is not supported")},Ve.umask=function(){return 0};var Ek=R_.exports;const $n=vk(Ek),M_=Symbol.for("effect/Clock"),Wf=Xr("effect/Clock"),Ok=2**31-1,C_={unsafeSchedule(e,t){const n=zl(t);if(n>Ok)return pl;let i=!1;const o=setTimeout(()=>{i=!0,e()},n);return()=>(clearTimeout(o),!i)}},P_=function(){const e=BigInt(1e6);if(typeof performance>"u")return()=>BigInt(Date.now())*e;if(typeof performance.timeOrigin=="number"&&performance.timeOrigin===0)return()=>BigInt(Math.round(performance.now()*1e6));const t=BigInt(Date.now())*e-BigInt(Math.round(performance.now()*1e6));return()=>t+BigInt(Math.round(performance.now()*1e6))}(),Tk=function(){const e=typeof $n=="object"&&"hrtime"in $n&&typeof $n.hrtime.bigint=="function"?$n.hrtime:void 0;if(!e)return P_;const t=P_()-e.bigint();return()=>t+e.bigint()}();L0=M_;class Ik{constructor(){p(this,L0,M_);p(this,"currentTimeMillis",ce(()=>this.unsafeCurrentTimeMillis()));p(this,"currentTimeNanos",ce(()=>this.unsafeCurrentTimeNanos()))}unsafeCurrentTimeMillis(){return Date.now()}unsafeCurrentTimeNanos(){return Tk()}scheduler(){return je(C_)}sleep(t){return _o(n=>{const i=C_.unsafeSchedule(()=>n(kn),t);return yo(ce(i))})}}const Ak=()=>new Ik,F_="And",N_="Or",L_="InvalidData",D_="MissingData",U_="SourceUnavailable",K_="Unsupported",B_=Symbol.for("effect/ConfigError"),us={_tag:"ConfigError",[B_]:B_},j_=(e,t)=>{const n=Object.create(us);return n._op=F_,n.left=e,n.right=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`${this.left} and ${this.right}`}}),n},W_=(e,t)=>{const n=Object.create(us);return n._op=N_,n.left=e,n.right=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`${this.left} or ${this.right}`}}),n},Rk=(e,t,n={pathDelim:"."})=>{const i=Object.create(us);return i._op=L_,i.path=e,i.message=t,Object.defineProperty(i,"toString",{enumerable:!1,value(){return`(Invalid data at ${C(this.path,Mi(n.pathDelim))}: "${this.message}")`}}),i},ai=(e,t,n={pathDelim:"."})=>{const i=Object.create(us);return i._op=D_,i.path=e,i.message=t,Object.defineProperty(i,"toString",{enumerable:!1,value(){return`(Missing data at ${C(this.path,Mi(n.pathDelim))}: "${this.message}")`}}),i},xk=(e,t,n,i={pathDelim:"."})=>{const o=Object.create(us);return o._op=U_,o.path=e,o.message=t,o.cause=n,Object.defineProperty(o,"toString",{enumerable:!1,value(){return`(Source unavailable at ${C(this.path,Mi(i.pathDelim))}: "${this.message}")`}}),o},kk=(e,t,n={pathDelim:"."})=>{const i=Object.create(us);return i._op=K_,i.path=e,i.message=t,Object.defineProperty(i,"toString",{enumerable:!1,value(){return`(Unsupported operation at ${C(this.path,Mi(n.pathDelim))}: "${this.message}")`}}),i},li=I(2,(e,t)=>{switch(e._op){case F_:return j_(li(e.left,t),li(e.right,t));case N_:return W_(li(e.left,t),li(e.right,t));case L_:return Rk([...t,...e.path],e.message);case D_:return ai([...t,...e.path],e.message);case U_:return xk([...t,...e.path],e.message,e.cause);case K_:return kk([...t,...e.path],e.message)}}),$k={_tag:"Empty"},qf=I(2,(e,t)=>{let n=pf(t),i=e;for(;xA(n);){const o=n.head;switch(o._tag){case"Empty":{n=n.tail;break}case"AndThen":{n=ri(o.first,ri(o.second,n.tail));break}case"MapName":{i=$i(i,o.f),n=n.tail;break}case"Nested":{i=Mc(i,o.name),n=n.tail;break}case"Unnested":{if(C(Ys(i),OO(o.name)))i=Hr(i),n=n.tail;else return ge(ai(i,`Expected ${o.name} to be in path in ConfigProvider#unnested`));break}}}return Oe(i)}),Mk="Constant",Ck="Fail",Pk="Fallback",Fk="Described",Nk="Lazy",Lk="MapOrFail",Dk="Nested",Uk="Primitive",Kk="Sequence",Bk="HashMap",jk="ZipWith";var q_={};const Eu=(e,t)=>[...e,...t],J_=Symbol.for("effect/ConfigProvider"),Wk=Xr("effect/ConfigProvider"),G_=Symbol.for("effect/ConfigProviderFlat"),qk=e=>({[J_]:J_,pipe(){return re(this,arguments)},...e}),Jk=e=>({[G_]:G_,patch:e.patch,load:(t,n,i=!0)=>e.load(t,n,i),enumerateChildren:e.enumerateChildren}),Gk=e=>qk({load:t=>se(an(e,ki(),t,!1),n=>Ht(Ys(n),{onNone:()=>Dt(ai(ki(),`Expected a single value having structure: ${t}`)),onSome:je})),flattened:e}),Hk=e=>{const{pathDelim:t,seqDelim:n}=Object.assign({},{pathDelim:"_",seqDelim:","},e),i=d=>C(d,Mi(t)),o=d=>d.split(t),u=()=>typeof $n<"u"&&"env"in $n&&typeof q_=="object"?q_:{};return Gk(Jk({load:(d,g,b=!0)=>{const v=i(d),O=u(),T=v in O?be(O[v]):te();return C(T,gu(()=>ai(d,`Expected ${v} to exist in the process context`)),se(R=>Zk(R,d,g,n,b)))},enumerateChildren:d=>ce(()=>{const g=u(),O=Object.keys(g).map(T=>o(T.toUpperCase())).filter(T=>{for(let R=0;R<d.length;R++){const W=C(d,Rg(R)),F=T[R];if(F===void 0||W!==F)return!1}return!0}).flatMap(T=>T.slice(d.length,d.length+1));return fA(O)}),patch:$k}))},Vk=(e,t,n,i)=>{const o=Pg(n.length,d=>d>=i.length?te():be([e(d),d+1])),u=Pg(i.length,d=>d>=n.length?te():be([t(d),d+1])),a=Eu(n,o),f=Eu(i,u);return[a,f]},zk=(e,t)=>{let n=t;if(n._tag==="Nested"){const i=e.slice();for(;n._tag==="Nested";)i.push(n.name),n=n.config;return i}return e},an=(e,t,n,i)=>{const o=n;switch(o._tag){case Mk:return je(Tn(o.value));case Fk:return ot(()=>an(e,t,o.config,i));case Ck:return Dt(ai(t,o.message));case Pk:return C(ot(()=>an(e,t,o.first,i)),If(u=>o.condition(u)?C(an(e,t,o.second,i),If(a=>Dt(W_(u,a)))):Dt(u)));case Nk:return ot(()=>an(e,t,o.config(),i));case Lk:return ot(()=>C(an(e,t,o.original,i),se(Mr(u=>C(o.mapOrFail(u),gu(li(zk(t,o.original))))))));case Dk:return ot(()=>an(e,Eu(t,Tn(o.name)),o.config,i));case Uk:return C(qf(t,e.patch),se(u=>C(e.load(u,o,i),se(a=>{if(a.length===0){const f=C(FO(u),ht(()=>"<n/a>"));return Dt(ai([],`Expected ${o.description} with name ${f}`))}return je(a)}))));case Kk:return C(qf(t,e.patch),se(u=>C(e.enumerateChildren(u),se(e$),se(a=>a.length===0?ot(()=>Ut(an(e,t,o.config,!0),Tn)):C(Mr(a,f=>an(e,kO(t,`[${f}]`),o.config,!0)),Ut(f=>{const d=qO(f);return d.length===0?Tn(ki()):Tn(d)}))))));case Bk:return ot(()=>C(qf(t,e.patch),se(u=>C(e.enumerateChildren(u),se(a=>C(a,Mr(f=>an(e,Eu(u,Tn(f)),o.valueConfig,i)),Ut(f=>f.length===0?Tn(hf()):C(Qk(f),$i(d=>SA($g(et(a),d)))))))))));case jk:return ot(()=>C(an(e,t,o.left,i),du,se(u=>C(an(e,t,o.right,i),du,se(a=>{if(mt(u)&&mt(a))return Dt(j_(u.left,a.left));if(mt(u)&&rr(a))return Dt(u.left);if(rr(u)&&mt(a))return Dt(a.left);if(rr(u)&&rr(a)){const f=C(t,Mi(".")),d=Yk(t,f),[g,b]=Vk(d,d,C(u.right,$i(Oe)),C(a.right,$i(Oe)));return C(g,$g(b),Mr(([v,O])=>C(a_(v,O),Ut(([T,R])=>o.zip(T,R)))))}throw new Error("BUG: ConfigProvider.fromFlatLoop - please report an issue at https://github.com/Effect-TS/effect/issues")})))))}},Yk=(e,t)=>n=>ge(ai(e,`The element at index ${n} in a sequence at path "${t}" was missing`)),Xk=(e,t)=>e.split(new RegExp(`\\s*${Fc(t)}\\s*`)),Zk=(e,t,n,i,o)=>o?C(Xk(e,i),Mr(u=>n.parse(u.trim())),gu(li(t))):C(n.parse(e),o_({onFailure:li(t),onSuccess:Tn})),Qk=e=>Object.keys(e[0]).map(t=>e.map(n=>n[t])),e$=e=>C(Mr(e,n$),o_({onFailure:()=>ki(),onSuccess:Xs(Pi)}),du,Ut(yO)),t$=/^(\[(\d+)\])$/,n$=e=>{const t=e.match(t$);if(t!==null){const n=t[2];return C(n!==void 0&&n.length>0?be(n):te(),kc(r$))}return te()},r$=e=>{const t=Number.parseInt(e);return Number.isNaN(t)?te():be(t)},H_=Symbol.for("effect/Console"),V_=Xr("effect/Console"),i$={[H_]:H_,assert(e,...t){return ce(()=>{console.assert(e,...t)})},clear:ce(()=>{console.clear()}),count(e){return ce(()=>{console.count(e)})},countReset(e){return ce(()=>{console.countReset(e)})},debug(...e){return ce(()=>{console.debug(...e)})},dir(e,t){return ce(()=>{console.dir(e,t)})},dirxml(...e){return ce(()=>{console.dirxml(...e)})},error(...e){return ce(()=>{console.error(...e)})},group(e){return e!=null&&e.collapsed?ce(()=>console.groupCollapsed(e==null?void 0:e.label)):ce(()=>console.group(e==null?void 0:e.label))},groupEnd:ce(()=>{console.groupEnd()}),info(...e){return ce(()=>{console.info(...e)})},log(...e){return ce(()=>{console.log(...e)})},table(e,t){return ce(()=>{console.table(e,t)})},time(e){return ce(()=>console.time(e))},timeEnd(e){return ce(()=>console.timeEnd(e))},timeLog(e,...t){return ce(()=>{console.timeLog(e,...t)})},trace(...e){return ce(()=>{console.trace(...e)})},warn(...e){return ce(()=>{console.warn(...e)})},unsafe:console},z_=Symbol.for("effect/Random"),s$=Xr("effect/Random");D0=z_;class o${constructor(t){p(this,"seed");p(this,D0,z_);p(this,"PRNG");this.seed=t,this.PRNG=new GE(t)}get next(){return ce(()=>this.PRNG.number())}get nextBoolean(){return Ut(this.next,t=>t>.5)}get nextInt(){return ce(()=>this.PRNG.integer(Number.MAX_SAFE_INTEGER))}nextRange(t,n){return Ut(this.next,i=>(n-t)*i+t)}nextIntBetween(t,n){return ce(()=>this.PRNG.integer(n-t)+t)}shuffle(t){return c$(t,n=>this.nextIntBetween(0,n))}}const c$=(e,t)=>ot(()=>C(ce(()=>Array.from(e)),se(n=>{const i=[];for(let o=n.length;o>=2;o=o-1)i.push(o);return C(i,pu(o=>C(t(o),Ut(u=>u$(n,o-1,u)))),mo(Nm(n)))}))),u$=(e,t,n)=>{const i=e[t];return e[t]=e[n],e[n]=i,e},a$=e=>new o$(X(e)),Y_=Symbol.for("effect/Tracer"),l$=e=>({[Y_]:Y_,...e}),X_=Xr("effect/Tracer"),Z_=Xr("effect/ParentSpan"),Q_=function(){const e="abcdef0123456789",t=e.length;return function(n){let i="";for(let o=0;o<n;o++)i+=e.charAt(Math.floor(Math.random()*t));return i}}();class f${constructor(t,n,i,o,u,a){p(this,"name");p(this,"parent");p(this,"context");p(this,"links");p(this,"startTime");p(this,"kind");p(this,"_tag","Span");p(this,"spanId");p(this,"traceId","native");p(this,"sampled",!0);p(this,"status");p(this,"attributes");p(this,"events",[]);this.name=t,this.parent=n,this.context=i,this.links=o,this.startTime=u,this.kind=a,this.status={_tag:"Started",startTime:u},this.attributes=new Map,this.traceId=n._tag==="Some"?n.value.traceId:Q_(32),this.spanId=Q_(16)}end(t,n){this.status={_tag:"Ended",endTime:t,exit:n,startTime:this.status.startTime}}attribute(t,n){this.attributes.set(t,n)}event(t,n,i){this.events.push([t,n,i??{}])}}const h$=C(Bl(),eo(Wf,Ak()),eo(V_,i$),eo(s$,a$(Math.random())),eo(Wk,Hk()),eo(X_,l$({span:(e,t,n,i,o,u)=>new f$(e,t,n,i,o,u),context:e=>e()}))),Ou=Ee(Symbol.for("effect/DefaultServices/currentServices"),()=>g_(h$));function d$(e){return new Cr(e)}function p$(){return d$(new Map)}const eb=Symbol.for("effect/FiberRefs");U0=eb;class Cr{constructor(t){p(this,"locals");p(this,U0,eb);this.locals=t}pipe(){return re(this,arguments)}}const g$=(e,t,n,i=!1)=>{const o=e;let u=t,a=n,f=i,d;for(;d===void 0;)if(_t(u)&&_t(a)){const g=Nt(u)[0],b=Hr(u),v=Nt(a)[0],O=Nt(a)[1],T=Hr(a);g.startTimeMillis<v.startTimeMillis?(a=T,f=!0):g.startTimeMillis>v.startTimeMillis?u=b:g.id<v.id?(a=T,f=!0):g.id>v.id?u=b:d=[O,f]}else d=[o.initial,!0];return d},m$=I(3,(e,t,n)=>{const i=new Map(e.locals);return n.locals.forEach((o,u)=>{const a=o[0][1];if(!o[0][0][le](t)){if(!i.has(u)){if(fe(a,u.initial))return;i.set(u,[[t,u.join(u.initial,a)]]);return}const f=i.get(u),[d,g]=g$(u,f,o);if(g){const b=u.diff(d,a),v=f[0][1],O=u.join(v,u.patch(b)(v));if(!fe(v,O)){let T;const R=f[0][0];R[le](t)?T=[[R,O],...f.slice(1)]:T=[[t,O],...f],i.set(u,T)}}}}),new Cr(i)}),y$=I(2,(e,t)=>{const n=new Map;return tb(e,n,t),new Cr(n)}),tb=(e,t,n)=>{e.locals.forEach((i,o)=>{const u=i[0][1],a=o.patch(o.fork)(u);fe(u,a)?t.set(o,i):t.set(o,[[n,a],...i])})},nb=I(2,(e,t)=>{const n=new Map(e.locals);return n.delete(t),new Cr(n)}),_$=I(2,(e,t)=>e.locals.has(t)?be(Nt(e.locals.get(t))[1]):te()),Eo=I(2,(e,t)=>C(_$(e,t),ht(()=>t.initial))),Jf=I(2,(e,{fiberId:t,fiberRef:n,value:i})=>{if(e.locals.size===0)return new Cr(new Map([[n,[[t,i]]]]));const o=new Map(e.locals);return Gf(o,t,n,i),new Cr(o)}),Gf=(e,t,n,i)=>{const o=e.get(n)??[];let u;if(_t(o)){const[a,f]=Nt(o);if(a[le](t)){if(fe(f,i))return;u=[[t,i],...o.slice(1)]}else u=[[t,i],...o]}else u=[[t,i]];e.set(n,u)},b$=I(2,(e,{entries:t,forkAs:n})=>{if(e.locals.size===0)return new Cr(new Map(t));const i=new Map(e.locals);return n!==void 0&&tb(e,i,n),t.forEach(([o,u])=>{u.length===1?Gf(i,u[0][0],o,u[0][1]):u.forEach(([a,f])=>{Gf(i,a,o,f)})}),new Cr(i)}),v$=Eo,S$=b$,w$=p$,E$=Mx,O$=Cx,T$=Px,I$=Fx,A$=h_,R$=d_,x$=Nx,k$=Lx,$$=vO(C(Pi,Og(e=>e.ordinal))),M$=e=>{switch(e){case"All":return E$;case"Debug":return R$;case"Error":return T$;case"Fatal":return O$;case"Info":return A$;case"Trace":return x$;case"None":return k$;case"Warning":return I$}},rb=e=>e.replace(/[\s="]/g,"_"),C$=e=>t=>`${rb(t.label)}=${e-t.startTime}ms`,P$=Vs,F$=cO;class N$ extends F${}const ib="Empty",sb="Add",ob="Remove",cb="Update",ub="AndThen",L$={_tag:ib},D$=(e,t)=>{const n=new Map(e.locals);let i=L$;for(const[o,u]of t.locals.entries()){const a=Nt(u)[1],f=n.get(o);if(f!==void 0){const d=Nt(f)[1];fe(d,a)||(i=Hf({_tag:cb,fiberRef:o,patch:o.diff(d,a)})(i))}else i=Hf({_tag:sb,fiberRef:o,value:a})(i);n.delete(o)}for(const[o]of n.entries())i=Hf({_tag:ob,fiberRef:o})(i);return i},Hf=I(2,(e,t)=>({_tag:ub,first:e,second:t})),U$=I(3,(e,t,n)=>{let i=n,o=Tn(e);for(;_t(o);){const u=Nt(o),a=Hr(o);switch(u._tag){case ib:{o=a;break}case sb:{i=Jf(i,{fiberId:t,fiberRef:u.fiberRef,value:u.value}),o=a;break}case ob:{i=nb(i,u.fiberRef),o=a;break}case cb:{const f=Eo(i,u.fiberRef);i=Jf(i,{fiberId:t,fiberRef:u.fiberRef,value:u.fiberRef.patch(u.patch)(f)}),o=a;break}case ub:{o=Mc(u.first)(Mc(u.second)(a));break}}}return i}),ab="effect/MetricLabel",Vf=Symbol.for(ab);class K${constructor(t,n){p(this,"key");p(this,"value");p(this,K0,Vf);p(this,"_hash");this.key=t,this.value=n,this._hash=Qe(ab+this.key+this.value)}[(K0=Vf,de)](){return this._hash}[le](t){return j$(t)&&this.key===t.key&&this.value===t.value}pipe(){return re(this,arguments)}}const B$=(e,t)=>new K$(e,t),j$=e=>ue(e,Vf),W$="Sequential",q$="Parallel",J$="ParallelN",lb={_tag:W$},G$={_tag:q$},H$=e=>({_tag:J$,parallelism:e}),zf=lb,Yf=G$,Xf=H$,V$=D$,z$=U$,Tu="effect/FiberStatus",fi=Symbol.for(Tu),Iu="Done",fb="Running",hb="Suspended",Y$=Qe(`${Tu}-${Iu}`);class X${constructor(){p(this,B0,fi);p(this,"_tag",Iu)}[(B0=fi,de)](){return Y$}[le](t){return Zf(t)&&t._tag===Iu}}class Z${constructor(t){p(this,"runtimeFlags");p(this,j0,fi);p(this,"_tag",fb);this.runtimeFlags=t}[(j0=fi,de)](){return C(X(Tu),Se(X(this._tag)),Se(X(this.runtimeFlags)),Je(this))}[le](t){return Zf(t)&&t._tag===fb&&this.runtimeFlags===t.runtimeFlags}}class Q${constructor(t,n){p(this,"runtimeFlags");p(this,"blockingOn");p(this,W0,fi);p(this,"_tag",hb);this.runtimeFlags=t,this.blockingOn=n}[(W0=fi,de)](){return C(X(Tu),Se(X(this._tag)),Se(X(this.runtimeFlags)),Se(X(this.blockingOn)),Je(this))}[le](t){return Zf(t)&&t._tag===hb&&this.runtimeFlags===t.runtimeFlags&&fe(this.blockingOn,t.blockingOn)}}const eM=new X$,tM=e=>new Z$(e),nM=(e,t)=>new Q$(e,t),Zf=e=>ue(e,fi),rM=e=>e._tag===Iu,iM=eM,db=tM,sM=nM,oM=rM,cM=Symbol.for("effect/Micro"),Au=Symbol.for("effect/Micro/MicroExit"),pb=Symbol.for("effect/Micro/MicroCause"),uM={_E:Ze};class gb extends globalThis.Error{constructor(n,i,o){const u=`MicroCause.${n}`;let a,f,d;if(i instanceof globalThis.Error){a=`(${u}) ${i.name}`,f=i.message;const g=f.split(`
`).length;d=i.stack?`(${u}) ${i.stack.split(`
`).slice(0,g+3).join(`
`)}`:`${a}: ${f}`}else a=u,f=Ri(i,0),d=`${a}: ${f}`;o.length>0&&(d+=`
    ${o.join(`
    `)}`);super(f);p(this,"_tag");p(this,"traces");p(this,q0);this._tag=n,this.traces=o,this[pb]=uM,this.name=a,this.stack=d}pipe(){return re(this,arguments)}toString(){return this.stack}[(q0=pb,Be)](){return this.stack}}class aM extends gb{constructor(n,i=[]){super("Die",n,i);p(this,"defect");this.defect=n}}const lM=(e,t=[])=>new aM(e,t);class fM extends gb{constructor(t=[]){super("Interrupt","interrupted",t)}}const hM=(e=[])=>new fM(e),dM=e=>e._tag==="Interrupt",mb=Symbol.for("effect/Micro/MicroFiber"),pM={_A:Ze,_E:Ze};J0=mb;class gM{constructor(t,n=!0){p(this,"context");p(this,"interruptible");p(this,J0);p(this,"_stack",[]);p(this,"_observers",[]);p(this,"_exit");p(this,"_children");p(this,"currentOpCount",0);p(this,"_interrupted",!1);p(this,"_yielded");this.context=t,this.interruptible=n,this[mb]=pM}getRef(t){return nI(this.context,t)}addObserver(t){return this._exit?(t(this._exit),kE):(this._observers.push(t),()=>{const n=this._observers.indexOf(t);n>=0&&this._observers.splice(n,1)})}unsafeInterrupt(){this._exit||(this._interrupted=!0,this.interruptible&&this.evaluate(ih))}unsafePoll(){return this._exit}evaluate(t){if(this._exit)return;if(this._yielded!==void 0){const o=this._yielded;this._yielded=void 0,o()}const n=this.runLoop(t);if(n===xu)return;const i=yb.interruptChildren&&yb.interruptChildren(this);if(i!==void 0)return this.evaluate($u(i,()=>n));this._exit=n;for(let o=0;o<this._observers.length;o++)this._observers[o](n);this._observers.length=0}runLoop(t){let n=!1,i=t;this.currentOpCount=0;try{for(;;){if(this.currentOpCount++,!n&&this.getRef(oh).shouldYield(this)){n=!0;const o=i;i=$u(bM,()=>o)}if(i=i[Qf](this),i===xu){const o=this._yielded;return Au in o?(this._yielded=void 0,o):xu}}}catch(o){return ue(i,Qf)?sh(o):sh(`MicroFiber.runLoop: Not a valid effect: ${String(i)}`)}}getCont(t){for(;;){const n=this._stack.pop();if(!n)return;const i=n[Ru]&&n[Ru](this);if(i)return{[t]:i};if(n[t])return n}}yieldWith(t){return this._yielded=t,xu}children(){return this._children??(this._children=new Set)}}const yb=Ee("effect/Micro/fiberMiddleware",()=>({interruptChildren:void 0})),_b=Symbol.for("effect/Micro/identifier"),ct=Symbol.for("effect/Micro/args"),Qf=Symbol.for("effect/Micro/evaluate"),as=Symbol.for("effect/Micro/successCont"),ls=Symbol.for("effect/Micro/failureCont"),Ru=Symbol.for("effect/Micro/ensureCont"),xu=Symbol.for("effect/Micro/Yield"),mM={_A:Ze,_E:Ze,_R:Ze},yM={...P$,_op:"Micro",[cM]:mM,pipe(){return re(this,arguments)},[Symbol.iterator](){return new ig(new qs(this))},toJSON(){return{_id:"Micro",op:this[_b],...ct in this?{args:this[ct]}:void 0}},toString(){return ft(this)},[Be](){return ft(this)}};function _M(e){return sh("Micro.evaluate: Not implemented")}const ku=e=>({...yM,[_b]:e.op,[Qf]:e.eval??_M,[as]:e.contA,[ls]:e.contE,[Ru]:e.ensure}),eh=e=>{const t=ku(e);return function(){const n=Object.create(t);return n[ct]=e.single===!1?arguments:arguments[0],n}},bb=e=>{const t={...ku(e),[Au]:Au,_tag:e.op,get[e.prop](){return this[ct]},toJSON(){return{_id:"MicroExit",_tag:e.op,[e.prop]:this[ct]}},[le](n){return wM(n)&&n._tag===e.op&&fe(this[ct],n[ct])},[de](){return Je(this,Se(Qe(e.op))(X(this[ct])))}};return function(n){const i=Object.create(t);return i[ct]=n,i[as]=void 0,i[ls]=void 0,i[Ru]=void 0,i}},th=bb({op:"Success",prop:"value",eval(e){const t=e.getCont(as);return t?t[as](this[ct],e):e.yieldWith(this)}}),vb=bb({op:"Failure",prop:"cause",eval(e){let t=e.getCont(ls);for(;dM(this[ct])&&t&&e.interruptible;)t=e.getCont(ls);return t?t[ls](this[ct],e):e.yieldWith(this)}}),bM=eh({op:"Yield",eval(e){let t=!1;return e.getRef(oh).scheduleTask(()=>{t||e.evaluate(EM)},this[ct]??0),e.yieldWith(()=>{t=!0})}})(0),vM=th(void 0),nh=eh({op:"WithMicroFiber",eval(e){return this[ct](e)}}),$u=I(2,(e,t)=>{const n=Object.create(SM);return n[ct]=e,n[as]=t,n}),SM=ku({op:"OnSuccess",eval(e){return e._stack.push(this),this[ct]}}),wM=e=>ue(e,Au),Sb=th,rh=vb,ih=rh(hM()),sh=e=>rh(lM(e)),EM=Sb(void 0),OM="setImmediate"in globalThis?globalThis.setImmediate:e=>setTimeout(e,0);class wb{constructor(){p(this,"tasks",[]);p(this,"running",!1);p(this,"afterScheduled",()=>{this.running=!1,this.runTasks()})}scheduleTask(t,n){this.tasks.push(t),this.running||(this.running=!0,OM(this.afterScheduled))}runTasks(){const t=this.tasks;this.tasks=[];for(let n=0,i=t.length;n<i;n++)t[n]()}shouldYield(t){return t.currentOpCount>=t.getRef(AM)}flush(){for(;this.tasks.length>0;)this.runTasks()}}const TM=I(2,(e,t)=>nh(n=>{const i=n.context;return n.context=t(i),kM(e,()=>(n.context=i,vM))})),IM=I(2,(e,t)=>TM(e,$m(t)));class AM extends Mm()("effect/Micro/currentMaxOpsBeforeYield",{defaultValue:()=>2048}){}class oh extends Mm()("effect/Micro/currentScheduler",{defaultValue:()=>new wb}){}const RM=I(2,(e,t)=>{const n=Object.create(xM);return n[ct]=e,n[as]=t.onSuccess,n[ls]=t.onFailure,n}),xM=ku({op:"OnSuccessAndFailure",eval(e){return e._stack.push(this),this[ct]}}),kM=I(2,(e,t)=>MM(n=>RM(n(e),{onFailure:i=>$u(t(rh(i)),()=>vb(i)),onSuccess:i=>$u(t(Sb(i)),()=>th(i))}))),Eb=eh({op:"SetInterruptible",ensure(e){if(e.interruptible=this[ct],e._interrupted&&e.interruptible)return()=>ih}}),$M=e=>nh(t=>t.interruptible?e:(t.interruptible=!0,t._stack.push(Eb(!1)),t._interrupted?ih:e)),MM=e=>nh(t=>t.interruptible?(t.interruptible=!1,t._stack.push(Eb(!0)),e($M)):e(Ze)),CM=(e,t)=>{const n=new gM(oh.context(new wb));return n.evaluate(e),n};class Ob{constructor(){p(this,"buckets",[])}scheduleTask(t,n){const i=this.buckets.length;let o,u=0;for(;u<i&&this.buckets[u][0]<=n;u++)o=this.buckets[u];o&&o[0]===n?o[1].push(t):u===i?this.buckets.push([n,[t]]):this.buckets.splice(u,0,[n,[t]])}}class PM{constructor(t){p(this,"maxNextTickBeforeTimer");p(this,"running",!1);p(this,"tasks",new Ob);this.maxNextTickBeforeTimer=t}starveInternal(t){const n=this.tasks.buckets;this.tasks.buckets=[];for(const[i,o]of n)for(let u=0;u<o.length;u++)o[u]();this.tasks.buckets.length===0?this.running=!1:this.starve(t)}starve(t=0){t>=this.maxNextTickBeforeTimer?setTimeout(()=>this.starveInternal(0),0):Promise.resolve(void 0).then(()=>this.starveInternal(t+1))}shouldYield(t){return t.currentOpCount>t.getFiberRef(m_)?t.getFiberRef(bu):!1}scheduleTask(t,n){this.tasks.scheduleTask(t,n),this.running||(this.running=!0,this.starve())}}const Tb=Ee(Symbol.for("effect/Scheduler/defaultScheduler"),()=>new PM(2048));class Ib{constructor(){p(this,"tasks",new Ob);p(this,"deferred",!1)}scheduleTask(t,n){this.deferred?Tb.scheduleTask(t,n):this.tasks.scheduleTask(t,n)}shouldYield(t){return t.currentOpCount>t.getFiberRef(m_)?t.getFiberRef(bu):!1}flush(){for(;this.tasks.buckets.length>0;){const t=this.tasks.buckets;this.tasks.buckets=[];for(const[n,i]of t)for(let o=0;o<i.length;o++)i[o]()}this.deferred=!0}}const Ab=Ee(Symbol.for("effect/FiberRef/currentScheduler"),()=>Yt(Tb)),Rb=Ee(Symbol.for("effect/FiberRef/currentRequestMap"),()=>Yt(new Map)),xb=(e,t,n,i)=>{switch(e){case void 0:return t();case"unbounded":return n();case"inherit":return Cf(Vx,o=>o==="unbounded"?n():o>1?i(o):t());default:return e>1?i(e):t()}},ch="InterruptSignal",uh="Stateful",ah="Resume",lh="YieldNow",fh=e=>({_tag:ch,cause:e}),Mu=e=>({_tag:uh,onFiber:e}),fs=e=>({_tag:ah,effect:e}),FM=()=>({_tag:lh}),Cu=Symbol.for("effect/FiberScope");G0=Cu;class NM{constructor(){p(this,G0,Cu);p(this,"fiberId",Hi);p(this,"roots",new Set)}add(t,n){this.roots.add(n),n.addObserver(()=>{this.roots.delete(n)})}}H0=Cu;class LM{constructor(t,n){p(this,"fiberId");p(this,"parent");p(this,H0,Cu);this.fiberId=t,this.parent=n}add(t,n){this.parent.tell(Mu(i=>{i.addChild(n),n.addObserver(()=>{i.removeChild(n)})}))}}const DM=e=>new LM(e.id(),e),hh=Ee(Symbol.for("effect/FiberScope/Global"),()=>new NM),UM=Symbol.for("effect/Fiber"),KM={_E:e=>e,_A:e=>e},BM=Symbol.for("effect/Fiber"),kb=e=>l_(i_(e.await),e.inheritAll);({...zs});const hi="effect/FiberCurrent",jM=Symbol.for("effect/Logger"),WM={_Message:e=>e,_Output:e=>e},dh=e=>({[jM]:WM,log:e,pipe(){return re(this,arguments)}}),qM=/^[^\s"=]*$/,JM=dh(((e,t)=>({annotations:n,cause:i,date:o,fiberId:u,logLevel:a,message:f,spans:d})=>{const g=R=>R.match(qM)?R:e(R),b=(R,W)=>`${rb(R)}=${g(W)}`,v=(R,W)=>" "+b(R,W);let O=b("timestamp",o.toISOString());O+=v("level",a.label),O+=v("fiber",hy(u));const T=RO(f);for(let R=0;R<T.length;R++)O+=v("message",Ri(T[R],t));XR(i)||(O+=v("cause",ns(i,{renderErrorCause:!0})));for(const R of d)O+=" "+C$(o.getTime())(R);for(const[R,W]of n)O+=v(R,Ri(W,t));return O})(e=>`"${e.replace(/\\([\s\S])|(")/g,"\\$1$2")}"`));typeof $n=="object"&&$n!==null&&typeof $n.stdout=="object"&&$n.stdout!==null&&$n.stdout.isTTY;const $b="effect/MetricBoundaries",ph=Symbol.for($b);class GM{constructor(t){p(this,"values");p(this,V0,ph);p(this,"_hash");this.values=t,this._hash=C(Qe($b),Se(Js(this.values)))}[(V0=ph,de)](){return this._hash}[le](t){return HM(t)&&fe(this.values,t.values)}pipe(){return re(this,arguments)}}const HM=e=>ue(e,ph),VM=e=>{const t=C(e,Ig(Vt(Number.POSITIVE_INFINITY)),JO);return new GM(t)},zM=e=>C(AO(e.count-1,t=>e.start*Math.pow(e.factor,t)),Bc,VM),Mb=Symbol.for("effect/MetricKeyType"),Cb="effect/MetricKeyType/Counter",gh=Symbol.for(Cb),YM=Symbol.for("effect/MetricKeyType/Frequency"),XM=Symbol.for("effect/MetricKeyType/Gauge"),Pb="effect/MetricKeyType/Histogram",mh=Symbol.for(Pb),ZM=Symbol.for("effect/MetricKeyType/Summary"),Fb={_In:e=>e,_Out:e=>e};class QM{constructor(t,n){p(this,"incremental");p(this,"bigint");p(this,Y0,Fb);p(this,z0,gh);p(this,"_hash");this.incremental=t,this.bigint=n,this._hash=Qe(Cb)}[(Y0=Mb,z0=gh,de)](){return this._hash}[le](t){return Nb(t)}pipe(){return re(this,arguments)}}class eC{constructor(t){p(this,"boundaries");p(this,Z0,Fb);p(this,X0,mh);p(this,"_hash");this.boundaries=t,this._hash=C(Qe(Pb),Se(X(this.boundaries)))}[(Z0=Mb,X0=mh,de)](){return this._hash}[le](t){return Lb(t)&&fe(this.boundaries,t.boundaries)}pipe(){return re(this,arguments)}}const tC=e=>new QM((e==null?void 0:e.incremental)??!1,(e==null?void 0:e.bigint)??!1),nC=e=>new eC(e),Nb=e=>ue(e,gh),rC=e=>ue(e,YM),iC=e=>ue(e,XM),Lb=e=>ue(e,mh),sC=e=>ue(e,ZM),Db=Symbol.for("effect/MetricKey"),oC={_Type:e=>e},cC=$l(fe);class yh{constructor(t,n,i,o=[]){p(this,"name");p(this,"keyType");p(this,"description");p(this,"tags");p(this,Q0,oC);p(this,"_hash");this.name=t,this.keyType=n,this.description=i,this.tags=o,this._hash=C(Qe(this.name+this.description),Se(X(this.keyType)),Se(Js(this.tags)))}[(Q0=Db,de)](){return this._hash}[le](t){return uC(t)&&this.name===t.name&&fe(this.keyType,t.keyType)&&fe(this.description,t.description)&&cC(this.tags,t.tags)}pipe(){return re(this,arguments)}}const uC=e=>ue(e,Db),aC=(e,t)=>new yh(e,tC(t),xc(t==null?void 0:t.description)),lC=(e,t,n)=>new yh(e,nC(t),xc(n)),fC=I(2,(e,t)=>t.length===0?e:new yh(e.name,e.keyType,e.description,Pc(e.tags,t))),Oo=Symbol.for("effect/MetricState"),Ub="effect/MetricState/Counter",_h=Symbol.for(Ub),Kb="effect/MetricState/Frequency",bh=Symbol.for(Kb),Bb="effect/MetricState/Gauge",vh=Symbol.for(Bb),jb="effect/MetricState/Histogram",Sh=Symbol.for(jb),Wb="effect/MetricState/Summary",wh=Symbol.for(Wb),To={_A:e=>e};class hC{constructor(t){p(this,"count");p(this,tS,To);p(this,eS,_h);this.count=t}[(tS=Oo,eS=_h,de)](){return C(X(Ub),Se(X(this.count)),Je(this))}[le](t){return EC(t)&&this.count===t.count}pipe(){return re(this,arguments)}}const dC=$l(fe);class pC{constructor(t){p(this,"occurrences");p(this,rS,To);p(this,nS,bh);p(this,"_hash");this.occurrences=t}[(rS=Oo,nS=bh,de)](){return C(Qe(Kb),Se(Js(et(this.occurrences.entries()))),Je(this))}[le](t){return OC(t)&&dC(et(this.occurrences.entries()),et(t.occurrences.entries()))}pipe(){return re(this,arguments)}}class gC{constructor(t){p(this,"value");p(this,sS,To);p(this,iS,vh);this.value=t}[(sS=Oo,iS=vh,de)](){return C(X(Bb),Se(X(this.value)),Je(this))}[le](t){return TC(t)&&this.value===t.value}pipe(){return re(this,arguments)}}class mC{constructor(t,n,i,o,u){p(this,"buckets");p(this,"count");p(this,"min");p(this,"max");p(this,"sum");p(this,cS,To);p(this,oS,Sh);this.buckets=t,this.count=n,this.min=i,this.max=o,this.sum=u}[(cS=Oo,oS=Sh,de)](){return C(X(jb),Se(X(this.buckets)),Se(X(this.count)),Se(X(this.min)),Se(X(this.max)),Se(X(this.sum)),Je(this))}[le](t){return IC(t)&&fe(this.buckets,t.buckets)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}pipe(){return re(this,arguments)}}class yC{constructor(t,n,i,o,u,a){p(this,"error");p(this,"quantiles");p(this,"count");p(this,"min");p(this,"max");p(this,"sum");p(this,aS,To);p(this,uS,wh);this.error=t,this.quantiles=n,this.count=i,this.min=o,this.max=u,this.sum=a}[(aS=Oo,uS=wh,de)](){return C(X(Wb),Se(X(this.error)),Se(X(this.quantiles)),Se(X(this.count)),Se(X(this.min)),Se(X(this.max)),Se(X(this.sum)),Je(this))}[le](t){return AC(t)&&this.error===t.error&&fe(this.quantiles,t.quantiles)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}pipe(){return re(this,arguments)}}const _C=e=>new hC(e),bC=e=>new pC(e),vC=e=>new gC(e),SC=e=>new mC(e.buckets,e.count,e.min,e.max,e.sum),wC=e=>new yC(e.error,e.quantiles,e.count,e.min,e.max,e.sum),EC=e=>ue(e,_h),OC=e=>ue(e,bh),TC=e=>ue(e,vh),IC=e=>ue(e,Sh),AC=e=>ue(e,wh),RC=Symbol.for("effect/MetricHook"),xC={_In:e=>e,_Out:e=>e},Io=e=>({[RC]:xC,pipe(){return re(this,arguments)},...e}),qb=BigInt(0),kC=e=>{let t=e.keyType.bigint?qb:0;const n=e.keyType.incremental?e.keyType.bigint?o=>o>=qb:o=>o>=0:o=>!0,i=o=>{n(o)&&(t=t+o)};return Io({get:()=>_C(t),update:i,modify:i})},$C=e=>{const t=new Map;for(const i of e.keyType.preregisteredWords)t.set(i,0);const n=i=>{const o=t.get(i)??0;t.set(i,o+1)};return Io({get:()=>bC(t),update:n,modify:n})},MC=(e,t)=>{let n=t;return Io({get:()=>vC(n),update:i=>{n=i},modify:i=>{n=n+i}})},CC=e=>{const t=e.keyType.boundaries.values,n=t.length,i=new Uint32Array(n+1),o=new Float32Array(n);let u=0,a=0,f=Number.MAX_VALUE,d=Number.MIN_VALUE;C(t,Xs(Pi),$i((v,O)=>{o[O]=v}));const g=v=>{let O=0,T=n;for(;O!==T;){const R=Math.floor(O+(T-O)/2),W=o[R];v<=W?T=R:O=R,T===O+1&&(v<=o[O]?T=O:O=T)}i[O]=i[O]+1,u=u+1,a=a+v,v<f&&(f=v),v>d&&(d=v)},b=()=>{const v=$c(n);let O=0;for(let T=0;T<n;T++){const R=o[T],W=i[T];O=O+W,v[T]=[R,O]}return v};return Io({get:()=>SC({buckets:b(),count:u,min:f,max:d,sum:a}),update:g,modify:g})},PC=e=>{const{error:t,maxAge:n,maxSize:i,quantiles:o}=e.keyType,u=C(o,Xs(Pi)),a=$c(i);let f=0,d=0,g=0,b=Number.MAX_VALUE,v=Number.MIN_VALUE;const O=R=>{const W=[];let F=0;for(;F!==i-1;){const L=a[F];if(L!=null){const[z,B]=L,H=Vl(R-z);RI(H,qm)&&H<=n&&W.push(B)}F=F+1}return FC(t,u,Xs(W,Pi))},T=(R,W)=>{if(i>0){f=f+1;const F=f%i;a[F]=[W,R]}d=d+1,g=g+R,R<b&&(b=R),R>v&&(v=R)};return Io({get:()=>wC({error:t,quantiles:O(Date.now()),count:d,min:b,max:v,sum:g}),update:([R,W])=>T(R,W),modify:([R,W])=>T(R,W)})},FC=(e,t,n)=>{const i=n.length;if(!_t(t))return ki();const o=t[0],u=t.slice(1),a=Jb(e,i,te(),0,o,n),f=Tn(a);return u.forEach(d=>{f.push(Jb(e,i,a.value,a.consumed,d,a.rest))}),$i(f,d=>[d.quantile,d.value])},Jb=(e,t,n,i,o,u)=>{let a=e,f=t,d=n,g=i,b=o,v=u,O=e,T=t,R=n,W=i,F=o,L=u;for(;;){if(!_t(v))return{quantile:b,value:te(),consumed:g,rest:[]};if(b===1)return{quantile:b,value:be(xg(v)),consumed:g+v.length,rest:[]};const z=LO(v,k=>k<=v[0]),B=b*f,H=a/2*B,Y=g+z[0].length,G=Math.abs(Y-B);if(Y<B-H){O=a,T=f,R=Ys(v),W=Y,F=b,L=z[1],a=O,f=T,d=R,g=W,b=F,v=L;continue}if(Y>B+H)return{quantile:b,value:d,consumed:g,rest:v};switch(d._tag){case"None":{O=a,T=f,R=Ys(v),W=Y,F=b,L=z[1],a=O,f=T,d=R,g=W,b=F,v=L;continue}case"Some":{const k=Math.abs(B-d.value);if(G<k){O=a,T=f,R=Ys(v),W=Y,F=b,L=z[1],a=O,f=T,d=R,g=W,b=F,v=L;continue}return{quantile:b,value:be(d.value),consumed:g,rest:v}}}}throw new Error("BUG: MetricHook.resolveQuantiles - please report an issue at https://github.com/Effect-TS/effect/issues")},NC=Symbol.for("effect/MetricPair"),LC={_Type:e=>e},DC=(e,t)=>({[NC]:LC,metricKey:e,metricState:t,pipe(){return re(this,arguments)}}),Gb=Symbol.for("effect/MetricRegistry");lS=Gb;class UC{constructor(){p(this,lS,Gb);p(this,"map",yk())}snapshot(){const t=[];for(const[n,i]of this.map)t.push(DC(n,i.get()));return t}get(t){const n=C(this.map,ci(t),jn);if(n==null){if(Nb(t.keyType))return this.getCounter(t);if(iC(t.keyType))return this.getGauge(t);if(rC(t.keyType))return this.getFrequency(t);if(Lb(t.keyType))return this.getHistogram(t);if(sC(t.keyType))return this.getSummary(t);throw new Error("BUG: MetricRegistry.get - unknown MetricKeyType - please report an issue at https://github.com/Effect-TS/effect/issues")}else return n}getCounter(t){let n=C(this.map,ci(t),jn);if(n==null){const i=kC(t);C(this.map,So(t))||C(this.map,wo(t,i)),n=i}return n}getFrequency(t){let n=C(this.map,ci(t),jn);if(n==null){const i=$C(t);C(this.map,So(t))||C(this.map,wo(t,i)),n=i}return n}getGauge(t){let n=C(this.map,ci(t),jn);if(n==null){const i=MC(t,t.keyType.bigint?BigInt(0):0);C(this.map,So(t))||C(this.map,wo(t,i)),n=i}return n}getHistogram(t){let n=C(this.map,ci(t),jn);if(n==null){const i=CC(t);C(this.map,So(t))||C(this.map,wo(t,i)),n=i}return n}getSummary(t){let n=C(this.map,ci(t),jn);if(n==null){const i=PC(t);C(this.map,So(t))||C(this.map,wo(t,i)),n=i}return n}}const KC=()=>new UC,BC=Symbol.for("effect/Metric"),jC={_Type:e=>e,_In:e=>e,_Out:e=>e},Hb=Ee(Symbol.for("effect/Metric/globalMetricRegistry"),()=>KC()),Vb=function(e,t,n,i){const o=Object.assign(u=>Rx(u,a=>GC(o,a)),{[BC]:jC,keyType:e,unsafeUpdate:t,unsafeValue:n,unsafeModify:i,register(){return this.unsafeValue([]),this},pipe(){return re(this,arguments)}});return o},Pu=(e,t)=>zb(aC(e,t)),zb=e=>{let t;const n=new WeakMap,i=o=>{if(o.length===0)return t!==void 0||(t=Hb.get(e)),t;let u=n.get(o);return u!==void 0||(u=Hb.get(fC(e,o)),n.set(o,u)),u};return Vb(e.keyType,(o,u)=>i(u).update(o),o=>i(o).get(),(o,u)=>i(u).modify(o))},WC=(e,t,n)=>zb(lC(e,t,n)),qC=I(3,(e,t,n)=>JC(e,[B$(t,n)])),JC=I(2,(e,t)=>Vb(e.keyType,(n,i)=>e.unsafeUpdate(n,Pc(t,i)),n=>e.unsafeValue(Pc(t,n)),(n,i)=>e.unsafeModify(n,Pc(t,i)))),GC=I(2,(e,t)=>Cf(Pf,n=>ce(()=>e.unsafeUpdate(t,n))));({...Al});const HC=I(2,(e,t)=>Cf(Rb,n=>ce(()=>{if(n.has(e)){const i=n.get(e);i.state.completed||(i.state.completed=!0,I_(i.result,t))}}))),Fu=Symbol.for("effect/Supervisor"),Eh={_T:e=>e};fS=Fu;const ud=class ud{constructor(t,n){p(this,"underlying");p(this,"value0");p(this,fS,Eh);this.underlying=t,this.value0=n}get value(){return this.value0}onStart(t,n,i,o){this.underlying.onStart(t,n,i,o)}onEnd(t,n){this.underlying.onEnd(t,n)}onEffect(t,n){this.underlying.onEffect(t,n)}onSuspend(t){this.underlying.onSuspend(t)}onResume(t){this.underlying.onResume(t)}map(t){return new ud(this,C(this.value,Ut(t)))}zip(t){return new Lu(this,t)}};let Nu=ud;hS=Fu;const ad=class ad{constructor(t,n){p(this,"left");p(this,"right");p(this,"_tag","Zip");p(this,hS,Eh);this.left=t,this.right=n}get value(){return a_(this.left.value,this.right.value)}onStart(t,n,i,o){this.left.onStart(t,n,i,o),this.right.onStart(t,n,i,o)}onEnd(t,n){this.left.onEnd(t,n),this.right.onEnd(t,n)}onEffect(t,n){this.left.onEffect(t,n),this.right.onEffect(t,n)}onSuspend(t){this.left.onSuspend(t),this.right.onSuspend(t)}onResume(t){this.left.onResume(t),this.right.onResume(t)}map(t){return new Nu(this,C(this.value,Ut(t)))}zip(t){return new ad(this,t)}};let Lu=ad;const Yb=e=>ue(e,Fu)&&ng(e,"Zip");dS=Fu;class VC{constructor(t){p(this,"effect");p(this,dS,Eh);this.effect=t}get value(){return this.effect}onStart(t,n,i,o){}onEnd(t,n){}onEffect(t,n){}onSuspend(t){}onResume(t){}map(t){return new Nu(this,C(this.value,Ut(t)))}zip(t){return new Lu(this,t)}onRun(t,n){return t()}}const zC=e=>new VC(e),Du=Ee("effect/Supervisor/none",()=>zC(kn)),YC=zi,Xb="Empty",Zb="AddSupervisor",Qb="RemoveSupervisor",ev="AndThen",Ao={_tag:Xb},Uu=(e,t)=>({_tag:ev,first:e,second:t}),XC=(e,t)=>ZC(t,Vt(e)),ZC=(e,t)=>{let n=e,i=t;for(;Bi(i);){const o=ji(i);switch(o._tag){case Xb:{i=Qr(i);break}case Zb:{n=n.zip(o.supervisor),i=Qr(i);break}case Qb:{n=Oh(n,o.supervisor),i=Qr(i);break}case ev:{i=In(o.first)(In(o.second)(Qr(i)));break}}}return n},Oh=(e,t)=>fe(e,t)?Du:Yb(e)?Oh(e.left,t).zip(Oh(e.right,t)):e,Ku=e=>fe(e,Du)?ni():Yb(e)?C(Ku(e.left),so(Ku(e.right))):uf(e),QC=YC({empty:Ao,patch:XC,combine:Uu,diff:(e,t)=>{if(fe(e,t))return Ao;const n=Ku(e),i=Ku(t),o=C(i,oy(n),Yc(Ao,(a,f)=>Uu(a,{_tag:Zb,supervisor:f}))),u=C(n,oy(i),Yc(Ao,(a,f)=>Uu(a,{_tag:Qb,supervisor:f})));return Uu(o,u)}}),eP=Pu("effect_fiber_started",{incremental:!0}),tv=Pu("effect_fiber_active"),tP=Pu("effect_fiber_successes",{incremental:!0}),nP=Pu("effect_fiber_failures",{incremental:!0}),rP=qC(WC("effect_fiber_lifetimes",zM({start:.5,factor:2,count:35})),"time_unit","milliseconds"),Ro="Continue",iP="Done",nv="Yield",sP={_E:e=>e,_A:e=>e},Bu=e=>{throw new Error(`BUG: FiberRuntime - ${Ri(e)} - please report an issue at https://github.com/Effect-TS/effect/issues`)},lr=Symbol.for("effect/internal/fiberRuntime/YieldedOp"),fr=Ee("effect/internal/fiberRuntime/yieldedOpChannel",()=>({currentOp:null})),xo={[Oc]:(e,t,n)=>kt(()=>t.effect_instruction_i1(n)),OnStep:(e,t,n)=>tt(tt(n)),[Tc]:(e,t,n)=>kt(()=>t.effect_instruction_i2(n)),[Il]:(e,t,n)=>(e.patchRuntimeFlags(e.currentRuntimeFlags,t.patch),kr(e.currentRuntimeFlags)&&e.isInterrupted()?Le(e.getInterruptedCause()):tt(n)),[Ic]:(e,t,n)=>(kt(()=>t.effect_instruction_i2(n)),kt(()=>t.effect_instruction_i0())?(e.pushStack(t),kt(()=>t.effect_instruction_i1())):kn),[Ac]:(e,t,n)=>{const i=kt(()=>t.effect_instruction_i0.next(n));return i.done?tt(i.value):(e.pushStack(t),VE(i.value))}},oP={[ch]:(e,t,n,i)=>(e.processNewInterruptSignal(i.cause),kr(t)?Le(i.cause):n),[ah]:(e,t,n,i)=>{throw new Error("It is illegal to have multiple concurrent run loops in a single fiber")},[uh]:(e,t,n,i)=>(i.onFiber(e,db(t)),n),[lh]:(e,t,n,i)=>se($f(),()=>n)},cP=e=>pu(PR(e),t=>di(VR(t),([n,i])=>{const o=new Map,u=[];for(const f of i){u.push(Zr(f));for(const d of f)o.set(d.request,d)}const a=u.flat();return _u(SP(n.runAll(u),a,()=>a.forEach(f=>{f.listeners.interrupted=!0})),Rb,o)},!1,!1)),uP=mc();class rv extends N${constructor(n,i,o){super();p(this,gS,KM);p(this,pS,sP);p(this,"_fiberRefs");p(this,"_fiberId");p(this,"_queue",new Array);p(this,"_children",null);p(this,"_observers",new Array);p(this,"_running",!1);p(this,"_stack",[]);p(this,"_asyncInterruptor",null);p(this,"_asyncBlockingOn",null);p(this,"_exitValue",null);p(this,"_steps",[]);p(this,"_isYielding",!1);p(this,"currentRuntimeFlags");p(this,"currentOpCount",0);p(this,"currentSupervisor");p(this,"currentScheduler");p(this,"currentTracer");p(this,"currentSpan");p(this,"currentContext");p(this,"currentDefaultServices");p(this,"run",()=>{this.drainQueueOnCurrentThread()});if(this.currentRuntimeFlags=o,this._fiberId=n,this._fiberRefs=i,$y(o)){const u=this.getFiberRef(Pf);eP.unsafeUpdate(1,u),tv.unsafeUpdate(1,u)}this.refreshRefCache()}commit(){return kb(this)}id(){return this._fiberId}resume(n){this.tell(fs(n))}get status(){return this.ask((n,i)=>i)}get runtimeFlags(){return this.ask((n,i)=>oM(i)?n.currentRuntimeFlags:i.runtimeFlags)}scope(){return DM(this)}get children(){return this.ask(n=>Array.from(n.getChildren()))}getChildren(){return this._children===null&&(this._children=new Set),this._children}getInterruptedCause(){return this.getFiberRef(vu)}fiberRefs(){return this.ask(n=>n.getFiberRefs())}ask(n){return ot(()=>{const i=uk(this._fiberId);return this.tell(Mu((o,u)=>{I_(i,ce(()=>n(o,u)))})),T_(i)})}tell(n){this._queue.push(n),this._running||(this._running=!0,this.drainQueueLaterOnExecutor())}get await(){return _o(n=>{const i=o=>n(je(o));return this.tell(Mu((o,u)=>{o._exitValue!==null?i(this._exitValue):o.addObserver(i)})),ce(()=>this.tell(Mu((o,u)=>{o.removeObserver(i)})))},this.id())}get inheritAll(){return zt((n,i)=>{const o=n.id(),u=n.getFiberRefs(),a=i.runtimeFlags,f=this.getFiberRefs(),d=m$(u,o,f);n.setFiberRefs(d);const g=n.getFiberRef(lv),b=C(iu(a,g),Py(Yi),Py(vf));return kx(b)})}get poll(){return ce(()=>xc(this._exitValue))}unsafePoll(){return this._exitValue}interruptAsFork(n){return ce(()=>this.tell(fh($r(n))))}unsafeInterruptAsFork(n){this.tell(fh($r(n)))}addObserver(n){this._exitValue!==null?n(this._exitValue):this._observers.push(n)}removeObserver(n){this._observers=this._observers.filter(i=>i!==n)}getFiberRefs(){return this.setFiberRef(lv,this.currentRuntimeFlags),this._fiberRefs}unsafeDeleteFiberRef(n){this._fiberRefs=nb(this._fiberRefs,n)}getFiberRef(n){return this._fiberRefs.locals.has(n)?this._fiberRefs.locals.get(n)[0][1]:n.initial}setFiberRef(n,i){this._fiberRefs=Jf(this._fiberRefs,{fiberId:this._fiberId,fiberRef:n,value:i}),this.refreshRefCache()}refreshRefCache(){this.currentDefaultServices=this.getFiberRef(Ou),this.currentTracer=this.currentDefaultServices.unsafeMap.get(X_.key),this.currentSupervisor=this.getFiberRef(vP),this.currentScheduler=this.getFiberRef(Ab),this.currentContext=this.getFiberRef(bo),this.currentSpan=this.currentContext.unsafeMap.get(Z_.key)}setFiberRefs(n){this._fiberRefs=n,this.refreshRefCache()}addChild(n){this.getChildren().add(n)}removeChild(n){this.getChildren().delete(n)}transferChildren(n){const i=this._children;if(this._children=null,i!==null&&i.size>0)for(const o of i)o._exitValue===null&&n.add(this.currentRuntimeFlags,o)}drainQueueOnCurrentThread(){let n=!0;for(;n;){let i=Ro;const o=globalThis[hi];globalThis[hi]=this;try{for(;i===Ro;)i=this._queue.length===0?iP:this.evaluateMessageWhileSuspended(this._queue.splice(0,1)[0])}finally{this._running=!1,globalThis[hi]=o}this._queue.length>0&&!this._running?(this._running=!0,i===nv?(this.drainQueueLaterOnExecutor(),n=!1):n=!0):n=!1}}drainQueueLaterOnExecutor(){this.currentScheduler.scheduleTask(this.run,this.getFiberRef(bu))}drainQueueWhileRunning(n,i){let o=i;for(;this._queue.length>0;){const u=this._queue.splice(0,1)[0];o=oP[u._tag](this,n,o,u)}return o}isInterrupted(){return!QR(this.getFiberRef(vu))}addInterruptedCause(n){const i=this.getFiberRef(vu);this.setFiberRef(vu,un(i,n))}processNewInterruptSignal(n){this.addInterruptedCause(n),this.sendInterruptSignalToAllChildren()}sendInterruptSignalToAllChildren(){if(this._children===null||this._children.size===0)return!1;let n=!1;for(const i of this._children)i.tell(fh($r(this.id()))),n=!0;return n}interruptAllChildren(){if(this.sendInterruptSignalToAllChildren()){const n=this._children.values();this._children=null;let i=!1;return kf({while:()=>!i,body:()=>{const u=n.next();return u.done?ce(()=>{i=!0}):yo(u.value.await)},step:()=>{}})}return null}reportExitValue(n){if($y(this.currentRuntimeFlags)){const i=this.getFiberRef(Pf),o=this.id().startTimeMillis,u=Date.now();switch(rP.unsafeUpdate(u-o,i),tv.unsafeUpdate(-1,i),n._tag){case On:{tP.unsafeUpdate(1,i);break}case En:{nP.unsafeUpdate(1,i);break}}}if(n._tag==="Failure"){const i=this.getFiberRef(Yx);!Ef(n.cause)&&i._tag==="Some"&&this.log("Fiber terminated with an unhandled error",n.cause,i)}}setExitValue(n){this._exitValue=n,this.reportExitValue(n);for(let i=this._observers.length-1;i>=0;i--)this._observers[i](n);this._observers=[]}getLoggers(){return this.getFiberRef(dP)}log(n,i,o){const u=wt(o)?o.value:this.getFiberRef(Jx),a=this.getFiberRef(aP);if($$(a,u))return;const f=this.getFiberRef(Gx),d=this.getFiberRef(qx),g=this.getLoggers(),b=this.getFiberRefs();if(iy(g)>0){const v=xm(this.getFiberRef(Ou),Wf),O=new Date(v.unsafeCurrentTimeMillis());XE(b,()=>{for(const T of g)T.log({fiberId:this.id(),logLevel:u,message:n,cause:i,context:b,spans:f,annotations:d,date:O})})}}evaluateMessageWhileSuspended(n){switch(n._tag){case lh:return nv;case ch:return this.processNewInterruptSignal(n.cause),this._asyncInterruptor!==null&&(this._asyncInterruptor(Le(n.cause)),this._asyncInterruptor=null),Ro;case ah:return this._asyncInterruptor=null,this._asyncBlockingOn=null,this.evaluateEffect(n.effect),Ro;case uh:return n.onFiber(this,this._exitValue!==null?iM:sM(this.currentRuntimeFlags,this._asyncBlockingOn)),Ro;default:return Bu(n)}}evaluateEffect(n){this.currentSupervisor.onResume(this);try{let i=kr(this.currentRuntimeFlags)&&this.isInterrupted()?Le(this.getInterruptedCause()):n;for(;i!==null;){const o=i,u=this.runLoop(o);if(u===lr){const a=fr.currentOp;fr.currentOp=null,a._op===Rc?xR(this.currentRuntimeFlags)?(this.tell(FM()),this.tell(fs(oi)),i=null):i=oi:a._op===Gs&&(i=null)}else{this.currentRuntimeFlags=C(this.currentRuntimeFlags,kR(vf));const a=this.interruptAllChildren();a!==null?i=se(a,()=>u):(this._queue.length===0?this.setExitValue(u):this.tell(fs(u)),i=null)}}}finally{this.currentSupervisor.onSuspend(this)}}start(n){if(this._running)this.tell(fs(n));else{this._running=!0;const i=globalThis[hi];globalThis[hi]=this;try{this.evaluateEffect(n)}finally{this._running=!1,globalThis[hi]=i,this._queue.length>0&&this.drainQueueLaterOnExecutor()}}}startFork(n){this.tell(fs(n))}patchRuntimeFlags(n,i){const o=su(n,i);return globalThis[hi]=this,this.currentRuntimeFlags=o,o}initiateAsync(n,i){let o=!1;const u=a=>{o||(o=!0,this.tell(fs(a)))};kr(n)&&(this._asyncInterruptor=u);try{i(u)}catch(a){u(xn(Vn(a)))}}pushStack(n){this._stack.push(n),n._op==="OnStep"&&this._steps.push({refs:this.getFiberRefs(),flags:this.currentRuntimeFlags})}popStack(){const n=this._stack.pop();if(n)return n._op==="OnStep"&&this._steps.pop(),n}getNextSuccessCont(){let n=this.popStack();for(;n;){if(n._op!==Tl)return n;n=this.popStack()}}getNextFailCont(){let n=this.popStack();for(;n;){if(n._op!==Oc&&n._op!==Ic&&n._op!==Ac)return n;n=this.popStack()}}[(gS=UM,pS=BM,QE)](n){return ce(()=>km(this.currentContext,n))}Left(n){return Dt(n.left)}None(n){return Dt(new v_)}Right(n){return tt(n.right)}Some(n){return tt(n.value)}Micro(n){return hu(i=>{let o=i;const u=CM(IM(n,this.currentContext));return u.addObserver(a=>{if(a._tag==="Success")return o(tt(a.value));switch(a.cause._tag){case"Interrupt":return o(Le($r(Hi)));case"Fail":return o(Dt(a.cause.error));case"Die":return o(Qy(a.cause.defect))}}),hu(a=>{o=f=>{a(kn)},u.unsafeInterrupt()})})}[ag](n){const i=kt(()=>n.effect_instruction_i0()),o=this.getNextSuccessCont();return o!==void 0?(o._op in xo||Bu(o),xo[o._op](this,o,i)):(fr.currentOp=tt(i),lr)}[On](n){const i=n,o=this.getNextSuccessCont();return o!==void 0?(o._op in xo||Bu(o),xo[o._op](this,o,i.effect_instruction_i0)):(fr.currentOp=i,lr)}[En](n){const i=n.effect_instruction_i0,o=this.getNextFailCont();if(o!==void 0)switch(o._op){case Tl:case Tc:return kr(this.currentRuntimeFlags)&&this.isInterrupted()?Le(Ky(i)):kt(()=>o.effect_instruction_i1(i));case"OnStep":return kr(this.currentRuntimeFlags)&&this.isInterrupted()?Le(Ky(i)):tt(Le(i));case Il:return this.patchRuntimeFlags(this.currentRuntimeFlags,o.patch),kr(this.currentRuntimeFlags)&&this.isInterrupted()?Le(un(i,this.getInterruptedCause())):Le(i);default:Bu(o)}else return fr.currentOp=Le(i),lr}[lg](n){return kt(()=>n.effect_instruction_i0(this,db(this.currentRuntimeFlags)))}Blocked(n){const i=this.getFiberRefs(),o=this.currentRuntimeFlags;if(this._steps.length>0){const u=[],a=this._steps[this._steps.length-1];let f=this.popStack();for(;f&&f._op!=="OnStep";)u.push(f),f=this.popStack();this.setFiberRefs(a.refs),this.currentRuntimeFlags=a.flags;const d=V$(a.refs,i),g=iu(a.flags,o);return tt(Vy(n.effect_instruction_i0,zt(b=>{for(;u.length>0;)b.pushStack(u.pop());return b.setFiberRefs(z$(b.id(),b.getFiberRefs())(d)),b.currentRuntimeFlags=su(g)(b.currentRuntimeFlags),n.effect_instruction_i1})))}return mu(u=>se(sv(vx(n.effect_instruction_i0)),()=>u(n.effect_instruction_i1)))}RunBlocked(n){return cP(n.effect_instruction_i0)}[Hs](n){const i=n.effect_instruction_i0,o=this.currentRuntimeFlags,u=su(o,i);if(kr(u)&&this.isInterrupted())return Le(this.getInterruptedCause());if(this.patchRuntimeFlags(this.currentRuntimeFlags,i),n.effect_instruction_i1){const a=iu(u,o);return this.pushStack(new Sx(a,n)),kt(()=>n.effect_instruction_i1(o))}else return oi}[Oc](n){return this.pushStack(n),n.effect_instruction_i0}OnStep(n){return this.pushStack(n),n.effect_instruction_i0}[Tl](n){return this.pushStack(n),n.effect_instruction_i0}[Tc](n){return this.pushStack(n),n.effect_instruction_i0}[Gs](n){return this._asyncBlockingOn=n.effect_instruction_i1,this.initiateAsync(this.currentRuntimeFlags,n.effect_instruction_i0),fr.currentOp=n,lr}[Rc](n){return this._isYielding=!1,fr.currentOp=n,lr}[Ic](n){const i=n.effect_instruction_i0,o=n.effect_instruction_i1;return i()?(this.pushStack(n),o()):oi}[Ac](n){return xo[Ac](this,n,void 0)}[Ec](n){return kt(()=>n.commit())}runLoop(n){let i=n;for(this.currentOpCount=0;;){if(this.currentRuntimeFlags&RR&&this.currentSupervisor.onEffect(this,i),this._queue.length>0&&(i=this.drainQueueWhileRunning(this.currentRuntimeFlags,i)),!this._isYielding){this.currentOpCount+=1;const o=this.currentScheduler.shouldYield(this);if(o!==!1){this._isYielding=!0,this.currentOpCount=0;const u=i;i=se($f({priority:o}),()=>u)}}try{if(i=this.currentTracer.context(()=>uP!==i[is]._V?e_(`Cannot execute an Effect versioned ${i[is]._V} with a Runtime of version ${mc()}`):this[i._op](i),this),i===lr){const o=fr.currentOp;return o._op===Rc||o._op===Gs?lr:(fr.currentOp=null,o._op===On||o._op===En?o:Le(Vn(o)))}}catch(o){i!==lr&&!ue(i,"_op")||!(i._op in this)?i=e_(`Not a valid effect: ${Ri(i)}`):tk(o)?i=Le(un(Vn(o),$r(Hi))):i=Qy(o)}}}}const aP=Ee("effect/FiberRef/currentMinimumLogLevel",()=>Yt(M$("Info"))),lP=e=>dh(t=>{const n=v$(t.context,Ou);xm(n,V_).unsafe.log(e.log(t))}),fP=Ee(Symbol.for("effect/Logger/defaultLogger"),()=>lP(JM)),hP=Ee(Symbol.for("effect/Logger/tracerLogger"),()=>dh(({annotations:e,cause:t,context:n,fiberId:i,logLevel:o,message:u})=>{const a=to(Eo(n,bo),Z_);if(a._tag==="None"||a.value._tag==="ExternalSpan")return;const f=km(Eo(n,Ou),Wf),d={};for(const[g,b]of e)d[g]=b;d["effect.fiberId"]=vA(i),d["effect.logLevel"]=o.label,t!==null&&t._tag!=="Empty"&&(d["effect.cause"]=ns(t,{renderErrorCause:!0})),a.value.event(Ri(Array.isArray(u)?u[0]:u),f.unsafeCurrentTimeNanos(),d)})),dP=Ee(Symbol.for("effect/FiberRef/currentLoggers"),()=>Bx(uf(fP,hP))),pP=I(e=>rg(e[0]),(e,t,n)=>zt(i=>{const o=(n==null?void 0:n.batching)===!0||(n==null?void 0:n.batching)==="inherit"&&i.getFiberRef(zx);return n!=null&&n.discard?xb(n.concurrency,()=>hs(zf,n==null?void 0:n.concurrentFinalizers)(u=>o?di(e,(a,f)=>u(t(a,f)),!0,!1,1):pu(e,(a,f)=>u(t(a,f)))),()=>hs(Yf,n==null?void 0:n.concurrentFinalizers)(u=>di(e,(a,f)=>u(t(a,f)),o,!1)),u=>hs(Xf(u),n==null?void 0:n.concurrentFinalizers)(a=>di(e,(f,d)=>a(t(f,d)),o,!1,u))):xb(n==null?void 0:n.concurrency,()=>hs(zf,n==null?void 0:n.concurrentFinalizers)(u=>o?iv(e,1,(a,f)=>u(t(a,f)),!0):Mr(e,(a,f)=>u(t(a,f)))),()=>hs(Yf,n==null?void 0:n.concurrentFinalizers)(u=>gP(e,(a,f)=>u(t(a,f)),o)),u=>hs(Xf(u),n==null?void 0:n.concurrentFinalizers)(a=>iv(e,u,(f,d)=>a(t(f,d)),o)))})),gP=(e,t,n)=>ot(()=>{const i=et(e),o=new Array(i.length);return yu(di(i,(a,f)=>se(t(a,f),d=>ce(()=>o[f]=d)),n,!1),je(o))}),di=(e,t,n,i,o)=>mu(u=>xx(a=>zt(f=>{let d=Array.from(e).reverse(),g=d.length;if(g===0)return kn;let b=0,v=!1;const O=o?Math.min(d.length,o):d.length,T=new Set,R=new Array,W=()=>T.forEach(N=>{N.currentScheduler.scheduleTask(()=>{N.unsafeInterruptAsFork(f.id())},0)}),F=new Array,L=new Array,z=new Array,B=()=>{const N=R.filter(({exit:U})=>U._tag==="Failure").sort((U,K)=>U.index<K.index?-1:U.index===K.index?0:1).map(({exit:U})=>U);return N.length===0&&N.push(oi),N},H=(N,U=!1)=>{const K=u_(a(N)),D=yP(K,f,f.currentRuntimeFlags,hh);return f.currentScheduler.scheduleTask(()=>{U&&D.unsafeInterruptAsFork(f.id()),D.resume(K)},0),D},Y=()=>{i||(g-=d.length,d=[]),v=!0,W()},G=n?Ix:t_,k=H(_o(N=>{const U=(D,q)=>{D._op==="Blocked"?z.push(D):(R.push({index:q,exit:D}),D._op==="Failure"&&!v&&Y())},K=()=>{if(d.length>0){const D=d.pop();let q=b++;const Te=()=>{const ne=d.pop();return q=b++,se($f(),()=>se(G(u(t(ne,q))),Ie))},Ie=ne=>d.length>0&&(U(ne,q),d.length>0)?Te():je(ne),ut=se(G(u(t(D,q))),Ie),We=H(ut);F.push(We),T.add(We),v&&We.currentScheduler.scheduleTask(()=>{We.unsafeInterruptAsFork(f.id())},0),We.addObserver(ne=>{let ze;if(ne._op==="Failure"?ze=ne:ze=ne.effect_instruction_i0,L.push(We),T.delete(We),U(ze,q),R.length===g)N(je(ht(w_(B(),{parallel:!0}),()=>oi)));else if(z.length+R.length===g){const Cn=B(),gr=z.map(At=>At.effect_instruction_i0).reduce(Fy);N(je(Vy(gr,di([ht(w_(Cn,{parallel:!0}),()=>oi),...z.map(At=>At.effect_instruction_i1)],At=>At,n,!0,o))))}else K()})}};for(let D=0;D<O;D++)K()}));return yo(xf(i_(u(kb(k))),O_({onFailure:N=>{Y();const U=z.length+1,K=Math.min(typeof o=="number"?o:z.length,z.length),D=Array.from(z);return _o(q=>{let Te=0,Ie=0;const ut=(ne,ze)=>Cn=>{Te++,Te===U&&q(tt(Le(N))),D.length>0&&ze&&We()},We=()=>{H(D.pop(),!0).addObserver(ut(Ie,!0)),Ie++};k.addObserver(ut(Ie,!1)),Ie++;for(let ne=0;ne<K;ne++)We()})},onSuccess:()=>Mr(L,N=>N.inheritAll)})))}))),iv=(e,t,n,i)=>ot(()=>{const o=et(e),u=new Array(o.length);return yu(di(o,(f,d)=>Ut(n(f,d),g=>u[d]=g),i,!1,t),je(u))}),sv=e=>_P(e,hh),mP=(e,t,n,i=null)=>{const o=ov(e,t,n,i);return o.resume(e),o},yP=(e,t,n,i=null)=>ov(e,t,n,i),ov=(e,t,n,i=null)=>{const o=dy(),u=t.getFiberRefs(),a=y$(u,o),f=new rv(o,a,n),d=Eo(a,bo),g=f.currentSupervisor;return g.onStart(d,e,be(t),f),f.addObserver(v=>g.onEnd(v,f)),(i!==null?i:C(t.getFiberRef(Ff),ht(()=>t.scope()))).add(n,f),f},_P=(e,t)=>zt((n,i)=>je(mP(e,n,i.runtimeFlags,t))),cv=e=>vo(t=>Ht(to(t,ko),{onNone:()=>e,onSome:n=>{switch(n.strategy._tag){case"Parallel":return e;case"Sequential":case"ParallelN":return se(Su(n,Yf),i=>Th(e,i))}}})),uv=e=>t=>vo(n=>Ht(to(n,ko),{onNone:()=>t,onSome:i=>i.strategy._tag==="ParallelN"&&i.strategy.parallelism===e?t:se(Su(i,Xf(e)),o=>Th(t,o))})),hs=(e,t)=>n=>vo(i=>Ht(to(i,ko),{onNone:()=>n(Ze),onSome:o=>{if(t===!0){const u=e._tag==="Parallel"?cv:e._tag==="Sequential"?av:uv(e.parallelism);switch(o.strategy._tag){case"Parallel":return u(n(cv));case"Sequential":return u(n(av));case"ParallelN":return u(n(uv(o.strategy.parallelism)))}}else return n(Ze)}})),av=e=>vo(t=>Ht(to(t,ko),{onNone:()=>e,onSome:n=>{switch(n.strategy._tag){case"Sequential":return e;case"Parallel":case"ParallelN":return se(Su(n,zf),i=>Th(e,i))}}})),ko=Xr("effect/Scope"),Th=I(2,(e,t)=>dk(e,$m(oI(ko,t)))),bP=e=>os(e,{differ:QC,fork:Ao}),lv=Wx($R),vP=bP(Du),SP=(e,t,n)=>r_(i=>se(se(sv(s_(e)),o=>_o(u=>{const a=t.map(g=>g.listeners.count),f=()=>{a.every(g=>g===0)&&t.every(g=>g.result.state.current._tag==="Pending"?!0:!!(g.result.state.current._tag==="Done"&&Lf(g.result.state.current.effect)&&g.result.state.current.effect._tag==="Failure"&&ex(g.result.state.current.effect.cause)))&&(d.forEach(g=>g()),n==null||n(),u($x(o)))};o.addObserver(g=>{d.forEach(b=>b()),u(g)});const d=t.map((g,b)=>{const v=O=>{a[b]=O,f()};return g.listeners.addObserver(v),()=>g.listeners.removeObserver(v)});return f(),ce(()=>{d.forEach(g=>g())})})),()=>ot(()=>{const o=t.flatMap(u=>u.state.completed?[]:[u]);return pu(o,u=>HC(u.request,sk(i)))}))),wP=ZR,EP=ns,OP=Zx,TP=Su,IP=function(){const e=Symbol.for("effect/Data/Error/plainArgs");return class extends Nf{constructor(n){super(n==null?void 0:n.message,n!=null&&n.cause?{cause:n.cause}:void 0),n&&(Object.assign(this,n),Object.defineProperty(this,e,{value:n,enumerable:!1}))}toJSON(){return{...this[e],...this}}}}(),AP=e=>{class t extends IP{constructor(){super(...arguments);p(this,"_tag",e)}}return t.prototype.name=e,t},fv=e=>(t,n)=>{const i=dy(),o=[[bo,[[i,e.context]]]];n!=null&&n.scheduler&&o.push([Ab,[[i,n.scheduler]]]);let u=S$(e.fiberRefs,{entries:o,forkAs:i});n!=null&&n.updateRefs&&(u=n.updateRefs(u,i));const a=new rv(i,u,e.runtimeFlags);let f=t;n!=null&&n.scope&&(f=se(TP(n.scope,lb),g=>yu(Xx(g,r_(b=>fe(b,a.id())?kn:f_(a,b))),xf(t,b=>OP(g,b)))));const d=a.currentSupervisor;return d!==Du&&(d.onStart(e.context,f,te(),a),a.addObserver(g=>d.onEnd(g,a))),hh.add(e.runtimeFlags,a),(n==null?void 0:n.immediate)===!1?a.resume(f):a.start(f),a},RP=e=>t=>{const n=PP(e)(t);if(n._tag==="Failure")throw MP(n.effect_instruction_i0);return n.effect_instruction_i0};class xP extends Error{constructor(n){super(`Fiber #${n.id().id} cannot be resolved synchronously. This is caused by using runSync on an effect that performs async work`);p(this,"fiber");p(this,"_tag","AsyncFiberException");this.fiber=n,this.name=this._tag,this.stack=this.message}}const kP=e=>{const t=Error.stackTraceLimit;Error.stackTraceLimit=0;const n=new xP(e);return Error.stackTraceLimit=t,n},Ih=Symbol.for("effect/Runtime/FiberFailure"),ju=Symbol.for("effect/Runtime/FiberFailure/Cause");class $P extends Error{constructor(n){const i=Gy(n)[0];super((i==null?void 0:i.message)||"An error has occurred");p(this,yS);p(this,mS);this[Ih]=Ih,this[ju]=n,this.name=i?`(FiberFailure) ${i.name}`:"FiberFailure",i!=null&&i.stack&&(this.stack=i.stack)}toJSON(){return{_id:"FiberFailure",cause:this[ju].toJSON()}}toString(){return"(FiberFailure) "+ns(this[ju],{renderErrorCause:!0})}[(yS=Ih,mS=ju,Be)](){return this.toString()}}const MP=e=>{const t=Error.stackTraceLimit;Error.stackTraceLimit=0;const n=new $P(e);return Error.stackTraceLimit=t,n},CP=e=>{const t=e;switch(t._op){case"Failure":case"Success":return t;case"Left":return E_(t.left);case"Right":return tt(t.right);case"Some":return tt(t.value);case"None":return E_(v_())}},PP=e=>t=>{const n=CP(t);if(n)return n;const i=new Ib,o=fv(e)(t,{scheduler:i});i.flush();const u=o.unsafePoll();return u||ik(Af(kP(o),Uf(o)))};class FP{constructor(t,n,i){p(this,"context");p(this,"runtimeFlags");p(this,"fiberRefs");this.context=t,this.runtimeFlags=n,this.fiberRefs=i}pipe(){return re(this,arguments)}}const hv=(e=>new FP(e.context,e.runtimeFlags,e.fiberRefs))({context:Bl(),runtimeFlags:ky(Yi,Ry,Ay),fiberRefs:w$()}),NP=fv(hv),LP=RP(hv),DP=fu,Wu=pP,qu=ot,ln=kn,UP=If,Ah=Ut,KP=gu,ds=du,Xn=se,BP=NP,jP=LP;class Tt{constructor(t,n,i){p(this,"path");p(this,"actual");p(this,"issue");p(this,"_tag","Pointer");this.path=t,this.actual=n,this.issue=i}}class dv{constructor(t,n){p(this,"actual");p(this,"message");p(this,"_tag","Unexpected");this.actual=t,this.message=n}}class $o{constructor(t,n){p(this,"ast");p(this,"message");p(this,"_tag","Missing");p(this,"actual");this.ast=t,this.message=n}}class nt{constructor(t,n,i,o){p(this,"ast");p(this,"actual");p(this,"issues");p(this,"output");p(this,"_tag","Composite");this.ast=t,this.actual=n,this.issues=i,this.output=o}}class Rh{constructor(t,n,i,o){p(this,"ast");p(this,"actual");p(this,"kind");p(this,"issue");p(this,"_tag","Refinement");this.ast=t,this.actual=n,this.kind=i,this.issue=o}}class xh{constructor(t,n,i,o){p(this,"ast");p(this,"actual");p(this,"kind");p(this,"issue");p(this,"_tag","Transformation");this.ast=t,this.actual=n,this.kind=i,this.issue=o}}class ps{constructor(t,n,i){p(this,"ast");p(this,"actual");p(this,"message");p(this,"_tag","Type");this.ast=t,this.actual=n,this.message=i}}class pv{constructor(t,n,i){p(this,"ast");p(this,"actual");p(this,"message");p(this,"_tag","Forbidden");this.ast=t,this.actual=n,this.message=i}}const gv=Symbol.for("effect/Schema/ParseErrorTypeId");class WP extends AP("ParseError"){constructor(){super(...arguments);p(this,_S,gv)}get message(){return this.toString()}toString(){return Gu.formatIssueSync(this.issue)}toJSON(){return{_id:"ParseError",message:this.toString()}}[(_S=gv,Be)](){return this.toJSON()}}const qP=e=>new WP({issue:e}),mv=Oe,Kt=pO,pi=I(2,(e,t)=>Kt(e)?kl(e,{onLeft:ge,onRight:t}):Xn(e,t)),Zn=I(2,(e,t)=>Kt(e)?mO(e,t):Ah(e,t)),kh=I(2,(e,t)=>Kt(e)?gO(e,t):KP(e,t)),yv=I(2,(e,t)=>Kt(e)?kl(e,{onLeft:t,onRight:Oe}):UP(e,t)),_v=(e,t)=>t===void 0||Jr(t)?e:e===void 0?t:{...e,...t},JP=(e,t,n)=>{const i=fn(e);return(o,u)=>i(o,_v(n,u))},GP=(e,t,n)=>{const i=JP(e,t,n);return(o,u)=>Sg(i(o,u),qP)},HP=(e,t)=>GP(Lt(e.ast),!0,t),VP=Ee(Symbol.for("effect/ParseResult/decodeMemoMap"),()=>new WeakMap),fn=(e,t)=>{const n=VP,i=n.get(e);if(i)return i;const o=zP(e),u=lT(e),a=wt(u)?(g,b)=>o(g,_v(b,u.value)):o,f=fT(e),d=wt(f)?(g,b)=>Ju(yv(a(g,b),f.value),e,g,b):a;return n.set(e,d),d},$h=e=>jn(cT(e)),Mh=e=>jn(uT(e)),zP=(e,t)=>{switch(e._tag){case"Refinement":{const n=fn(e.from);return(i,o)=>{o=o??Dl;const u=(o==null?void 0:o.errors)==="all",a=pi(yv(n(i,o),f=>{const d=new Rh(e,i,"From",f);return u&&dT(e)&&Sv(f)?Ht(e.filter(i,o,e),{onNone:()=>ge(d),onSome:g=>ge(new nt(e,i,[d,new Rh(e,i,"Predicate",g)]))}):ge(d)}),f=>Ht(e.filter(f,o,e),{onNone:()=>Oe(f),onSome:d=>ge(new Rh(e,i,"Predicate",d))}));return Ju(a,e,i,o)}}case"Transformation":{const n=ZP(e.transformation),i=fn(e.from),o=fn(e.to);return(u,a)=>Ju(pi(kh(i(u,a),f=>new xh(e,u,"Encoded",f)),f=>pi(kh(n(f,a??Dl,e,u),d=>new xh(e,u,"Transformation",d)),d=>kh(o(d,a),g=>new xh(e,u,"Type",g)))),e,u,a)}case"Declaration":{const n=e.decodeUnknown(...e.typeParameters);return(i,o)=>Ju(n(i,o??Dl,e),e,i,o)}case"Literal":return Xt(e,n=>n===e.literal);case"UniqueSymbol":return Xt(e,n=>n===e.symbol);case"UndefinedKeyword":return Xt(e,PE);case"NeverKeyword":return Xt(e,FE);case"UnknownKeyword":case"AnyKeyword":case"VoidKeyword":return Oe;case"StringKeyword":return Xt(e,Bn);case"NumberKeyword":return Xt(e,Jr);case"BooleanKeyword":return Xt(e,ml);case"BigIntKeyword":return Xt(e,_c);case"SymbolKeyword":return Xt(e,yl);case"ObjectKeyword":return Xt(e,Ir);case"Enums":return Xt(e,n=>e.enums.some(([i,o])=>o===n));case"TemplateLiteral":{const n=jT(e);return Xt(e,i=>Bn(i)&&n.test(i))}case"TupleType":{const n=e.elements.map(g=>fn(g.type)),i=e.rest.map(g=>fn(g.type));let o=e.elements.filter(g=>!g.isOptional);e.rest.length>0&&(o=o.concat(e.rest.slice(1)));const u=o.length,a=e.elements.length>0?e.elements.map((g,b)=>b).join(" | "):"never",f=$h(e),d=Mh(e);return(g,b)=>{if(!$O(g))return ge(new ps(e,g));const v=(b==null?void 0:b.errors)==="all",O=[];let T=0;const R=[],W=g.length;for(let B=W;B<=u-1;B++){const H=new Tt(B,g,new $o(o[B-W]));if(v){O.push([T++,H]);continue}else return ge(new nt(e,g,H,R))}if(e.rest.length===0)for(let B=e.elements.length;B<=W-1;B++){const H=new Tt(B,g,new dv(g[B],`is unexpected, expected: ${a}`));if(v){O.push([T++,H]);continue}else return ge(new nt(e,g,H,R))}let F=0,L;for(;F<n.length;F++)if(W<F+1){if(e.elements[F].isOptional)continue}else{const B=n[F],H=B(g[F],b);if(Kt(H)){if(mt(H)){const Y=new Tt(F,g,H.left);if(v){O.push([T++,Y]);continue}else return ge(new nt(e,g,Y,Mn(R)))}R.push([T++,H.right])}else{const Y=T++,G=F;L||(L=[]),L.push(({es:k,output:N})=>Xn(ds(H),U=>{if(mt(U)){const K=new Tt(G,g,U.left);return v?(k.push([Y,K]),ln):ge(new nt(e,g,K,Mn(N)))}return N.push([Y,U.right]),ln}))}}if(_t(i)){const[B,...H]=i;for(;F<W-H.length;F++){const Y=B(g[F],b);if(Kt(Y))if(mt(Y)){const G=new Tt(F,g,Y.left);if(v){O.push([T++,G]);continue}else return ge(new nt(e,g,G,Mn(R)))}else R.push([T++,Y.right]);else{const G=T++,k=F;L||(L=[]),L.push(({es:N,output:U})=>Xn(ds(Y),K=>{if(mt(K)){const D=new Tt(k,g,K.left);return v?(N.push([G,D]),ln):ge(new nt(e,g,D,Mn(U)))}else return U.push([G,K.right]),ln}))}}for(let Y=0;Y<H.length;Y++)if(F+=Y,!(W<F+1)){const G=H[Y](g[F],b);if(Kt(G)){if(mt(G)){const k=new Tt(F,g,G.left);if(v){O.push([T++,k]);continue}else return ge(new nt(e,g,k,Mn(R)))}R.push([T++,G.right])}else{const k=T++,N=F;L||(L=[]),L.push(({es:U,output:K})=>Xn(ds(G),D=>{if(mt(D)){const q=new Tt(N,g,D.left);return v?(U.push([k,q]),ln):ge(new nt(e,g,q,Mn(K)))}return K.push([k,D.right]),ln}))}}}const z=({es:B,output:H})=>Cc(B)?ge(new nt(e,g,Mn(B),Mn(H))):Oe(Mn(H));if(L&&L.length>0){const B=L;return qu(()=>{const H={es:Zs(O),output:Zs(R)};return Xn(Wu(B,Y=>Y(H),{concurrency:f,batching:d,discard:!0}),()=>z(H))})}return z({output:R,es:O})}}case"TypeLiteral":{if(e.propertySignatures.length===0&&e.indexSignatures.length===0)return Xt(e,NE);const n=[],i={},o=[];for(const b of e.propertySignatures)n.push([fn(b.type),b]),i[b.name]=null,o.push(b.name);const u=e.indexSignatures.map(b=>[fn(b.parameter),fn(b.type),b.parameter]),a=ir.make(e.indexSignatures.map(b=>b.parameter).concat(o.map(b=>yl(b)?new yT(b):new mT(b)))),f=fn(a),d=$h(e),g=Mh(e);return(b,v)=>{if(!DE(b))return ge(new ps(e,b));const O=(v==null?void 0:v.errors)==="all",T=[];let R=0;const W=(v==null?void 0:v.onExcessProperty)==="error",F=(v==null?void 0:v.onExcessProperty)==="preserve",L={};let z;if(W||F){z=Ci(b);for(const G of z){const k=f(G,v);if(Kt(k)&&mt(k))if(W){const N=new Tt(G,b,new dv(b[G],`is unexpected, expected: ${String(a)}`));if(O){T.push([R++,N]);continue}else return ge(new nt(e,b,N,L))}else L[G]=b[G]}}let B;const H=(v==null?void 0:v.exact)===!0;for(let G=0;G<n.length;G++){const k=n[G][1],N=k.name,U=Object.prototype.hasOwnProperty.call(b,N);if(!U){if(k.isOptional)continue;if(H){const q=new Tt(N,b,new $o(k));if(O){T.push([R++,q]);continue}else return ge(new nt(e,b,q,L))}}const K=n[G][0],D=K(b[N],v);if(Kt(D)){if(mt(D)){const q=new Tt(N,b,U?D.left:new $o(k));if(O){T.push([R++,q]);continue}else return ge(new nt(e,b,q,L))}L[N]=D.right}else{const q=R++,Te=N;B||(B=[]),B.push(({es:Ie,output:ut})=>Xn(ds(D),We=>{if(mt(We)){const ne=new Tt(Te,b,U?We.left:new $o(k));return O?(Ie.push([q,ne]),ln):ge(new nt(e,b,ne,ut))}return ut[Te]=We.right,ln}))}}for(let G=0;G<u.length;G++){const k=u[G],N=k[0],U=k[1],K=Ng(b,k[2]);for(const D of K){const q=N(D,v);if(Kt(q)&&rr(q)){const Te=U(b[D],v);if(Kt(Te))if(mt(Te)){const Ie=new Tt(D,b,Te.left);if(O){T.push([R++,Ie]);continue}else return ge(new nt(e,b,Ie,L))}else Object.prototype.hasOwnProperty.call(i,D)||(L[D]=Te.right);else{const Ie=R++,ut=D;B||(B=[]),B.push(({es:We,output:ne})=>Xn(ds(Te),ze=>{if(mt(ze)){const Cn=new Tt(ut,b,ze.left);return O?(We.push([Ie,Cn]),ln):ge(new nt(e,b,Cn,ne))}else return Object.prototype.hasOwnProperty.call(i,D)||(ne[D]=ze.right),ln}))}}}}const Y=({es:G,output:k})=>{if(Cc(G))return ge(new nt(e,b,Mn(G),k));if((v==null?void 0:v.propertyOrder)==="original"){const N=z||Ci(b);for(const K of o)N.indexOf(K)===-1&&N.push(K);const U={};for(const K of N)Object.prototype.hasOwnProperty.call(k,K)&&(U[K]=k[K]);return Oe(U)}return Oe(k)};if(B&&B.length>0){const G=B;return qu(()=>{const k={es:Zs(T),output:Object.assign({},L)};return Xn(Wu(G,N=>N(k),{concurrency:d,batching:g,discard:!0}),()=>Y(k))})}return Y({es:T,output:L})}}case"Union":{const n=YP(e.types),i=Ci(n.keys),o=i.length,u=e.types.length,a=new Map;for(let g=0;g<u;g++)a.set(e.types[g],fn(e.types[g]));const f=$h(e)??1,d=Mh(e);return(g,b)=>{const v=[];let O=0,T=[];if(o>0)if(_l(g))for(let F=0;F<o;F++){const L=i[F],z=n.keys[L].buckets;if(Object.prototype.hasOwnProperty.call(g,L)){const B=String(g[L]);if(Object.prototype.hasOwnProperty.call(z,B))T=T.concat(z[B]);else{const{candidates:H,literals:Y}=n.keys[L],G=ir.make(Y),k=H.length===u?new Yr([new Ot(L,G,!1,!0)],[]):ir.make(H);v.push([O++,new nt(k,g,new Tt(L,g,new ps(G,g[L])))])}}else{const{candidates:B,literals:H}=n.keys[L],Y=new Ot(L,ir.make(H),!1,!0),G=B.length===u?new Yr([Y],[]):ir.make(B);v.push([O++,new nt(G,g,new Tt(L,g,new $o(Y)))])}}else{const F=n.candidates.length===u?e:ir.make(n.candidates);v.push([O++,new ps(F,g)])}n.otherwise.length>0&&(T=T.concat(n.otherwise));let R;for(let F=0;F<T.length;F++){const L=T[F],z=a.get(L)(g,b);if(Kt(z)&&(!R||R.length===0)){if(rr(z))return z;v.push([O++,z.left])}else{const B=O++;R||(R=[]),R.push(H=>qu(()=>"finalResult"in H?ln:Xn(ds(z),Y=>(rr(Y)?H.finalResult=Y:H.es.push([B,Y.left]),ln))))}}const W=F=>Cc(F)?F.length===1&&F[0][1]._tag==="Type"?ge(F[0][1]):ge(new nt(e,g,Mn(F))):ge(new ps(e,g));if(R&&R.length>0){const F=R;return qu(()=>{const L={es:Zs(v)};return Xn(Wu(F,z=>z(L),{concurrency:f,batching:d,discard:!0}),()=>"finalResult"in L?L.finalResult:W(L.es))})}return W(v)}}case"Suspend":{const n=Lg(()=>fn(Fi(e.f(),e.annotations)));return(i,o)=>n()(i,o)}}},Xt=(e,t)=>n=>t(n)?Oe(n):ge(new ps(e,n)),Mo=(e,t)=>{switch(e._tag){case"Declaration":{const n=sm(e);if(wt(n))return Mo(n.value);break}case"TypeLiteral":{const n=[];for(let i=0;i<e.propertySignatures.length;i++){const o=e.propertySignatures[i],u=wm(o.type);um(u)&&!o.isOptional&&n.push([o.name,u])}return n}case"TupleType":{const n=[];for(let i=0;i<e.elements.length;i++){const o=e.elements[i],u=wm(o.type);um(u)&&!o.isOptional&&n.push([i,u])}return n}case"Refinement":return Mo(e.from);case"Suspend":return Mo(e.f());case"Transformation":return Mo(e.from)}return[]},YP=(e,t)=>{const n={},i=[],o=[];for(let u=0;u<e.length;u++){const a=e[u],f=Mo(a);if(f.length>0){o.push(a);for(let d=0;d<f.length;d++){const[g,b]=f[d],v=String(b.literal);n[g]=n[g]||{buckets:{},literals:[],candidates:[]};const O=n[g].buckets;if(Object.prototype.hasOwnProperty.call(O,v)){if(d<f.length-1)continue;O[v].push(a),n[g].literals.push(b),n[g].candidates.push(a)}else{O[v]=[a],n[g].literals.push(b),n[g].candidates.push(a);break}}}else i.push(a)}return{keys:n,otherwise:i,candidates:o}},Ju=(e,t,n,i)=>{if((i==null?void 0:i.isEffectAllowed)===!0||Kt(e))return e;const o=new Ib,u=BP(e,{scheduler:o});o.flush();const a=u.unsafePoll();if(a){if(pk(a))return Oe(a.value);const f=a.cause;return wP(f)?ge(f.error):ge(new pv(t,n,EP(f)))}return ge(new pv(t,n,"cannot be be resolved synchronously, this is caused by using runSync on an effect that performs async work"))},XP=([e],[t])=>e>t?1:e<t?-1:0;function Mn(e){return e.sort(XP).map(t=>t[1])}const ZP=(e,t)=>{switch(e._tag){case"FinalTransformation":return e.decode;case"ComposeTransformation":return Oe;case"TypeLiteralTransformation":return n=>{let i=Oe(n);for(const o of e.propertySignatureTransformations){const[u,a]=[o.from,o.to],f=o.decode;i=Zn(i,g=>{const b=f(Object.prototype.hasOwnProperty.call(g,u)?be(g[u]):te());return delete g[u],wt(b)&&(g[a]=b.value),g})}return i}}},$t=(e,t=[])=>({value:e,forest:t}),Gu={formatIssue:e=>Zn(gs(e),QP),formatIssueSync:e=>{const t=Gu.formatIssue(e);return Kt(t)?_O(t):jP(t)},formatError:e=>Gu.formatIssue(e.issue),formatErrorSync:e=>Gu.formatIssueSync(e.issue)},QP=e=>e.value+bv(`
`,e.forest),bv=(e,t)=>{let n="";const i=t.length;let o;for(let u=0;u<i;u++){o=t[u];const a=u===i-1;n+=e+(a?"└":"├")+"─ "+o.value,n+=bv(e+(i>1&&!a?"│  ":"   "),o.forest)}return n},eF=e=>{switch(e){case"Encoded":return"Encoded side transformation failure";case"Transformation":return"Transformation process failure";case"Type":return"Type side transformation failure"}},tF=e=>{switch(e){case"From":return"From side refinement failure";case"Predicate":return"Predicate refinement failure"}},vv=e=>"ast"in e?be(e.ast):te(),Ch=Oe(void 0),nF=e=>vv(e).pipe(kc(sT),Ht({onNone:()=>Ch,onSome:t=>{const n=t(e);return Bn(n)?Oe({message:n,override:!1}):DP(n)?Ah(n,i=>({message:i,override:!1})):Bn(n.message)?Oe({message:n.message,override:n.override}):Ah(n.message,i=>({message:i,override:n.override}))}})),Ph=e=>t=>t._tag===e,Sv=Ph("Composite"),wv=Ph("Refinement"),Ev=Ph("Transformation"),Co=e=>pi(nF(e),t=>t!==void 0?!t.override&&(Sv(e)||wv(e)&&e.kind==="From"||Ev(e)&&e.kind!=="Transformation")?Ev(e)||wv(e)?Co(e.issue):Ch:Oe(t.message):Ch),Ov=e=>vv(e).pipe(kc(aT),EO(t=>t(e)),jn);function rF(e){return im(e).pipe(Ar(()=>nm(e)),Ar(()=>rm(e)),Ar(()=>Lc(e)),ht(()=>`{ ${e.from} | filter }`))}function iF(e){return e.message!==void 0?e.message:`Expected ${mm(e.ast)?rF(e.ast):String(e.ast)}, actual ${Wn(e.actual)}`}const sF=e=>Zn(Co(e),t=>t??Ov(e)??iF(e)),Hu=e=>Ov(e)??String(e.ast),oF=e=>e.message??"is forbidden",cF=e=>e.message??"is unexpected",uF=e=>{const t=oT(e.ast);if(wt(t)){const n=t.value();return Bn(n)?Oe(n):n}return Oe(e.message??"is missing")},gs=e=>{switch(e._tag){case"Type":return Zn(sF(e),$t);case"Forbidden":return Oe($t(Hu(e),[$t(oF(e))]));case"Unexpected":return Oe($t(cF(e)));case"Missing":return Zn(uF(e),$t);case"Transformation":return pi(Co(e),t=>t!==void 0?Oe($t(t)):Zn(gs(e.issue),n=>$t(Hu(e),[$t(eF(e.kind),[n])])));case"Refinement":return pi(Co(e),t=>t!==void 0?Oe($t(t)):Zn(gs(e.issue),n=>$t(Hu(e),[$t(tF(e.kind),[n])])));case"Pointer":return Zn(gs(e.issue),t=>$t(VO(e.path),[t]));case"Composite":return pi(Co(e),t=>{if(t!==void 0)return Oe($t(t));const n=Hu(e);return Dg(e.issues)?Zn(Wu(e.issues,gs),i=>$t(n,i)):Zn(gs(e.issues),i=>$t(n,[i]))})}},aF=I(e=>Ir(e[0]),(e,...t)=>{const n={};for(const i of t)i in e&&(n[i]=e[i]);return n}),lF=I(e=>Ir(e[0]),(e,...t)=>{const n={...e};for(const i of t)delete n[i];return n}),Po=Symbol.for("effect/Schema");function hr(e){var t,n,i;return n=Po,t=Po,i=class{constructor(){p(this,n,Tv)}static annotations(u){return hr(ms(this.ast,u))}static pipe(){return re(this,arguments)}static toString(){return String(e)}},p(i,"ast",e),p(i,"Type"),p(i,"Encoded"),p(i,"Context"),p(i,t,Tv),i}const Tv={_A:e=>e,_I:e=>e,_R:e=>e},Iv={schemaId:tT,message:jg,missingMessage:Ml,identifier:Wg,title:Rr,description:Nc,examples:qg,default:Jg,documentation:nT,jsonSchema:Gg,arbitrary:Hg,pretty:Vg,equivalence:zg,concurrency:Yg,batching:Xg,parseIssueTitle:Zg,parseOptions:Qg,decodingFallback:em},Fh=e=>{if(!e)return{};const t={...e};for(const n in Iv)if(n in e){const i=Iv[n];t[i]=e[n],delete t[n]}return t},ms=(e,t)=>Fi(e,Fh(t)),ys=e=>ue(e,Po)&&Ir(e[Po]);class fF extends hr(Pl){}class hF extends hr(Fl){}class _s extends hr(TT){}class dF extends hr(RT){}const pF=e=>ir.make(e.map(t=>t.ast));function Av(e,t=pF(e)){var n;return n=class extends hr(t){static annotations(o){return Av(this.members,ms(this.ast,o))}},p(n,"members",[...e]),n}function gF(...e){return dm(e)?Av(e):_t(e)?e[0]:hF}const mF=e=>gF(e,fF),yF=(e,t)=>new Nl(e.map(n=>ys(n)?new zr(n.ast,!1):n.ast),t.map(n=>ys(n)?new Dc(n.ast):n.ast),!0);function Rv(e,t,n=yF(e,t)){var i;return i=class extends hr(n){static annotations(u){return Rv(this.elements,this.rest,ms(this.ast,u))}},p(i,"elements",[...e]),p(i,"rest",[...t]),i}function xv(e,t){var n;return n=class extends Rv([],[e],t){static annotations(o){return xv(this.value,ms(this.ast,o))}},p(n,"value",e),n}const _F=e=>xv(e),Nh=e=>e?'"?:"':'":"';class kv extends zr{constructor(n,i,o,u,a){super(n,i,u);p(this,"isReadonly");p(this,"defaultValue");p(this,"_tag","PropertySignatureDeclaration");this.isReadonly=o,this.defaultValue=a}toString(){const n=Nh(this.isOptional),i=String(this.type);return`PropertySignature<${n}, ${i}, never, ${n}, ${i}>`}}class bF extends zr{constructor(n,i,o,u,a){super(n,i,u);p(this,"isReadonly");p(this,"fromKey");this.isReadonly=o,this.fromKey=a}}class vF extends zr{constructor(n,i,o,u,a){super(n,i,u);p(this,"isReadonly");p(this,"defaultValue");this.isReadonly=o,this.defaultValue=a}}const SF=e=>e===void 0?"never":Bn(e)?JSON.stringify(e):String(e);class wF{constructor(t,n,i,o){p(this,"from");p(this,"to");p(this,"decode");p(this,"encode");p(this,"_tag","PropertySignatureTransformation");this.from=t,this.to=n,this.decode=i,this.encode=o}toString(){return`PropertySignature<${Nh(this.to.isOptional)}, ${this.to.type}, ${SF(this.from.fromKey)}, ${Nh(this.from.isOptional)}, ${this.from.type}>`}}const $v=(e,t)=>{switch(e._tag){case"PropertySignatureDeclaration":return new kv(e.type,e.isOptional,e.isReadonly,{...e.annotations,...t},e.defaultValue);case"PropertySignatureTransformation":return new wF(new bF(e.from.type,e.from.isOptional,e.from.isReadonly,e.from.annotations),new vF(e.to.type,e.to.isOptional,e.to.isReadonly,{...e.to.annotations,...t},e.to.defaultValue),e.decode,e.encode)}},Mv=Symbol.for("effect/PropertySignature"),Cv=e=>ue(e,Mv);vS=Po,bS=Mv;const ld=class ld{constructor(t){p(this,"ast");p(this,vS);p(this,bS,null);p(this,"_TypeToken");p(this,"_Key");p(this,"_EncodedToken");p(this,"_HasDefault");this.ast=t}pipe(){return re(this,arguments)}annotations(t){return new ld($v(this.ast,Fh(t)))}toString(){return String(this.ast)}};let Lh=ld;class Dh extends Lh{constructor(n,i){super(n);p(this,"from");this.from=i}annotations(n){return new Dh($v(this.ast,Fh(n)),this.from)}}const EF=e=>{const t=e.ast===Pl||e.ast===Fl?Pl:mF(e).ast;return new Dh(new kv(t,!0,!0,{},void 0),e)},OF=Sm([Ml]),TF=(e,t)=>{const n=Ci(e),i=[];if(n.length>0){const u=[],a=[],f=[];for(let d=0;d<n.length;d++){const g=n[d],b=e[g];if(Cv(b)){const v=b.ast;switch(v._tag){case"PropertySignatureDeclaration":{const O=v.type,T=v.isOptional,R=v.annotations;u.push(new Ot(g,O,T,!0,OF(v))),a.push(new Ot(g,Lt(O),T,!0,R)),i.push(new Ot(g,O,T,!0,R));break}case"PropertySignatureTransformation":{const O=v.from.fromKey??g;u.push(new Ot(O,v.from.type,v.from.isOptional,!0,v.from.annotations)),a.push(new Ot(g,v.to.type,v.to.isOptional,!0,v.to.annotations)),f.push(new LT(O,g,v.decode,v.encode));break}}}else u.push(new Ot(g,b.ast,!1,!0)),a.push(new Ot(g,Lt(b.ast),!1,!0)),i.push(new Ot(g,b.ast,!1,!0))}if(_t(f)){const d=[],g=[];for(const b of t){const{indexSignatures:v,propertySignatures:O}=vm(b.key.ast,b.value.ast);O.forEach(T=>{u.push(T),a.push(new Ot(T.name,Lt(T.type),T.isOptional,T.isReadonly,T.annotations))}),v.forEach(T=>{d.push(T),g.push(new Uc(T.parameter,Lt(T.type),T.isReadonly))})}return new ym(new Yr(u,d,{[Cl]:"Struct (Encoded side)"}),new Yr(a,g,{[Cl]:"Struct (Type side)"}),new DT(f))}}const o=[];for(const u of t){const{indexSignatures:a,propertySignatures:f}=vm(u.key.ast,u.value.ast);f.forEach(d=>i.push(d)),a.forEach(d=>o.push(d))}return new Yr(i,o)},IF=(e,t)=>{const n=Ci(e);for(const i of n){const o=e[i];if(t[i]===void 0&&Cv(o)){const u=o.ast,a=u._tag==="PropertySignatureDeclaration"?u.defaultValue:u.to.defaultValue;a!==void 0&&(t[i]=a())}}return t};function Pv(e,t,n=TF(e,t)){var i;return i=class extends hr(n){static annotations(u){return Pv(this.fields,this.records,ms(this.ast,u))}static pick(...u){return bs(aF(e,...u))}static omit(...u){return bs(lF(e,...u))}},p(i,"fields",{...e}),p(i,"records",[...t]),p(i,"make",(u,a)=>{const f=IF(e,{...u});return xF(a)?f:HP(i)(f)}),i}function bs(e,...t){return Pv(e,t)}function Fv(e,t,n){var i;return i=class extends hr(n){static annotations(u){return Fv(this.from,this.to,ms(this.ast,u))}},p(i,"from",e),p(i,"to",t),i}const AF=I(e=>ys(e[0])&&ys(e[1]),(e,t,n)=>Fv(e,t,new ym(e.ast,t.ast,new NT(n.decode,n.encode)))),RF=I(e=>ys(e[0])&&ys(e[1]),(e,t,n)=>AF(e,t,{strict:!0,decode:(i,o,u,a)=>mv(n.decode(i,a)),encode:(i,o,u,a)=>mv(n.encode(i,a))}));function xF(e){return ml(e)?e:(e==null?void 0:e.disableValidation)??!1}const Nv=Symbol.for("midi/structor/schema/form/annotation"),kF={annotation:e=>({[Nv]:e}),getFormName:e=>e._tag==="PropertySignatureDeclaration"||e._tag==="PropertySignatureTransformation"?te():Et(Nv)(e)},$F=(e,t,n)=>16777216+(e<<16|t<<8|n<<0),MF=["","0","00","000","0000","00000","000000"];RF(_s,dF,{strict:!0,decode:e=>{const t=e.substring(0,2),n=e.substring(2,4),i=e.substring(4,6);return $F(parseInt(t,16),parseInt(n,16),parseInt(i,16))},encode:e=>{const t=e.toString(16);if(t.length>6)return t.substring(1,7);{const n=6-t.length;return MF[n]+t}}}).annotations(kF.annotation("Color"));const CF=()=>({tracks:[],cues:[]}),PF=e=>{let t=0;const n=[];return we.forEach(e,i=>{t!==i.startTime&&n.push({type:"blank",startTime:t,endTime:i.startTime}),n.push({...i,type:"real"}),t=i.endTime}),n.push({type:"blank",startTime:t,endTime:void 0}),n},FF=e=>{const t=[],n=[],i=[];we.forEach(e,a=>{a.type==="init-track"?t.push(a):a.type==="init-clip"?n.push(a):i.push(a)});const o=we.sortBy(t,a=>a.trackIndex),u=we.groupBy(n,a=>a.trackIndex);return{tracks:we.map(o,a=>{const f=we.get(u,a.trackIndex);return{name:a.name,color:a.color,clips:PF(f)}}),cues:i}},NF=e=>()=>[],LF=e=>dl(t=>{t.push(e)}),DF=e=>dl(t=>{t.push(e)}),UF=e=>dl(t=>{t.push(e)}),KF=e=>FF(e);var Lv={exports:{}},me={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fo=Symbol.for("react.element"),BF=Symbol.for("react.portal"),jF=Symbol.for("react.fragment"),WF=Symbol.for("react.strict_mode"),qF=Symbol.for("react.profiler"),JF=Symbol.for("react.provider"),GF=Symbol.for("react.context"),HF=Symbol.for("react.forward_ref"),VF=Symbol.for("react.suspense"),zF=Symbol.for("react.memo"),YF=Symbol.for("react.lazy"),Dv=Symbol.iterator;function XF(e){return e===null||typeof e!="object"?null:(e=Dv&&e[Dv]||e["@@iterator"],typeof e=="function"?e:null)}var Uv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Kv=Object.assign,Bv={};function vs(e,t,n){this.props=e,this.context=t,this.refs=Bv,this.updater=n||Uv}vs.prototype.isReactComponent={},vs.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},vs.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function jv(){}jv.prototype=vs.prototype;function Uh(e,t,n){this.props=e,this.context=t,this.refs=Bv,this.updater=n||Uv}var Kh=Uh.prototype=new jv;Kh.constructor=Uh,Kv(Kh,vs.prototype),Kh.isPureReactComponent=!0;var Wv=Array.isArray,qv=Object.prototype.hasOwnProperty,Bh={current:null},Jv={key:!0,ref:!0,__self:!0,__source:!0};function Gv(e,t,n){var i,o={},u=null,a=null;if(t!=null)for(i in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(u=""+t.key),t)qv.call(t,i)&&!Jv.hasOwnProperty(i)&&(o[i]=t[i]);var f=arguments.length-2;if(f===1)o.children=n;else if(1<f){for(var d=Array(f),g=0;g<f;g++)d[g]=arguments[g+2];o.children=d}if(e&&e.defaultProps)for(i in f=e.defaultProps,f)o[i]===void 0&&(o[i]=f[i]);return{$$typeof:Fo,type:e,key:u,ref:a,props:o,_owner:Bh.current}}function ZF(e,t){return{$$typeof:Fo,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function jh(e){return typeof e=="object"&&e!==null&&e.$$typeof===Fo}function QF(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Hv=/\/+/g;function Wh(e,t){return typeof e=="object"&&e!==null&&e.key!=null?QF(""+e.key):t.toString(36)}function Vu(e,t,n,i,o){var u=typeof e;(u==="undefined"||u==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(u){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case Fo:case BF:a=!0}}if(a)return a=e,o=o(a),e=i===""?"."+Wh(a,0):i,Wv(o)?(n="",e!=null&&(n=e.replace(Hv,"$&/")+"/"),Vu(o,t,n,"",function(g){return g})):o!=null&&(jh(o)&&(o=ZF(o,n+(!o.key||a&&a.key===o.key?"":(""+o.key).replace(Hv,"$&/")+"/")+e)),t.push(o)),1;if(a=0,i=i===""?".":i+":",Wv(e))for(var f=0;f<e.length;f++){u=e[f];var d=i+Wh(u,f);a+=Vu(u,t,n,d,o)}else if(d=XF(e),typeof d=="function")for(e=d.call(e),f=0;!(u=e.next()).done;)u=u.value,d=i+Wh(u,f++),a+=Vu(u,t,n,d,o);else if(u==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function zu(e,t,n){if(e==null)return e;var i=[],o=0;return Vu(e,i,"","",function(u){return t.call(n,u,o++)}),i}function eN(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Mt={current:null},Yu={transition:null},tN={ReactCurrentDispatcher:Mt,ReactCurrentBatchConfig:Yu,ReactCurrentOwner:Bh};function Vv(){throw Error("act(...) is not supported in production builds of React.")}me.Children={map:zu,forEach:function(e,t,n){zu(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return zu(e,function(){t++}),t},toArray:function(e){return zu(e,function(t){return t})||[]},only:function(e){if(!jh(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},me.Component=vs,me.Fragment=jF,me.Profiler=qF,me.PureComponent=Uh,me.StrictMode=WF,me.Suspense=VF,me.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tN,me.act=Vv,me.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=Kv({},e.props),o=e.key,u=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(u=t.ref,a=Bh.current),t.key!==void 0&&(o=""+t.key),e.type&&e.type.defaultProps)var f=e.type.defaultProps;for(d in t)qv.call(t,d)&&!Jv.hasOwnProperty(d)&&(i[d]=t[d]===void 0&&f!==void 0?f[d]:t[d])}var d=arguments.length-2;if(d===1)i.children=n;else if(1<d){f=Array(d);for(var g=0;g<d;g++)f[g]=arguments[g+2];i.children=f}return{$$typeof:Fo,type:e.type,key:o,ref:u,props:i,_owner:a}},me.createContext=function(e){return e={$$typeof:GF,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:JF,_context:e},e.Consumer=e},me.createElement=Gv,me.createFactory=function(e){var t=Gv.bind(null,e);return t.type=e,t},me.createRef=function(){return{current:null}},me.forwardRef=function(e){return{$$typeof:HF,render:e}},me.isValidElement=jh,me.lazy=function(e){return{$$typeof:YF,_payload:{_status:-1,_result:e},_init:eN}},me.memo=function(e,t){return{$$typeof:zF,type:e,compare:t===void 0?null:t}},me.startTransition=function(e){var t=Yu.transition;Yu.transition={};try{e()}finally{Yu.transition=t}},me.unstable_act=Vv,me.useCallback=function(e,t){return Mt.current.useCallback(e,t)},me.useContext=function(e){return Mt.current.useContext(e)},me.useDebugValue=function(){},me.useDeferredValue=function(e){return Mt.current.useDeferredValue(e)},me.useEffect=function(e,t){return Mt.current.useEffect(e,t)},me.useId=function(){return Mt.current.useId()},me.useImperativeHandle=function(e,t,n){return Mt.current.useImperativeHandle(e,t,n)},me.useInsertionEffect=function(e,t){return Mt.current.useInsertionEffect(e,t)},me.useLayoutEffect=function(e,t){return Mt.current.useLayoutEffect(e,t)},me.useMemo=function(e,t){return Mt.current.useMemo(e,t)},me.useReducer=function(e,t,n){return Mt.current.useReducer(e,t,n)},me.useRef=function(e){return Mt.current.useRef(e)},me.useState=function(e){return Mt.current.useState(e)},me.useSyncExternalStore=function(e,t,n){return Mt.current.useSyncExternalStore(e,t,n)},me.useTransition=function(){return Mt.current.useTransition()},me.version="18.3.1",Lv.exports=me;var gi=Lv.exports,qh=Ke(gi);const No={},zv=(e,t)=>e.unstable_is?e.unstable_is(t):t===e,Yv=e=>"init"in e,Jh=e=>!!e.write,Xv=e=>"v"in e||"e"in e,Xu=e=>{if("e"in e)throw e.e;if((No?"production":void 0)!=="production"&&!("v"in e))throw new Error("[Bug] atom state is not initialized");return e.v},Zu=new WeakMap,Zv=e=>{var t;return Qu(e)&&!!((t=Zu.get(e))!=null&&t[0])},nN=e=>{const t=Zu.get(e);t!=null&&t[0]&&(t[0]=!1,t[1].forEach(n=>n()))},Qv=(e,t)=>{let n=Zu.get(e);if(!n){n=[!0,new Set],Zu.set(e,n);const i=()=>{n[0]=!1};e.then(i,i)}n[1].add(t)},Qu=e=>typeof(e==null?void 0:e.then)=="function",e0=(e,t,n)=>{n.p.has(e)||(n.p.add(e),t.then(()=>{n.p.delete(e)},()=>{n.p.delete(e)}))},Gh=(e,t,n)=>{const i=n(e),o="v"in i,u=i.v;if(Qu(t))for(const a of i.d.keys())e0(e,t,n(a));i.v=t,delete i.e,(!o||!Object.is(u,i.v))&&(++i.n,Qu(u)&&nN(u))},t0=(e,t,n)=>{var i;const o=new Set;for(const u of((i=n.get(e))==null?void 0:i.t)||[])n.has(u)&&o.add(u);for(const u of t.p)o.add(u);return o},rN=()=>{const e=new Set,t=()=>{e.forEach(n=>n())};return t.add=n=>(e.add(n),()=>{e.delete(n)}),t},Hh=()=>{const e={},t=new WeakMap,n=i=>{var o,u;(o=t.get(e))==null||o.forEach(a=>a(i)),(u=t.get(i))==null||u.forEach(a=>a())};return n.add=(i,o)=>{const u=i||e,a=(t.has(u)?t:t.set(u,new Set)).get(u);return a.add(o),()=>{a==null||a.delete(o),a.size||t.delete(u)}},n},iN=e=>(e.c||(e.c=Hh()),e.m||(e.m=Hh()),e.u||(e.u=Hh()),e.f||(e.f=rN()),e),sN=Symbol(),n0=(e=new WeakMap,t=new WeakMap,n=new WeakMap,i=new Set,o=new Set,u=new Set,a={},f=(O,...T)=>O.read(...T),d=(O,...T)=>O.write(...T),g=(O,T)=>{var R;return(R=O.unstable_onInit)==null?void 0:R.call(O,T)},b=(O,T)=>{var R;return(R=O.onMount)==null?void 0:R.call(O,T)},...v)=>{const O=v[0]||(k=>{if((No?"production":void 0)!=="production"&&!k)throw new Error("Atom is undefined or null");let N=e.get(k);return N||(N={d:new Map,p:new Set,n:0},e.set(k,N),g==null||g(k,G)),N}),T=v[1]||(()=>{const k=[],N=U=>{try{U()}catch(K){k.push(K)}};do{a.f&&N(a.f);const U=new Set,K=U.add.bind(U);i.forEach(D=>{var q;return(q=t.get(D))==null?void 0:q.l.forEach(K)}),i.clear(),u.forEach(K),u.clear(),o.forEach(K),o.clear(),U.forEach(N),i.size&&R()}while(i.size||u.size||o.size);if(k.length)throw new AggregateError(k)}),R=v[2]||(()=>{const k=[],N=new WeakSet,U=new WeakSet,K=Array.from(i);for(;K.length;){const D=K[K.length-1],q=O(D);if(U.has(D)){K.pop();continue}if(N.has(D)){if(n.get(D)===q.n)k.push([D,q]);else if((No?"production":void 0)!=="production"&&n.has(D))throw new Error("[Bug] invalidated atom exists");U.add(D),K.pop();continue}N.add(D);for(const Te of t0(D,q,t))N.has(Te)||K.push(Te)}for(let D=k.length-1;D>=0;--D){const[q,Te]=k[D];let Ie=!1;for(const ut of Te.d.keys())if(ut!==q&&i.has(ut)){Ie=!0;break}Ie&&(W(q),z(q)),n.delete(q)}}),W=v[3]||(k=>{var N;const U=O(k);if(Xv(U)&&(t.has(k)&&n.get(k)!==U.n||Array.from(U.d).every(([ne,ze])=>W(ne).n===ze)))return U;U.d.clear();let K=!0;const D=()=>{t.has(k)&&(z(k),R(),T())},q=ne=>{var ze;if(zv(k,ne)){const gr=O(ne);if(!Xv(gr))if(Yv(ne))Gh(ne,ne.init,O);else throw new Error("no atom init");return Xu(gr)}const Cn=W(ne);try{return Xu(Cn)}finally{U.d.set(ne,Cn.n),Zv(U.v)&&e0(k,U.v,Cn),(ze=t.get(ne))==null||ze.t.add(k),K||D()}};let Te,Ie;const ut={get signal(){return Te||(Te=new AbortController),Te.signal},get setSelf(){return(No?"production":void 0)!=="production"&&!Jh(k)&&console.warn("setSelf function cannot be used with read-only atom"),!Ie&&Jh(k)&&(Ie=(...ne)=>{if((No?"production":void 0)!=="production"&&K&&console.warn("setSelf function cannot be called in sync"),!K)try{return L(k,...ne)}finally{R(),T()}}),Ie}},We=U.n;try{const ne=f(k,q,ut);return Gh(k,ne,O),Qu(ne)&&(Qv(ne,()=>Te==null?void 0:Te.abort()),ne.then(D,D)),U}catch(ne){return delete U.v,U.e=ne,++U.n,U}finally{K=!1,We!==U.n&&n.get(k)===We&&(n.set(k,U.n),i.add(k),(N=a.c)==null||N.call(a,k))}}),F=v[4]||(k=>{const N=[k];for(;N.length;){const U=N.pop(),K=O(U);for(const D of t0(U,K,t)){const q=O(D);n.set(D,q.n),N.push(D)}}}),L=v[5]||((k,...N)=>{let U=!0;const K=q=>Xu(W(q)),D=(q,...Te)=>{var Ie;const ut=O(q);try{if(zv(k,q)){if(!Yv(q))throw new Error("atom not writable");const We=ut.n,ne=Te[0];Gh(q,ne,O),z(q),We!==ut.n&&(i.add(q),(Ie=a.c)==null||Ie.call(a,q),F(q));return}else return L(q,...Te)}finally{U||(R(),T())}};try{return d(k,K,D,...N)}finally{U=!1}}),z=v[6]||(k=>{var N;const U=O(k),K=t.get(k);if(K&&!Zv(U.v)){for(const[D,q]of U.d)if(!K.d.has(D)){const Te=O(D);B(D).t.add(k),K.d.add(D),q!==Te.n&&(i.add(D),(N=a.c)==null||N.call(a,D),F(D))}for(const D of K.d||[])if(!U.d.has(D)){K.d.delete(D);const q=H(D);q==null||q.t.delete(k)}}}),B=v[7]||(k=>{var N;const U=O(k);let K=t.get(k);if(!K){W(k);for(const D of U.d.keys())B(D).t.add(k);if(K={l:new Set,d:new Set(U.d.keys()),t:new Set},t.set(k,K),(N=a.m)==null||N.call(a,k),Jh(k)){const D=()=>{let q=!0;const Te=(...Ie)=>{try{return L(k,...Ie)}finally{q||(R(),T())}};try{const Ie=b(k,Te);Ie&&(K.u=()=>{q=!0;try{Ie()}finally{q=!1}})}finally{q=!1}};o.add(D)}}return K}),H=v[8]||(k=>{var N;const U=O(k);let K=t.get(k);if(K&&!K.l.size&&!Array.from(K.t).some(D=>{var q;return(q=t.get(D))==null?void 0:q.d.has(k)})){K.u&&u.add(K.u),K=void 0,t.delete(k),(N=a.u)==null||N.call(a,k);for(const D of U.d.keys()){const q=H(D);q==null||q.t.delete(k)}return}return K}),Y=[e,t,n,i,o,u,a,f,d,g,b,O,T,R,W,F,L,z,B,H],G={get:k=>Xu(W(k)),set:(k,...N)=>{try{return L(k,...N)}finally{R(),T()}},sub:(k,N)=>{const K=B(k).l;return K.add(N),T(),()=>{K.delete(N),H(k),T()}}};return Object.defineProperty(G,sN,{value:Y}),G},oN=iN,r0=Qv,Vh={};let cN=0;function Fe(e,t){const n=`atom${++cN}`,i={toString(){return(Vh?"production":void 0)!=="production"&&this.debugLabel?n+":"+this.debugLabel:n}};return typeof e=="function"?i.read=e:(i.init=e,i.read=uN,i.write=aN),t&&(i.write=t),i}function uN(e){return e(this)}function aN(e,t,n){return t(this,typeof n=="function"?n(e(this)):n)}const lN=()=>{let e=0;const t=oN({}),n=new WeakMap,i=new WeakMap,o=n0(n,i,void 0,void 0,void 0,void 0,t,void 0,(f,d,g,...b)=>e?g(f,...b):f.write(d,g,...b)),u=new Set;return t.m.add(void 0,f=>{u.add(f);const d=n.get(f);d.m=i.get(f)}),t.u.add(void 0,f=>{u.delete(f);const d=n.get(f);delete d.m}),Object.assign(o,{dev4_get_internal_weak_map:()=>n,dev4_get_mounted_atoms:()=>u,dev4_restore_atoms:f=>{const d={read:()=>null,write:(g,b)=>{++e;try{for(const[v,O]of f)"init"in v&&b(v,O)}finally{--e}}};o.set(d)}})};function fN(){return(Vh?"production":void 0)!=="production"?lN():n0()}let Lo;function zh(){return Lo||(Lo=fN(),(Vh?"production":void 0)!=="production"&&(globalThis.__JOTAI_DEFAULT_STORE__||(globalThis.__JOTAI_DEFAULT_STORE__=Lo),globalThis.__JOTAI_DEFAULT_STORE__!==Lo&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"))),Lo}const hN={},dN=gi.createContext(void 0);function i0(e){return gi.useContext(dN)||zh()}const s0=e=>typeof(e==null?void 0:e.then)=="function",pN=e=>{e.status="pending",e.then(t=>{e.status="fulfilled",e.value=t},t=>{e.status="rejected",e.reason=t})},gN=qh.use||(e=>{if(e.status==="pending")throw e;if(e.status==="fulfilled")return e.value;throw e.status==="rejected"?e.reason:(pN(e),e)}),Yh=new WeakMap,mN=(e,t)=>{let n=Yh.get(e);return n||(n=new Promise((i,o)=>{let u=e;const a=g=>b=>{u===g&&i(b)},f=g=>b=>{u===g&&o(b)},d=()=>{try{const g=t();s0(g)?(Yh.set(g,n),u=g,g.then(a(g),f(g)),r0(g,d)):i(g)}catch(g){o(g)}};e.then(a(e),f(e)),r0(e,d)}),Yh.set(e,n)),n};function o0(e,t){const n=i0(),[[i,o,u],a]=gi.useReducer(g=>{const b=n.get(e);return Object.is(g[0],b)&&g[1]===n&&g[2]===e?g:[b,n,e]},void 0,()=>[n.get(e),n,e]);let f=i;if((o!==n||u!==e)&&(a(),f=n.get(e)),gi.useEffect(()=>{const g=n.sub(e,()=>{a()});return a(),g},[n,e,void 0]),gi.useDebugValue(f),s0(f)){const g=mN(f,()=>n.get(e));return gN(g)}return f}function yN(e,t){const n=i0();return gi.useCallback((...o)=>{if((hN?"production":void 0)!=="production"&&!("write"in e))throw new Error("not writable atom");return n.set(e,...o)},[n,e])}const ea={},_N=Symbol((ea?"production":void 0)!=="production"?"RESET":"");function bN(e,t){let n=null;const i=new Map,o=new Set,u=f=>{let d;if(d=i.get(f),d!==void 0)if(n!=null&&n(d[1],f))u.remove(f);else return d[0];const g=e(f);return i.set(f,[g,Date.now()]),a("CREATE",f,g),g},a=(f,d,g)=>{for(const b of o)b({type:f,param:d,atom:g})};return u.unstable_listen=f=>(o.add(f),()=>{o.delete(f)}),u.getParams=()=>i.keys(),u.remove=f=>{{if(!i.has(f))return;const[d]=i.get(f);i.delete(f),a("REMOVE",f,d)}},u.setShouldRemove=f=>{if(n=f,!!n)for(const[d,[g,b]]of i)n(b,d)&&(i.delete(d),a("REMOVE",d,g))},u}const c0=(e,t,n)=>(t.has(n)?t:t.set(n,e())).get(n),vN=new WeakMap,SN=(e,t,n)=>{const i=c0(()=>new WeakMap,vN,t);return c0(e,i,n)},wN={},u0=e=>!!e.write,EN=e=>typeof e=="function";function a0(e,t){return SN(()=>{const n=new WeakMap,i=(a,f)=>{let d=n.get(a);if(d)return d;const g=f&&n.get(f),b=[],v=[];return a.forEach((O,T)=>{const R=T;v[T]=R;const W=g&&g.atomList[g.keyList.indexOf(R)];if(W){b[T]=W;return}const F=z=>{const B=z(o),H=z(e),G=i(H,B==null?void 0:B.arr).keyList.indexOf(R);if(G<0||G>=H.length){const k=a[i(a).keyList.indexOf(R)];if(k)return k;throw new Error("splitAtom: index out of bounds for read")}return H[G]},L=(z,B,H)=>{const Y=z(o),G=z(e),N=i(G,Y==null?void 0:Y.arr).keyList.indexOf(R);if(N<0||N>=G.length)throw new Error("splitAtom: index out of bounds for write");const U=EN(H)?H(G[N]):H;Object.is(G[N],U)||B(e,[...G.slice(0,N),U,...G.slice(N+1)])};b[T]=u0(e)?Fe(F,L):Fe(F)}),g&&g.keyList.length===v.length&&g.keyList.every((O,T)=>O===v[T])?d=g:d={arr:a,atomList:b,keyList:v},n.set(a,d),d},o=Fe(a=>{const f=a(o),d=a(e);return i(d,f==null?void 0:f.arr)});(ea?"production":void 0)!=="production"&&(o.debugPrivate=!0),o.init=void 0;const u=u0(e)?Fe(a=>a(o).atomList,(a,f,d)=>{switch(d.type){case"remove":{const g=a(u).indexOf(d.atom);if(g>=0){const b=a(e);f(e,[...b.slice(0,g),...b.slice(g+1)])}break}case"insert":{const g=d.before?a(u).indexOf(d.before):a(u).length;if(g>=0){const b=a(e);f(e,[...b.slice(0,g),d.value,...b.slice(g)])}break}case"move":{const g=a(u).indexOf(d.atom),b=d.before?a(u).indexOf(d.before):a(u).length;if(g>=0&&b>=0){const v=a(e);g<b?f(e,[...v.slice(0,g),...v.slice(g+1,b),v[g],...v.slice(b)]):f(e,[...v.slice(0,b),v[g],...v.slice(b,g),...v.slice(g+1)])}break}}}):Fe(a=>a(o).atomList);return u},e,wN)}const ON=e=>typeof(e==null?void 0:e.then)=="function";function l0(e=()=>{try{return window.localStorage}catch(n){(ea?"production":void 0)!=="production"&&typeof window<"u"&&console.warn(n);return}},t){var n;let i,o;const u={getItem:(d,g)=>{var b,v;const O=R=>{if(R=R||"",i!==R){try{o=JSON.parse(R,t==null?void 0:t.reviver)}catch{return g}i=R}return o},T=(v=(b=e())==null?void 0:b.getItem(d))!=null?v:null;return ON(T)?T.then(O):O(T)},setItem:(d,g)=>{var b;return(b=e())==null?void 0:b.setItem(d,JSON.stringify(g,void 0))},removeItem:d=>{var g;return(g=e())==null?void 0:g.removeItem(d)}},a=d=>(g,b,v)=>d(g,O=>{let T;try{T=JSON.parse(O||"")}catch{T=v}b(T)});let f;try{f=(n=e())==null?void 0:n.subscribe}catch{}return!f&&typeof window<"u"&&typeof window.addEventListener=="function"&&window.Storage&&(f=(d,g)=>{if(!(e()instanceof window.Storage))return()=>{};const b=v=>{v.storageArea===e()&&v.key===d&&g(v.newValue)};return window.addEventListener("storage",b),()=>{window.removeEventListener("storage",b)}}),f&&(u.subscribe=a(f)),u}const TN=l0();function IN(e,t,n=TN,i){const o=i==null?void 0:i.getOnInit,u=Fe(o?n.getItem(e,t):t);return(ea?"production":void 0)!=="production"&&(u.debugPrivate=!0),u.onMount=f=>{f(n.getItem(e,t));let d;return n.subscribe&&(d=n.subscribe(e,f,t)),d},Fe(f=>f(u),(f,d,g)=>{const b=typeof g=="function"?g(f(u)):g;return b===_N?(d(u,t),n.removeItem(e)):b instanceof Promise?b.then(v=>(d(u,v),n.setItem(e,v))):(d(u,b),n.setItem(e,b))})}var AN=Object.defineProperty,RN=(e,t,n)=>t in e?AN(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,pt=(e,t,n)=>(RN(e,typeof t!="symbol"?t+"":t,n),n);function hn(e){return new Promise((t,n)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>n(e.error)})}function xN(e,t){const n=indexedDB.open(e);n.onupgradeneeded=()=>n.result.createObjectStore(t);const i=hn(n);return(o,u)=>i.then(a=>u(a.transaction(t,o).objectStore(t)))}let Xh;function Do(){return Xh||(Xh=xN("keyval-store","keyval")),Xh}function kN(e,t,n=Do()){return n("readwrite",i=>(i.put(t,e),hn(i.transaction)))}function f0(e,t=Do()){return t("readwrite",n=>(e.forEach(i=>n.put(i[1],i[0])),hn(n.transaction)))}function $N(e,t=Do()){return t("readwrite",n=>(n.delete(e),hn(n.transaction)))}function MN(e=Do()){return e("readwrite",t=>(t.clear(),hn(t.transaction)))}function CN(e,t){return e.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},hn(e.transaction)}function Zh(e=Do()){return e("readonly",t=>{if(t.getAll&&t.getAllKeys)return Promise.all([hn(t.getAllKeys()),hn(t.getAll())]).then(([i,o])=>i.map((u,a)=>[u,o[a]]));const n=[];return e("readonly",i=>CN(i,o=>n.push([o.key,o.value])).then(()=>n))})}const PN="jotai-minidb",FN={name:PN,version:0,migrations:{},onMigrationCompleted:()=>{alert("Data has been migrated. Page will be reloaded"),window.location.reload()},onVersionMissmatch:()=>{}};class NN{constructor(t={}){pt(this,"channel"),pt(this,"cache",Fe(void 0)),pt(this,"idbStorage"),pt(this,"metaStorage"),pt(this,"config"),pt(this,"initStarted",Fe(!1)),pt(this,"initialDataThenable",LN()),pt(this,"suspendBeforeInit",Fe(async o=>{o(this.items),await o(this.initialDataThenable).promise})),pt(this,"isInitialized",Fe(!1)),pt(this,"items",Fe((o,{setSelf:u})=>(o(this.initStarted)||Promise.resolve().then(u),o(this.cache)),async(o,u)=>{o(this.initStarted)||(u(this.initStarted,!0),this.preloadData().then(a=>{u(this.cache,a),o(this.initialDataThenable).resolve()}),this.channel.onmessage=async a=>{const f=a.data;f.type==="UPDATE"?u(this.cache,d=>({...d,[f.id]:f.item})):f.type==="DELETE"?u(this.cache,d=>{const g={...d};return delete g[f.id],g}):f.type==="UPDATE_MANY"?u(this.cache,Object.fromEntries(await Zh(this.idbStorage))):f.type==="MIGRATION_COMPLETED"&&this.config.onMigrationCompleted()})})),pt(this,"entries",Fe(o=>Object.entries(o(this.items)||{}))),pt(this,"keys",Fe(o=>Object.keys(o(this.items)||{}))),pt(this,"values",Fe(o=>Object.values(o(this.items)||{}))),pt(this,"item",bN(o=>Fe(u=>{var a;return(a=u(this.items))==null?void 0:a[o]},async(u,a,f)=>{await a(this.set,o,f)}))),pt(this,"set",Fe(null,async(o,u,a,f)=>{o(this.cache)||await o(this.suspendBeforeInit);const d=o(this.cache);if(!d)throw new Error("Cache was not initialized");const g=UN(f)?f(d[a]):f;u(this.cache,b=>({...b,[a]:g})),await kN(a,g,this.idbStorage),this.channel.postMessage({type:"UPDATE",id:a,item:g})})),pt(this,"setMany",Fe(null,async(o,u,a)=>{o(this.cache)||await o(this.suspendBeforeInit);const f={...o(this.cache)};for(const[d,g]of a)f[d]=g;u(this.cache,f),await f0(a,this.idbStorage),this.channel.postMessage({type:"UPDATE_MANY"})})),pt(this,"delete",Fe(null,async(o,u,a)=>{o(this.cache)||await o(this.suspendBeforeInit),u(this.cache,f=>{const d={...f};return delete d[a],d}),await $N(a,this.idbStorage),this.channel.postMessage({type:"DELETE",id:a})})),pt(this,"clear",Fe(null,async(o,u)=>{o(this.cache)||await o(this.suspendBeforeInit),u(this.cache,{}),await MN(this.idbStorage),this.channel.postMessage({type:"UPDATE_MANY"})})),this.config={...FN,initialData:{},...t};const{keyvalStorage:n,metaStorage:i}=DN(this.config.name,"key-value",this.config.initialData);this.idbStorage=n,this.metaStorage=i,this.channel=new BroadcastChannel(`jotai-minidb-broadcast:${this.config.name}`)}async preloadData(){return await this.migrate(),Object.fromEntries(await Zh(this.idbStorage))}async migrate(){const t=await this.metaStorage("readonly",n=>hn(n.get("version")))||0;if(this.config.version>t){let n=await Zh(this.idbStorage);for(let i=t+1;i<=this.config.version;i++){const o=this.config.migrations[i];if(!o)throw new Error(`Migrate function for version ${i} is not provided`);n=await Promise.all(n.map(async([u,a])=>[u,await o(a)]))}await f0(n,this.idbStorage),await this.metaStorage("readwrite",i=>hn(i.put(this.config.version,"version"))),this.channel.postMessage({type:"MIGRATION_COMPLETED"})}else if(this.config.version<t)throw this.config.onVersionMissmatch(),new Error(`[jotai-minidb] Minimal client version is ${this.config.version} but indexeddb database version is ${t}`)}}function LN(){return Fe(()=>{let e,t;return{promise:new Promise((n,i)=>{e=n,t=i}),resolve:e,reject:t}})}function DN(e,t,n){const i=indexedDB.open(e),o=[];i.onupgradeneeded=a=>{const f=i.result.createObjectStore(t);i.result.createObjectStore("_meta");for(const[d,g]of Object.entries(n))o.push(hn(f.add(g,d)))};const u=hn(i);return{keyvalStorage:async(a,f)=>{const d=await u;return await Promise.all(o),f(d.transaction(t,a).objectStore(t))},metaStorage:(a,f)=>u.then(d=>f(d.transaction("_meta",a).objectStore("_meta")))}}function UN(e){return typeof e=="function"}new NN;const KN=()=>l0(),BN={atom:(e,t)=>IN(e,t,KN(),{getOnInit:!0})},jN=typeof window>"u",WN=()=>jN&&typeof self<"u"?self.name==="project"?"project":"controller":"main",qN=()=>{const e=WN();console.log("StateManager initialized",e);const t=`state-manager-${e}`,n=new BroadcastChannel(t);return n.onmessage=i=>{console.log("StateManager.onmessage",t,i)},{}};let Qh;const JN={getDefault:()=>(Qh===void 0&&(Qh=qN()),Qh)},GN=zh(),h0=typeof window>"u",d0=(e,t,n="mem")=>{const i=n==="mem",o=!i&&!h0?BN.atom(e,t):Fe(t),u=new Set,a=new BroadcastChannel(e);JN.getDefault();let f;a.onmessage=v=>{const O=v;O.data.type==="update"?u.forEach(T=>T(O)):O.data.type==="init"&&a.postMessage({type:"update",value:f||GN.get(o)})};const d=Fe(v=>v(o),(v,O,T)=>{O(o,T.value),T.isEvent||(f=v(o),a.postMessage({type:"update",value:f}))}),g=v=>{const O=T=>{T.data.type==="update"&&v({isEvent:!0,value:T.data.value})};return u.add(O),(i||h0)&&a.postMessage({type:"init"}),()=>{u.delete(O)}};return d.onMount=g,Fe(v=>v(d),(v,O,T)=>{O(d,{isEvent:!1,value:T})})},dr=e=>e,ed=e=>({_tag:"Left",value:e}),ta=e=>({_tag:"Right",value:e}),HN=(e,t,n)=>n._tag==="Left"?e(n.value):t(n.value),p0={dimap:(e,t,n)=>i=>t(n(e(i))),first:e=>([t,n])=>[e(t),n],right:e=>t=>t._tag==="Left"?t:ta(e(t.value)),wander:e=>t=>t.map(e)},VN={empty:()=>{},foldMap:(e,t)=>{for(let n=0;n<t.length;n++){const i=e(t[n]);if(i!=null)return i}}},zN={empty:()=>[],foldMap:(e,t)=>{let n=[];return t.forEach(i=>{n=n.concat(e(i))}),n}},td=e=>({dimap:(t,n,i)=>o=>i(t(o)),first:t=>([n,i])=>t(n),right:t=>n=>n._tag==="Left"?e.empty():t(n.value),wander:t=>n=>e.foldMap(t,n)}),nd={Equivalence:{Equivalence:"Equivalence",Iso:"Iso",Lens:"Lens",Prism:"Prism",Traversal:"Traversal",Getter:"Getter",AffineFold:"AffineFold",Fold:"Fold",Setter:"Setter"},Iso:{Equivalence:"Iso",Iso:"Iso",Lens:"Lens",Prism:"Prism",Traversal:"Traversal",Getter:"Getter",AffineFold:"AffineFold",Fold:"Fold",Setter:"Setter"},Lens:{Equivalence:"Lens",Iso:"Lens",Lens:"Lens",Prism:"Prism",Traversal:"Traversal",Getter:"Getter",AffineFold:"AffineFold",Fold:"Fold",Setter:"Setter"},Prism:{Equivalence:"Prism",Iso:"Prism",Lens:"Prism",Prism:"Prism",Traversal:"Traversal",Getter:"AffineFold",AffineFold:"AffineFold",Fold:"Fold",Setter:"Setter"},Traversal:{Equivalence:"Traversal",Iso:"Traversal",Lens:"Traversal",Prism:"Traversal",Traversal:"Traversal",Getter:"Fold",AffineFold:"Fold",Fold:"Fold",Setter:"Setter"},Getter:{Equivalence:"Getter",Iso:"Getter",Lens:"Getter",Prism:"AffineFold",Traversal:"Fold",Getter:"Getter",AffineFold:"AffineFold",Fold:"Fold",Setter:void 0},AffineFold:{Equivalence:"AffineFold",Iso:"AffineFold",Lens:"AffineFold",Prism:"AffineFold",Traversal:"Fold",Getter:"AffineFold",AffineFold:"AffineFold",Fold:"Fold",Setter:void 0},Fold:{Equivalence:"Fold",Iso:"Fold",Lens:"Fold",Prism:"Fold",Traversal:"Fold",Getter:"Fold",AffineFold:"Fold",Fold:"Fold",Setter:void 0},Setter:{Equivalence:void 0,Iso:void 0,Lens:void 0,Prism:void 0,Traversal:void 0,Getter:void 0,AffineFold:void 0,Fold:void 0,Setter:void 0}},Ss=(e,t)=>{const n=t;return n._tag=e,n},g0=e=>(e._removable=!0,e);function Ae(e,t,n){switch(arguments.length){case 2:{const i=(o,u)=>e(o,t(o,u));return i._tag=nd[e._tag][t._tag],i._removable=t._removable||!1,i}default:{const i=nd[e._tag][t._tag],o=(u,a)=>e(u,t(u,n(u,a)));return o._tag=nd[i][n._tag],o._removable=n._removable||!1,o}}}const YN=Ss("Equivalence",(e,t)=>t),na=(e,t)=>Ss("Iso",(n,i)=>n.dimap(e,t,i)),Zt=(e,t)=>Ss("Lens",(n,i)=>n.dimap(o=>[e(o),o],t,n.first(i))),rd=(e,t)=>Ss("Prism",(n,i)=>n.dimap(e,o=>HN(dr,t,o),n.right(i))),id=Ss("Traversal",(e,t)=>e.dimap(dr,dr,e.wander(t))),XN=e=>Ss("Getter",(t,n)=>t.dimap(e,dr,n)),m0=(e,t,n)=>e(p0,t)(n),ZN=(e,t,n)=>e(p0,()=>t)(n),QN=(e,t)=>e(td({}),dr)(t),eL=(e,t)=>e(td(VN),dr)(t),y0=(e,t)=>e(td(zN),n=>[n])(t),tL=na(e=>e.map((t,n)=>[n,t]),e=>{const t=[...e].sort((i,o)=>i[0]-o[0]),n=[];for(let i=0;i<t.length;++i)(i===t.length-1||t[i][0]!==t[i+1][0])&&n.push(t[i][1]);return n}),_0=e=>Zt(t=>t[e],([t,n])=>Object.assign(Object.assign({},n),{[e]:t})),nL=e=>Zt(t=>{const n={};for(const i of e)n[i]=t[i];return n},([t,n])=>{const i=Object.assign({},n);for(const o of e)delete i[o];return Object.assign(i,t)}),b0=e=>Zt(t=>t[e],([t,n])=>{const i=n.slice();return i[e]=t,i}),sd=b0(0),od=e=>rd(t=>e(t)?ta(t):ed(t),dr),Uo=Symbol("__no_match__"),v0=od(e=>e!==Uo),S0=Symbol("__remove_me__"),cd=e=>g0(Ae(Zt(t=>0<=e&&e<t.length?t[e]:Uo,([t,n])=>{if(t===Uo)return n;if(t===S0)return typeof n=="string"?n.substring(0,e)+n.substring(e+1):[...n.slice(0,e),...n.slice(e+1)];if(typeof n=="string")return e===0?t+n.substring(1):e===n.length?n.substring(0,e-1)+t:n.substring(0,e)+t+n.substring(e+1);{const i=n.slice();return i[e]=t,i}}),v0)),rL=rd(e=>e===void 0?ed(void 0):ta(e),dr),iL=e=>rd(t=>e(t)?ta(t):ed(t),dr),sL=e=>g0(Ae(Zt(t=>{const n=t.findIndex(e);return n===-1?[Uo,-1]:[t[n],n]},([[t,n],i])=>{if(t===Uo)return i;if(t===S0)return[...i.slice(0,n),...i.slice(n+1)];const o=i.slice();return o[n]=t,o}),sd,v0)),oL=e=>Ae(Zt(t=>{const n=t.map((i,o)=>e(i)?o:null).filter(i=>i!=null);return[n.map(i=>t[i]),n]},([[t,n],i])=>{const o=i.length,u=t.length;let a=0,f=0,d=0;const g=[];for(;a<o;)n[f]===a?(++f,d<u&&(g.push(t[d]),++d)):g.push(i[a]),++a;for(;d<u;)g.push(t[d++]);return g}),sd),cL=e=>Zt(t=>t===void 0?e:t,([t,n])=>t),uL=e=>Ae(Zt(t=>{const n=y0(e,t);return[n,n.length]},([[t,n],i])=>{if(t.length!==n)throw new Error("cannot add/remove elements through partsOf");let o=0;return m0(e,()=>t[o++],i)}),sd),aL=e=>Zt(t=>e(t),([t,n])=>t),lL=e=>Zt(t=>t,([t,n])=>e(t)),fL=Zt(e=>{},([e,t])=>e===void 0?t:[e,...t]),hL=Zt(e=>{},([e,t])=>e===void 0?t:[...t,e]),dL=Ae(na(e=>e.split(""),e=>e.join("")),id),pL=Ae(na(e=>e.split(/\b/),e=>e.join("")),id,od(e=>!/\s+/.test(e)));class Me{constructor(t){this._ref=t}get _tag(){return this._ref._tag}get _removable(){return this._ref._removable}compose(t){return new Me(Ae(this._ref,t._ref))}iso(t,n){return new Me(Ae(this._ref,na(t,n)))}lens(t,n){return new Me(Ae(this._ref,Zt(t,([i,o])=>n(o,i))))}indexed(){return new Me(Ae(this._ref,tL))}prop(t){return new Me(Ae(this._ref,_0(t)))}path(...t){return t.length===1&&(t=t[0].split(".")),new Me(t.reduce((n,i)=>Ae(n,_0(i)),this._ref))}pick(t){return new Me(Ae(this._ref,nL(t)))}nth(t){return new Me(Ae(this._ref,b0(t)))}filter(t){return new Me(Ae(this._ref,oL(t)))}valueOr(t){return new Me(Ae(this._ref,cL(t)))}partsOf(t){const n=typeof t=="function"?t(w0):t;return new Me(Ae(this._ref,uL(n._ref)))}reread(t){return new Me(Ae(this._ref,aL(t)))}rewrite(t){return new Me(Ae(this._ref,lL(t)))}optional(){return new Me(Ae(this._ref,rL))}guard_(){return t=>this.guard(t)}guard(t){return new Me(Ae(this._ref,iL(t)))}at(t){return new Me(Ae(this._ref,cd(t)))}head(){return new Me(Ae(this._ref,cd(0)))}index(t){return new Me(Ae(this._ref,cd(t)))}find(t){return new Me(Ae(this._ref,sL(t)))}elems(){return new Me(Ae(this._ref,id))}to(t){return new Me(Ae(this._ref,XN(t)))}when(t){return new Me(Ae(this._ref,od(t)))}chars(){return new Me(Ae(this._ref,dL))}words(){return new Me(Ae(this._ref,pL))}prependTo(){return new Me(Ae(this._ref,fL))}appendTo(){return new Me(Ae(this._ref,hL))}}const w0=new Me(YN);function gL(){return w0}function mL(e){return t=>QN(e._ref,t)}function yL(e){return t=>eL(e._ref,t)}function _L(e){return t=>y0(e._ref,t)}function bL(e){return t=>n=>m0(e._ref,t,n)}function vL(e){return t=>n=>ZN(e._ref,t,n)}const E0=(e,t,n)=>(t.has(n)?t:t.set(n,e())).get(n),SL=new WeakMap,wL=(e,t,n)=>{const i=E0(()=>new WeakMap,SL,t);return E0(e,i,n)},EL=e=>typeof e=="function";function OL(e,t){return wL(()=>{const n=t(gL());return Fe(o=>{const u=o(e);return u instanceof Promise?u.then(a=>O0(n,a)):O0(n,u)},(o,u,a)=>{const f=EL(a)?bL(n)(a):vL(n)(a),d=o(e);return u(e,d instanceof Promise?d.then(f):f(d))})},e,t)}const O0=(e,t)=>e._tag==="Traversal"?_L(e)(t):e._tag==="Prism"?yL(e)(t):mL(e)(t),ra=zh(),ws=(e,t)=>{const n=()=>ra.get(e),i=F=>{ra.set(e,F)};let o;const u=(F,L)=>{const z=()=>{const B=F(n());typeof B=="function"&&(o=B)};L&&z(),ra.sub(e,()=>{o!==void 0&&o(),z()})},a=F=>u(F,!1),f=F=>u(F,!0),d=()=>o0(e),g=()=>yN(e),b=()=>[d(),g()],v=F=>ws(OL(e,F));return{get:n,set:i,sub:a,subAndInit:f,useValue:d,useSet:g,use:b,focus:v,useFocus:F=>{const L=qh.useCallback(z=>z.prop(F),[F]);return v(L)},useFocusMemo:F=>{const L=d();return qh.useMemo(()=>v(F),[L])},array:()=>{const F=e;return ra.get(a0(F)).map(L=>ws(L))},useArray:()=>o0(a0(e)).map(L=>ws(L))}},TL=(e,t)=>ws(Fe(t)),IL=(e,t)=>ws(d0(e,t)),AL=(e,t)=>ws(d0(e,t,"storage")),T0={},It={mem:IL,memSingle:TL,storage:AL,family:e=>t=>{const n=T0[t];if(n!==void 0)return n;{const i=e(t);return T0[t]=i,i}}},I0=bs({label:_s,key:_s,abletonProject:EF(_s),style:bs({accent:bs({color1:_s,color2:_s})})});bs({projects:_F(I0)});const A0=()=>({label:"Default",key:"default",style:{accent:{color1:"#6a11cb",color2:"#2575fc"}}}),RL={Schema:I0,defaultProjectConfig:A0,defaultProjectsConfig:()=>({projects:[A0()]})},Ge={initArrangement:It.mem("init-arrangement",[]),importStatus:It.mem("import-status",{type:"none"}),project:{config:It.storage("projects-config",RL.defaultProjectsConfig()),active:It.storage("active-project","init"),controllers:It.family(e=>It.storage(`controllers-${e}`,[])),abletonName:It.mem("ableton-name",void 0),arrangement:It.mem("arrangement",CF())},realTime:{beats:It.mem("real-time-beats",0),barBeats:It.mem("real-time-bar-beats",1),timeSignature:It.mem("real-time-time-signature",{noteCount:4,noteLength:4}),tempo:It.mem("real-time-tempo",0),isPlaying:It.mem("real-time-is-playing",!1),metronomeState:It.mem("real-time-metronome-state",!1),loopState:It.mem("real-time-loop-state",!1),halfBeat:It.mem("real-time-half-beat",!1)}},xL=e=>{const t=n=>{if(n.type==="init-ack")Ge.importStatus.set({type:"ack",projectName:n.projectName}),Ge.project.abletonName.set(n.projectName);else if(n.type==="init-project")Ge.importStatus.set({type:"importing"}),Ge.initArrangement.set(NF());else if(n.type==="init-track")Ge.initArrangement.set(LF(n));else if(n.type==="init-clip")Ge.initArrangement.set(DF(n));else if(n.type==="init-cue")Ge.initArrangement.set(UF(n));else if(n.type==="init-done"){Ge.importStatus.set({type:"finalizing"});const i=KF(Ge.initArrangement.get());Ge.project.arrangement.set(i),Ge.importStatus.set({type:"done"})}else n.type==="beat"?Ge.realTime.beats.set(n.value):n.type==="sig"?Ge.realTime.timeSignature.set({noteCount:n.numer,noteLength:n.denom}):n.type==="bar-beat"?Ge.realTime.barBeats.set(n.value):n.type==="tempo"?Ge.realTime.tempo.set(n.value):n.type==="is-playing"?Ge.realTime.isPlaying.set(n.value):n.type==="metronome-state"?Ge.realTime.metronomeState.set(n.value):n.type==="loop-state"?Ge.realTime.loopState.set(n.value):n.type==="half-beat"&&Ge.realTime.halfBeat.set(n.isHalf)};e.on("sysex",n=>{const i=yE(n);i!==void 0&&t(i)})},kL=e=>{e.emit(Sn.init()),Ge.importStatus.sub(t=>{t.type==="ack"&&e.emit(Sn.initReady(["Songs","Parts","Chris Keyboard"]))})},$L={init:(e,t)=>{console.log("Project Main"),Ge.project.active.sub(n=>{console.log("--------Active project",n),Ge.project.controllers(n).sub(i=>{console.log("--------Project controllers",n,i)})}),xL(e),kL(t)}};console.log("Loading Project Worker Main");const R0=jp(),x0=jp();onmessage=e=>{we.isArray(e.data)&&e.data.length==2&&e.data[0]==="DAW_LISTENER"&&R0.emit(e.data[1])},x0.on("*",e=>postMessage(["DAW_EMITTER",e])),$L.init(R0,x0)})();
